//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at Fri 10-Jan-97 by the VDM-SLtoC++ Code Generator
// (vdmde - v3.0l - Fri 10-Jan-97)
//
// Supported compiler: g++ version 2.7.2
//



#include "FREE.h"

#define vdm_FREE_CombineBlkEnv vdm_AUX_CombineBlkEnv
#define vdm_FREE_ExtractId vdm_AUX_ExtractId
#define vdm_FREE_MkBlkEnv vdm_AUX_MkBlkEnv
#define vdm_FREE_MkEmptyBlkEnv vdm_AUX_MkEmptyBlkEnv
#define vdm_FREE_GetLocalVal vdm_STATE_GetLocalVal
#define vdm_FREE_GetOldStateVal vdm_STATE_GetOldStateVal
#define vdm_FREE_IsLocalVal vdm_STATE_IsLocalVal
#define vdm_FREE_IsOldState vdm_STATE_IsOldState
#define vdm_FREE_LookUpRename vdm_STATE_LookUpRename

static Map vdm_FREE_FreeInAllOrExistsExpr(Record, Set);
static Map vdm_FREE_FreeInApplyExpr(Record, Set);
static Map vdm_FREE_FreeInBinaryExpr(Record, Set);
static Map vdm_FREE_FreeInBind(Record, Set);
static Map vdm_FREE_FreeInBracketedExpr(Record, Set);
static Map vdm_FREE_FreeInCasesExpr(Record, Set);
static Map vdm_FREE_FreeInDefExpr(Record, Set);
static Map vdm_FREE_FreeInElseifExpr(Sequence, Set);
static Map vdm_FREE_FreeInExistsUniqueExpr(Record, Set);
static Map vdm_FREE_FreeInFctTypeInstExpr(Record, Set);
static Map vdm_FREE_FreeInFieldSelectExpr(Record, Set);
static Map vdm_FREE_FreeInFnDef(Record, Set);
static Map vdm_FREE_FreeInIfExpr(Record, Set);
static Map vdm_FREE_FreeInIotaExpr(Record, Set);
static Map vdm_FREE_FreeInIsExpr(Record, Set);
static Map vdm_FREE_FreeInLambdaExpr(Record, Set);
static Map vdm_FREE_FreeInLetBeSTExpr(Record, Set);
static Map vdm_FREE_FreeInLetExpr(Record, Set);
static Map vdm_FREE_FreeInMapComprehensionExpr(Record, Set);
static Map vdm_FREE_FreeInMapEnumerationExpr(Record, Set);
static Map vdm_FREE_FreeInMapInverseExpr(Record, Set);
static Map vdm_FREE_FreeInMultBindSeq(Sequence, Set);
static Map vdm_FREE_FreeInName(Record, Set);
static Map vdm_FREE_FreeInOldName(Record, Set);
static Map vdm_FREE_FreeInPostExpr(Generic, Set);
static Map vdm_FREE_FreeInPreExpr(Generic, Set);
static Map vdm_FREE_FreeInPrefixExpr(Record, Set);
static Map vdm_FREE_FreeInRecordConstructorExpr(Record, Set);
static Map vdm_FREE_FreeInRecordModifierExpr(Record, Set);
static Map vdm_FREE_FreeInSeqComprehensionExpr(Record, Set);
static Map vdm_FREE_FreeInSeqEnumerationExpr(Record, Set);
static Map vdm_FREE_FreeInSeqModifyMapOverrideExpr(Record, Set);
static Map vdm_FREE_FreeInSetComprehensionExpr(Record, Set);
static Map vdm_FREE_FreeInSetEnumerationExpr(Record, Set);
static Map vdm_FREE_FreeInSetRangeExpr(Record, Set);
static Map vdm_FREE_FreeInSubSequenceExpr(Record, Set);
static Map vdm_FREE_FreeInTokenConstructorExpr(Record, Set);
static Map vdm_FREE_FreeInTupleConstructorExpr(Record, Set);
static Set vdm_FREE_IdentInBind(Record);
static Set vdm_FREE_IdentInMultBindSeq(Sequence);
static Generic vdm_FREE_LookUpInTopEnv(Record);

void init_FREE() {}

Map vdm_FREE_FreeInAllOrExistsExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_bind__l;
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_AllOrExistsExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 5 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          succ_3 = true;
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_bind__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[5]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInMultBindSeq(vdm_FREE_bind__l, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        Set unArg_11;
        unArg_11 = Set().Insert(vdm_FREE_res__m.Dom());
        unArg_11.Insert(vdm_FREE_id__s);
        unArg_11.Insert(vdm_FREE_IdentInMultBindSeq(vdm_FREE_bind__l));
        {
          Set rduset_17;
          Generic tmpe_20;
          for (int bb_19 = unArg_11.First(tmpe_20); bb_19; bb_19 = unArg_11.Next(tmpe_20)) {
            Set e_18 = tmpe_20;
            rduset_17.ImpUnion(e_18);
          }
          rhs_10 = rduset_17;
        }
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Map rhs_21;
      {
        Map m1_30 = vdm_FREE_res__m;
        Map m2_31 = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        Set com_26 = m1_30.Dom();
        com_26.ImpIntersect(m2_31.Dom());
        int all_applies_27 = 1;
        Generic d_28;
        for (int bb_29 = com_26.First(d_28); bb_29 && all_applies_27; bb_29 = com_26.Next(d_28)) 
          all_applies_27 *= m1_30[d_28] == m2_31[d_28];
        if (all_applies_27) 
          m1_30.ImpOverride(m2_31);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_21 = m1_30;
      }
      vdm_FREE_res__m = rhs_21;
    }
    {
      Map rexpr_32;
      rexpr_32 = vdm_FREE_res__m;
      return rexpr_32;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInAllOrExistsExpr");
}

Map vdm_FREE_FreeInApplyExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_arg__le;
  Record vdm_FREE_fct__e;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_ApplyExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_fct__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_arg__le = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInExpr(vdm_FREE_fct__e, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        rhs_10 = vdm_FREE_newid__s;
        rhs_10.ImpUnion(vdm_FREE_res__m.Dom());
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Sequence sq_14;
      sq_14 = vdm_FREE_arg__le;
      Record vdm_FREE_arg__e;
      bool succ_16;
      Generic tmpe_35;
      for (int i_34 = sq_14.First(tmpe_35); i_34; i_34 = sq_14.Next(tmpe_35)) {
        Record elem_15 = tmpe_35;
        {
          succ_16 = true;
          {
            vdm_FREE_arg__e = elem_15;
            succ_16 = true;
          }
          if (succ_16) {
            Map vdm_FREE_arg__m;
            vdm_FREE_arg__m = vdm_FREE_FreeInExpr(vdm_FREE_arg__e, vdm_FREE_newid__s);
            {
              Map rhs_21;
              {
                Map m1_28 = vdm_FREE_res__m;
                Map m2_29 = vdm_FREE_arg__m;
                Set com_24 = m1_28.Dom();
                com_24.ImpIntersect(m2_29.Dom());
                int all_applies_25 = 1;
                Generic d_26;
                for (int bb_27 = com_24.First(d_26); bb_27 && all_applies_25; bb_27 = com_24.Next(d_26)) 
                  all_applies_25 *= m1_28[d_26] == m2_29[d_26];
                if (all_applies_25) 
                  m1_28.ImpOverride(m2_29);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_21 = m1_28;
              }
              vdm_FREE_res__m = rhs_21;
              {
                Set rhs_30;
                {
                  rhs_30 = vdm_FREE_newid__s;
                  rhs_30.ImpUnion(vdm_FREE_arg__m.Dom());
                }
                vdm_FREE_newid__s = rhs_30;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_36;
      rexpr_36 = vdm_FREE_res__m;
      return rexpr_36;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInApplyExpr");
}

Map vdm_FREE_FreeInBinaryExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_left__e;
  Record vdm_FREE_right__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_BinaryExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 4 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_left__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_right__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_tmp__m;
    vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_left__e, vdm_FREE_id__s);
    {
      Map vdm_FREE_res__m;
      Set tmpVar_14;
      {
        tmpVar_14 = vdm_FREE_id__s;
        tmpVar_14.ImpUnion(vdm_FREE_tmp__m.Dom());
      }
      vdm_FREE_res__m = vdm_FREE_FreeInExpr(vdm_FREE_right__e, tmpVar_14);
      {
        Map rexpr_18;
        {
          Map m1_25 = vdm_FREE_res__m;
          Map m2_26 = vdm_FREE_tmp__m;
          Set com_21 = m1_25.Dom();
          com_21.ImpIntersect(m2_26.Dom());
          int all_applies_22 = 1;
          Generic d_23;
          for (int bb_24 = com_21.First(d_23); bb_24 && all_applies_22; bb_24 = com_21.Next(d_23)) 
            all_applies_22 *= m1_25[d_23] == m2_26[d_23];
          if (all_applies_22) 
            m1_25.ImpOverride(m2_26);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rexpr_18 = m1_25;
        }
        return rexpr_18;
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInBinaryExpr");
}

Map vdm_FREE_FreeInBind(Record vdm_FREE_bind, Set vdm_FREE_id__s) {
  Bool cond_4;
  {
    Record argTmp_5;
    argTmp_5 = vdm_FREE_bind;
    if (argTmp_5.IsRecord()) 
      cond_4 = vdm_AS_SetBind == argTmp_5.GetTag();
    else 
      cond_4 = false;
  }
  if (cond_4.GetValue()) {
    bool succ_7;
    Record tmpVal_8;
    tmpVal_8 = vdm_FREE_bind;
    Record vdm_FREE_exp__e;
    succ_7 = true;
    {
      succ_7 = false;
      if (tmpVal_8.IsRecord()) 
        if (vdm_AS_SetBind == ((Record) tmpVal_8).GetTag()) {
          Sequence e_l_9;
          for (int i_10 = 1; i_10 <= ((Record) tmpVal_8).Length(); i_10++) 
            e_l_9.ImpAppend(((Record) tmpVal_8).GetField(i_10));
          if (succ_7 = 2 == (Int) (e_l_9.Length())) {
            Record permI_11;
            permI_11 = (Record) (e_l_9.Hd());
            succ_7 = true;
            succ_7 = true;
            permI_11 = (Record) (e_l_9[2]);
            if (succ_7) {
              vdm_FREE_exp__e = permI_11;
              succ_7 = true;
            }
          }
        }
    }
    if (!succ_7) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Record tmpVar_12;
      tmpVar_12 = vdm_FREE_exp__e;
      Set tmpVar_13;
      tmpVar_13 = vdm_FREE_id__s;
      return vdm_FREE_FreeInExpr(tmpVar_12, tmpVar_13);
    }
  }
  else {
    Map rexpr_6;
    rexpr_6 = Map();
    return rexpr_6;
  }
}

Map vdm_FREE_FreeInBracketedExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_expr;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_BracketedExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_expr = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_expr;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInBracketedExpr");
}

Map vdm_FREE_FreeInCasesExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_altns__l;
  Set vdm_FREE_id__s;
  Generic vdm_FREE_others__e;
  Record vdm_FREE_sel__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_CasesExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 4 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_sel__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_altns__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_others__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Sequence vdm_FREE_alt__l;
    vdm_FREE_alt__l = vdm_FREE_altns__l;
    Sequence vdm_FREE_pat__lp;
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    {
      Map vdm_FREE_sel__m;
      vdm_FREE_sel__m = vdm_FREE_FreeInExpr(vdm_FREE_sel__e, vdm_FREE_newid__s);
      {
        Map rhs_11;
        rhs_11 = vdm_FREE_sel__m;
        vdm_FREE_res__m = rhs_11;
        {
          Set rhs_12;
          {
            rhs_12 = vdm_FREE_newid__s;
            rhs_12.ImpUnion(vdm_FREE_sel__m.Dom());
          }
          vdm_FREE_newid__s = rhs_12;
        }
        {
          Bool whCrtl_16;
          while ( true){
            Sequence var2_18;
            var2_18 = Sequence();
            whCrtl_16 = (Bool) (!(vdm_FREE_alt__l == var2_18));
            if (whCrtl_16.GetValue()) {
              bool succ_19;
              Record tmpVal_20(vdm_AS_CaseAltn, length_AS_CaseAltn);
              tmpVal_20 = (Record) (vdm_FREE_alt__l.Hd());
              Record vdm_FREE_body__e;
              Sequence vdm_FREE_match__lp;
              succ_19 = true;
              {
                succ_19 = false;
                if (tmpVal_20.IsRecord()) 
                  if (vdm_AS_CaseAltn == tmpVal_20.GetTag()) {
                    Sequence e_l_22;
                    for (int i_23 = 1; i_23 <= tmpVal_20.Length(); i_23++) 
                      e_l_22.ImpAppend(tmpVal_20.GetField(i_23));
                    if (succ_19 = 2 == (Int) (e_l_22.Length())) {
                      Generic permI_24;
                      permI_24 = (Generic) (e_l_22.Hd());
                      succ_19 = true;
                      {
                        vdm_FREE_match__lp = permI_24;
                        succ_19 = true;
                      }
                      permI_24 = (Generic) (e_l_22[2]);
                      if (succ_19) {
                        vdm_FREE_body__e = permI_24;
                        succ_19 = true;
                      }
                    }
                  }
              }
              if (!succ_19) 
                RunTime("Pattern match did not succeed in value definition");
              {
                Sequence rhs_25;
                rhs_25 = vdm_FREE_match__lp;
                vdm_FREE_pat__lp = rhs_25;
                {
                  Bool whCrtl_26;
                  while ( true){
                    Sequence var2_28;
                    var2_28 = Sequence();
                    whCrtl_26 = (Bool) (!(vdm_FREE_pat__lp == var2_28));
                    if (whCrtl_26.GetValue()) {
                      bool succ_29;
                      Record tmpVal_30;
                      tmpVal_30 = (Record) (vdm_FREE_pat__lp.Hd());
                      Record vdm_FREE_pat__p;
                      succ_29 = true;
                      {
                        vdm_FREE_pat__p = tmpVal_30;
                        succ_29 = true;
                      }
                      if (!succ_29) 
                        RunTime("Pattern match did not succeed in value definition");
                      {
                        Set rhs_32;
                        {
                          rhs_32 = vdm_FREE_newid__s;
                          rhs_32.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat__p));
                        }
                        vdm_FREE_newid__s = rhs_32;
                        {
                          Sequence rhs_36;
                          rhs_36 = vdm_FREE_pat__lp.Tl();
                          vdm_FREE_pat__lp = rhs_36;
                        }
                      }
                    }
                    else 
                      break;
                  }
                }
                {
                  Map vdm_FREE_tmp__m;
                  vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_body__e, vdm_FREE_newid__s);
                  {
                    Map rhs_42;
                    {
                      Map m1_49 = vdm_FREE_res__m;
                      Map m2_50 = vdm_FREE_tmp__m;
                      Set com_45 = m1_49.Dom();
                      com_45.ImpIntersect(m2_50.Dom());
                      int all_applies_46 = 1;
                      Generic d_47;
                      for (int bb_48 = com_45.First(d_47); bb_48 && all_applies_46; bb_48 = com_45.Next(d_47)) 
                        all_applies_46 *= m1_49[d_47] == m2_50[d_47];
                      if (all_applies_46) 
                        m1_49.ImpOverride(m2_50);
                      else 
                        RunTime("EvalMapMerge Duplicates not equal");
                      rhs_42 = m1_49;
                    }
                    vdm_FREE_res__m = rhs_42;
                    {
                      Set rhs_51;
                      {
                        rhs_51 = vdm_FREE_newid__s;
                        rhs_51.ImpUnion(vdm_FREE_tmp__m.Dom());
                      }
                      vdm_FREE_newid__s = rhs_51;
                    }
                  }
                }
                {
                  Sequence rhs_55;
                  rhs_55 = vdm_FREE_alt__l.Tl();
                  vdm_FREE_alt__l = rhs_55;
                }
              }
            }
            else 
              break;
          }
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_others__e, vdm_FREE_newid__s);
          {
            Map rhs_61;
            {
              Map m1_68 = vdm_FREE_res__m;
              Map m2_69 = vdm_FREE_tmp__m;
              Set com_64 = m1_68.Dom();
              com_64.ImpIntersect(m2_69.Dom());
              int all_applies_65 = 1;
              Generic d_66;
              for (int bb_67 = com_64.First(d_66); bb_67 && all_applies_65; bb_67 = com_64.Next(d_66)) 
                all_applies_65 *= m1_68[d_66] == m2_69[d_66];
              if (all_applies_65) 
                m1_68.ImpOverride(m2_69);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_61 = m1_68;
            }
            vdm_FREE_res__m = rhs_61;
          }
        }
        {
          Map rexpr_70;
          rexpr_70 = vdm_FREE_res__m;
          return rexpr_70;
        }
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInCasesExpr");
}

Map vdm_FREE_FreeInDefExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_def__l;
  Set vdm_FREE_id__s;
  Record vdm_FREE_in__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_DefExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_def__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_in__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_def__l;
      Record vdm_FREE_pat__p;
      Record vdm_FREE_val__e;
      bool succ_9;
      Generic tmpe_29;
      for (int i_28 = sq_7.First(tmpe_29); i_28; i_28 = sq_7.Next(tmpe_29)) {
        Tuple elem_8 = tmpe_29;
        {
          succ_9 = true;
          {
            succ_9 = false;
            if (elem_8.IsTuple()) {
              Sequence e_l_25;
              for (int i_26 = 1; i_26 <= ((Tuple) elem_8).Length(); i_26++) 
                e_l_25.ImpAppend(((Tuple) elem_8).GetField(i_26));
              if (succ_9 = 2 == (Int) (e_l_25.Length())) {
                Record permI_27;
                permI_27 = (Record) (e_l_25.Hd());
                succ_9 = true;
                {
                  vdm_FREE_pat__p = permI_27;
                  succ_9 = true;
                }
                permI_27 = (Record) (e_l_25[2]);
                if (succ_9) {
                  vdm_FREE_val__e = permI_27;
                  succ_9 = true;
                }
              }
            }
          }
          if (succ_9) {
            Map rhs_10;
            {
              Map m1_19 = vdm_FREE_res__m;
              Map m2_20 = vdm_FREE_FreeInExpr(vdm_FREE_val__e, vdm_FREE_id__s);
              Set com_15 = m1_19.Dom();
              com_15.ImpIntersect(m2_20.Dom());
              int all_applies_16 = 1;
              Generic d_17;
              for (int bb_18 = com_15.First(d_17); bb_18 && all_applies_16; bb_18 = com_15.Next(d_17)) 
                all_applies_16 *= m1_19[d_17] == m2_20[d_17];
              if (all_applies_16) 
                m1_19.ImpOverride(m2_20);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_10 = m1_19;
            }
            vdm_FREE_res__m = rhs_10;
            {
              Set rhs_21;
              {
                rhs_21 = vdm_FREE_newid__s;
                rhs_21.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat__p));
              }
              vdm_FREE_newid__s = rhs_21;
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Set rhs_30;
      {
        rhs_30 = vdm_FREE_newid__s;
        rhs_30.ImpUnion(vdm_FREE_res__m.Dom());
      }
      vdm_FREE_newid__s = rhs_30;
    }
    {
      Map rhs_34;
      {
        Map m1_43 = vdm_FREE_res__m;
        Map m2_44 = vdm_FREE_FreeInExpr(vdm_FREE_in__e, vdm_FREE_newid__s);
        Set com_39 = m1_43.Dom();
        com_39.ImpIntersect(m2_44.Dom());
        int all_applies_40 = 1;
        Generic d_41;
        for (int bb_42 = com_39.First(d_41); bb_42 && all_applies_40; bb_42 = com_39.Next(d_41)) 
          all_applies_40 *= m1_43[d_41] == m2_44[d_41];
        if (all_applies_40) 
          m1_43.ImpOverride(m2_44);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_34 = m1_43;
      }
      vdm_FREE_res__m = rhs_34;
    }
    {
      Map rexpr_45;
      rexpr_45 = vdm_FREE_res__m;
      return rexpr_45;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInDefExpr");
}

Map vdm_FREE_FreeInElseifExpr(Sequence vdm_FREE_elif__l, Set vdm_FREE_id__s) {
  Map vdm_FREE_res__m;
  vdm_FREE_res__m = Map();
  Set vdm_FREE_newid__s;
  vdm_FREE_newid__s = vdm_FREE_id__s;
  {
    Sequence sq_4;
    sq_4 = vdm_FREE_elif__l;
    Record vdm_FREE_cons__e;
    Record vdm_FREE_test__e;
    bool succ_6;
    Generic tmpe_45;
    for (int i_44 = sq_4.First(tmpe_45); i_44; i_44 = sq_4.Next(tmpe_45)) {
      Record elem_5 = tmpe_45;
      {
        succ_6 = true;
        {
          succ_6 = false;
          if (elem_5.IsRecord()) 
            if (vdm_AS_ElseifExpr == elem_5.GetTag()) {
              Sequence e_l_41;
              for (int i_42 = 1; i_42 <= elem_5.Length(); i_42++) 
                e_l_41.ImpAppend(elem_5.GetField(i_42));
              if (succ_6 = 2 == (Int) (e_l_41.Length())) {
                Record permI_43;
                permI_43 = (Record) (e_l_41.Hd());
                succ_6 = true;
                {
                  vdm_FREE_test__e = permI_43;
                  succ_6 = true;
                }
                permI_43 = (Record) (e_l_41[2]);
                if (succ_6) {
                  vdm_FREE_cons__e = permI_43;
                  succ_6 = true;
                }
              }
            }
        }
        if (succ_6) {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_test__e, vdm_FREE_newid__s);
          {
            Map rhs_11;
            {
              Map m1_18 = vdm_FREE_res__m;
              Map m2_19 = vdm_FREE_tmp__m;
              Set com_14 = m1_18.Dom();
              com_14.ImpIntersect(m2_19.Dom());
              int all_applies_15 = 1;
              Generic d_16;
              for (int bb_17 = com_14.First(d_16); bb_17 && all_applies_15; bb_17 = com_14.Next(d_16)) 
                all_applies_15 *= m1_18[d_16] == m2_19[d_16];
              if (all_applies_15) 
                m1_18.ImpOverride(m2_19);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_11 = m1_18;
            }
            vdm_FREE_res__m = rhs_11;
            {
              Set rhs_20;
              {
                rhs_20 = vdm_FREE_newid__s;
                rhs_20.ImpUnion(vdm_FREE_tmp__m.Dom());
              }
              vdm_FREE_newid__s = rhs_20;
            }
          }
          {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_cons__e, vdm_FREE_newid__s);
            {
              Map rhs_28;
              {
                Map m1_35 = vdm_FREE_res__m;
                Map m2_36 = vdm_FREE_tmp__m;
                Set com_31 = m1_35.Dom();
                com_31.ImpIntersect(m2_36.Dom());
                int all_applies_32 = 1;
                Generic d_33;
                for (int bb_34 = com_31.First(d_33); bb_34 && all_applies_32; bb_34 = com_31.Next(d_33)) 
                  all_applies_32 *= m1_35[d_33] == m2_36[d_33];
                if (all_applies_32) 
                  m1_35.ImpOverride(m2_36);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_28 = m1_35;
              }
              vdm_FREE_res__m = rhs_28;
              {
                Set rhs_37;
                {
                  rhs_37 = vdm_FREE_newid__s;
                  rhs_37.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_37;
              }
            }
          }
        }
        else 
          RunTime("Pattern did not match in sequence for loop");
      }
    }
  }
  {
    Map rexpr_46;
    rexpr_46 = vdm_FREE_res__m;
    return rexpr_46;
  }
}

Map vdm_FREE_FreeInExistsUniqueExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_bind;
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_ExistsUniqueExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 4 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_bind = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Set vdm_FREE_patid__s;
    vdm_FREE_patid__s = vdm_FREE_IdentInBind(vdm_FREE_bind);
    Map vdm_FREE_expid__m;
    vdm_FREE_expid__m = vdm_FREE_FreeInBind(vdm_FREE_bind, vdm_FREE_id__s);
    {
      Set vdm_FREE_newid__s;
      Set unArg_15;
      unArg_15 = Set().Insert(vdm_FREE_id__s);
      unArg_15.Insert(vdm_FREE_patid__s);
      unArg_15.Insert(vdm_FREE_expid__m.Dom());
      {
        Set rduset_20;
        Generic tmpe_23;
        for (int bb_22 = unArg_15.First(tmpe_23); bb_22; bb_22 = unArg_15.Next(tmpe_23)) {
          Set e_21 = tmpe_23;
          rduset_20.ImpUnion(e_21);
        }
        vdm_FREE_newid__s = rduset_20;
      }
      {
        Map vdm_FREE_tmp__m;
        vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        {
          Map vdm_FREE_res__m;
          {
            Map m1_36 = vdm_FREE_expid__m;
            Map m2_37 = vdm_FREE_tmp__m;
            Set com_32 = m1_36.Dom();
            com_32.ImpIntersect(m2_37.Dom());
            int all_applies_33 = 1;
            Generic d_34;
            for (int bb_35 = com_32.First(d_34); bb_35 && all_applies_33; bb_35 = com_32.Next(d_34)) 
              all_applies_33 *= m1_36[d_34] == m2_37[d_34];
            if (all_applies_33) 
              m1_36.ImpOverride(m2_37);
            else 
              RunTime("EvalMapMerge Duplicates not equal");
            vdm_FREE_res__m = m1_36;
          }
          {
            Map rexpr_38;
            rexpr_38 = vdm_FREE_res__m;
            return rexpr_38;
          }
        }
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInExistsUniqueExpr");
}

Map vdm_FREE_FreeInExpr(Record vdm_FREE_expr, Set vdm_FREE_id__s) {
  Bool selRes_4;
  selRes_4 = (Bool) true;
  bool succ_5 = true;
  {
    Bool tmpVal_6;
    {
      Record argTmp_7;
      argTmp_7 = vdm_FREE_expr;
      if (argTmp_7.IsRecord()) 
        tmpVal_6 = vdm_AS_DefExpr == argTmp_7.GetTag();
      else 
        tmpVal_6 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_6)).GetValue();
    if (succ_5) {
      Record tmpVar_8;
      tmpVar_8 = vdm_FREE_expr;
      Set tmpVar_9;
      tmpVar_9 = vdm_FREE_id__s;
      return vdm_FREE_FreeInDefExpr(tmpVar_8, tmpVar_9);
    }
  }
  if (!succ_5) {
    Bool tmpVal_10;
    {
      Record argTmp_11;
      argTmp_11 = vdm_FREE_expr;
      if (argTmp_11.IsRecord()) 
        tmpVal_10 = vdm_AS_LetExpr == argTmp_11.GetTag();
      else 
        tmpVal_10 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_10)).GetValue();
    if (succ_5) {
      Record tmpVar_12;
      tmpVar_12 = vdm_FREE_expr;
      Set tmpVar_13;
      tmpVar_13 = vdm_FREE_id__s;
      return vdm_FREE_FreeInLetExpr(tmpVar_12, tmpVar_13);
    }
  }
  if (!succ_5) {
    Bool tmpVal_14;
    {
      Record argTmp_15;
      argTmp_15 = vdm_FREE_expr;
      if (argTmp_15.IsRecord()) 
        tmpVal_14 = vdm_AS_LetBeSTExpr == argTmp_15.GetTag();
      else 
        tmpVal_14 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_14)).GetValue();
    if (succ_5) {
      Record tmpVar_16;
      tmpVar_16 = vdm_FREE_expr;
      Set tmpVar_17;
      tmpVar_17 = vdm_FREE_id__s;
      return vdm_FREE_FreeInLetBeSTExpr(tmpVar_16, tmpVar_17);
    }
  }
  if (!succ_5) {
    Bool tmpVal_18;
    {
      Record argTmp_19;
      argTmp_19 = vdm_FREE_expr;
      if (argTmp_19.IsRecord()) 
        tmpVal_18 = vdm_AS_IfExpr == argTmp_19.GetTag();
      else 
        tmpVal_18 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_18)).GetValue();
    if (succ_5) {
      Record tmpVar_20;
      tmpVar_20 = vdm_FREE_expr;
      Set tmpVar_21;
      tmpVar_21 = vdm_FREE_id__s;
      return vdm_FREE_FreeInIfExpr(tmpVar_20, tmpVar_21);
    }
  }
  if (!succ_5) {
    Bool tmpVal_22;
    {
      Record argTmp_23;
      argTmp_23 = vdm_FREE_expr;
      if (argTmp_23.IsRecord()) 
        tmpVal_22 = vdm_AS_CasesExpr == argTmp_23.GetTag();
      else 
        tmpVal_22 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_22)).GetValue();
    if (succ_5) {
      Record tmpVar_24;
      tmpVar_24 = vdm_FREE_expr;
      Set tmpVar_25;
      tmpVar_25 = vdm_FREE_id__s;
      return vdm_FREE_FreeInCasesExpr(tmpVar_24, tmpVar_25);
    }
  }
  if (!succ_5) {
    Bool tmpVal_26;
    {
      Record argTmp_27;
      argTmp_27 = vdm_FREE_expr;
      if (argTmp_27.IsRecord()) 
        tmpVal_26 = vdm_AS_PrefixExpr == argTmp_27.GetTag();
      else 
        tmpVal_26 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_26)).GetValue();
    if (succ_5) {
      Record tmpVar_28;
      tmpVar_28 = vdm_FREE_expr;
      Set tmpVar_29;
      tmpVar_29 = vdm_FREE_id__s;
      return vdm_FREE_FreeInPrefixExpr(tmpVar_28, tmpVar_29);
    }
  }
  if (!succ_5) {
    Bool tmpVal_30;
    {
      Record argTmp_31;
      argTmp_31 = vdm_FREE_expr;
      if (argTmp_31.IsRecord()) 
        tmpVal_30 = vdm_AS_MapInverseExpr == argTmp_31.GetTag();
      else 
        tmpVal_30 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_30)).GetValue();
    if (succ_5) {
      Record tmpVar_32;
      tmpVar_32 = vdm_FREE_expr;
      Set tmpVar_33;
      tmpVar_33 = vdm_FREE_id__s;
      return vdm_FREE_FreeInMapInverseExpr(tmpVar_32, tmpVar_33);
    }
  }
  if (!succ_5) {
    Bool tmpVal_34;
    {
      Record argTmp_35;
      argTmp_35 = vdm_FREE_expr;
      if (argTmp_35.IsRecord()) 
        tmpVal_34 = vdm_AS_BinaryExpr == argTmp_35.GetTag();
      else 
        tmpVal_34 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_34)).GetValue();
    if (succ_5) {
      Record tmpVar_36;
      tmpVar_36 = vdm_FREE_expr;
      Set tmpVar_37;
      tmpVar_37 = vdm_FREE_id__s;
      return vdm_FREE_FreeInBinaryExpr(tmpVar_36, tmpVar_37);
    }
  }
  if (!succ_5) {
    Bool tmpVal_38;
    {
      Record argTmp_39;
      argTmp_39 = vdm_FREE_expr;
      if (argTmp_39.IsRecord()) 
        tmpVal_38 = vdm_AS_AllOrExistsExpr == argTmp_39.GetTag();
      else 
        tmpVal_38 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_38)).GetValue();
    if (succ_5) {
      Record tmpVar_40;
      tmpVar_40 = vdm_FREE_expr;
      Set tmpVar_41;
      tmpVar_41 = vdm_FREE_id__s;
      return vdm_FREE_FreeInAllOrExistsExpr(tmpVar_40, tmpVar_41);
    }
  }
  if (!succ_5) {
    Bool tmpVal_42;
    {
      Record argTmp_43;
      argTmp_43 = vdm_FREE_expr;
      if (argTmp_43.IsRecord()) 
        tmpVal_42 = vdm_AS_ExistsUniqueExpr == argTmp_43.GetTag();
      else 
        tmpVal_42 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_42)).GetValue();
    if (succ_5) {
      Record tmpVar_44;
      tmpVar_44 = vdm_FREE_expr;
      Set tmpVar_45;
      tmpVar_45 = vdm_FREE_id__s;
      return vdm_FREE_FreeInExistsUniqueExpr(tmpVar_44, tmpVar_45);
    }
  }
  if (!succ_5) {
    Bool tmpVal_46;
    {
      Record argTmp_47;
      argTmp_47 = vdm_FREE_expr;
      if (argTmp_47.IsRecord()) 
        tmpVal_46 = vdm_AS_SetEnumerationExpr == argTmp_47.GetTag();
      else 
        tmpVal_46 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_46)).GetValue();
    if (succ_5) {
      Record tmpVar_48;
      tmpVar_48 = vdm_FREE_expr;
      Set tmpVar_49;
      tmpVar_49 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSetEnumerationExpr(tmpVar_48, tmpVar_49);
    }
  }
  if (!succ_5) {
    Bool tmpVal_50;
    {
      Record argTmp_51;
      argTmp_51 = vdm_FREE_expr;
      if (argTmp_51.IsRecord()) 
        tmpVal_50 = vdm_AS_SetComprehensionExpr == argTmp_51.GetTag();
      else 
        tmpVal_50 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_50)).GetValue();
    if (succ_5) {
      Record tmpVar_52;
      tmpVar_52 = vdm_FREE_expr;
      Set tmpVar_53;
      tmpVar_53 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSetComprehensionExpr(tmpVar_52, tmpVar_53);
    }
  }
  if (!succ_5) {
    Bool tmpVal_54;
    {
      Record argTmp_55;
      argTmp_55 = vdm_FREE_expr;
      if (argTmp_55.IsRecord()) 
        tmpVal_54 = vdm_AS_SetRangeExpr == argTmp_55.GetTag();
      else 
        tmpVal_54 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_54)).GetValue();
    if (succ_5) {
      Record tmpVar_56;
      tmpVar_56 = vdm_FREE_expr;
      Set tmpVar_57;
      tmpVar_57 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSetRangeExpr(tmpVar_56, tmpVar_57);
    }
  }
  if (!succ_5) {
    Bool tmpVal_58;
    {
      Record argTmp_59;
      argTmp_59 = vdm_FREE_expr;
      if (argTmp_59.IsRecord()) 
        tmpVal_58 = vdm_AS_SeqEnumerationExpr == argTmp_59.GetTag();
      else 
        tmpVal_58 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_58)).GetValue();
    if (succ_5) {
      Record tmpVar_60;
      tmpVar_60 = vdm_FREE_expr;
      Set tmpVar_61;
      tmpVar_61 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSeqEnumerationExpr(tmpVar_60, tmpVar_61);
    }
  }
  if (!succ_5) {
    Bool tmpVal_62;
    {
      Record argTmp_63;
      argTmp_63 = vdm_FREE_expr;
      if (argTmp_63.IsRecord()) 
        tmpVal_62 = vdm_AS_SeqComprehensionExpr == argTmp_63.GetTag();
      else 
        tmpVal_62 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_62)).GetValue();
    if (succ_5) {
      Record tmpVar_64;
      tmpVar_64 = vdm_FREE_expr;
      Set tmpVar_65;
      tmpVar_65 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSeqComprehensionExpr(tmpVar_64, tmpVar_65);
    }
  }
  if (!succ_5) {
    Bool tmpVal_66;
    {
      Record argTmp_67;
      argTmp_67 = vdm_FREE_expr;
      if (argTmp_67.IsRecord()) 
        tmpVal_66 = vdm_AS_SubSequenceExpr == argTmp_67.GetTag();
      else 
        tmpVal_66 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_66)).GetValue();
    if (succ_5) {
      Record tmpVar_68;
      tmpVar_68 = vdm_FREE_expr;
      Set tmpVar_69;
      tmpVar_69 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSubSequenceExpr(tmpVar_68, tmpVar_69);
    }
  }
  if (!succ_5) {
    Bool tmpVal_70;
    {
      Record argTmp_71;
      argTmp_71 = vdm_FREE_expr;
      if (argTmp_71.IsRecord()) 
        tmpVal_70 = vdm_AS_SeqModifyMapOverrideExpr == argTmp_71.GetTag();
      else 
        tmpVal_70 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_70)).GetValue();
    if (succ_5) {
      Record tmpVar_72;
      tmpVar_72 = vdm_FREE_expr;
      Set tmpVar_73;
      tmpVar_73 = vdm_FREE_id__s;
      return vdm_FREE_FreeInSeqModifyMapOverrideExpr(tmpVar_72, tmpVar_73);
    }
  }
  if (!succ_5) {
    Bool tmpVal_74;
    {
      Record argTmp_75;
      argTmp_75 = vdm_FREE_expr;
      if (argTmp_75.IsRecord()) 
        tmpVal_74 = vdm_AS_MapEnumerationExpr == argTmp_75.GetTag();
      else 
        tmpVal_74 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_74)).GetValue();
    if (succ_5) {
      Record tmpVar_76;
      tmpVar_76 = vdm_FREE_expr;
      Set tmpVar_77;
      tmpVar_77 = vdm_FREE_id__s;
      return vdm_FREE_FreeInMapEnumerationExpr(tmpVar_76, tmpVar_77);
    }
  }
  if (!succ_5) {
    Bool tmpVal_78;
    {
      Record argTmp_79;
      argTmp_79 = vdm_FREE_expr;
      if (argTmp_79.IsRecord()) 
        tmpVal_78 = vdm_AS_MapComprehensionExpr == argTmp_79.GetTag();
      else 
        tmpVal_78 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_78)).GetValue();
    if (succ_5) {
      Record tmpVar_80;
      tmpVar_80 = vdm_FREE_expr;
      Set tmpVar_81;
      tmpVar_81 = vdm_FREE_id__s;
      return vdm_FREE_FreeInMapComprehensionExpr(tmpVar_80, tmpVar_81);
    }
  }
  if (!succ_5) {
    Bool tmpVal_82;
    {
      Record argTmp_83;
      argTmp_83 = vdm_FREE_expr;
      if (argTmp_83.IsRecord()) 
        tmpVal_82 = vdm_AS_TupleConstructorExpr == argTmp_83.GetTag();
      else 
        tmpVal_82 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_82)).GetValue();
    if (succ_5) {
      Record tmpVar_84;
      tmpVar_84 = vdm_FREE_expr;
      Set tmpVar_85;
      tmpVar_85 = vdm_FREE_id__s;
      return vdm_FREE_FreeInTupleConstructorExpr(tmpVar_84, tmpVar_85);
    }
  }
  if (!succ_5) {
    Bool tmpVal_86;
    {
      Record argTmp_87;
      argTmp_87 = vdm_FREE_expr;
      if (argTmp_87.IsRecord()) 
        tmpVal_86 = vdm_AS_RecordConstructorExpr == argTmp_87.GetTag();
      else 
        tmpVal_86 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_86)).GetValue();
    if (succ_5) {
      Record tmpVar_88;
      tmpVar_88 = vdm_FREE_expr;
      Set tmpVar_89;
      tmpVar_89 = vdm_FREE_id__s;
      return vdm_FREE_FreeInRecordConstructorExpr(tmpVar_88, tmpVar_89);
    }
  }
  if (!succ_5) {
    Bool tmpVal_90;
    {
      Record argTmp_91;
      argTmp_91 = vdm_FREE_expr;
      if (argTmp_91.IsRecord()) 
        tmpVal_90 = vdm_AS_RecordModifierExpr == argTmp_91.GetTag();
      else 
        tmpVal_90 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_90)).GetValue();
    if (succ_5) {
      Record tmpVar_92;
      tmpVar_92 = vdm_FREE_expr;
      Set tmpVar_93;
      tmpVar_93 = vdm_FREE_id__s;
      return vdm_FREE_FreeInRecordModifierExpr(tmpVar_92, tmpVar_93);
    }
  }
  if (!succ_5) {
    Bool tmpVal_94;
    {
      Record argTmp_95;
      argTmp_95 = vdm_FREE_expr;
      if (argTmp_95.IsRecord()) 
        tmpVal_94 = vdm_AS_TokenConstructorExpr == argTmp_95.GetTag();
      else 
        tmpVal_94 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_94)).GetValue();
    if (succ_5) {
      Record tmpVar_96;
      tmpVar_96 = vdm_FREE_expr;
      Set tmpVar_97;
      tmpVar_97 = vdm_FREE_id__s;
      return vdm_FREE_FreeInTokenConstructorExpr(tmpVar_96, tmpVar_97);
    }
  }
  if (!succ_5) {
    Bool tmpVal_98;
    {
      Record argTmp_99;
      argTmp_99 = vdm_FREE_expr;
      if (argTmp_99.IsRecord()) 
        tmpVal_98 = vdm_AS_ApplyExpr == argTmp_99.GetTag();
      else 
        tmpVal_98 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_98)).GetValue();
    if (succ_5) {
      Record tmpVar_100;
      tmpVar_100 = vdm_FREE_expr;
      Set tmpVar_101;
      tmpVar_101 = vdm_FREE_id__s;
      return vdm_FREE_FreeInApplyExpr(tmpVar_100, tmpVar_101);
    }
  }
  if (!succ_5) {
    Bool tmpVal_102;
    {
      Record argTmp_103;
      argTmp_103 = vdm_FREE_expr;
      if (argTmp_103.IsRecord()) 
        tmpVal_102 = vdm_AS_LambdaExpr == argTmp_103.GetTag();
      else 
        tmpVal_102 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_102)).GetValue();
    if (succ_5) {
      Record tmpVar_104;
      tmpVar_104 = vdm_FREE_expr;
      Set tmpVar_105;
      tmpVar_105 = vdm_FREE_id__s;
      return vdm_FREE_FreeInLambdaExpr(tmpVar_104, tmpVar_105);
    }
  }
  if (!succ_5) {
    Bool tmpVal_106;
    {
      Record argTmp_107;
      argTmp_107 = vdm_FREE_expr;
      if (argTmp_107.IsRecord()) 
        tmpVal_106 = vdm_AS_FieldSelectExpr == argTmp_107.GetTag();
      else 
        tmpVal_106 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_106)).GetValue();
    if (succ_5) {
      Record tmpVar_108;
      tmpVar_108 = vdm_FREE_expr;
      Set tmpVar_109;
      tmpVar_109 = vdm_FREE_id__s;
      return vdm_FREE_FreeInFieldSelectExpr(tmpVar_108, tmpVar_109);
    }
  }
  if (!succ_5) {
    Bool tmpVal_110;
    {
      Record argTmp_111;
      argTmp_111 = vdm_FREE_expr;
      if (argTmp_111.IsRecord()) 
        tmpVal_110 = vdm_AS_FctTypeInstExpr == argTmp_111.GetTag();
      else 
        tmpVal_110 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_110)).GetValue();
    if (succ_5) {
      Record tmpVar_112;
      tmpVar_112 = vdm_FREE_expr;
      Set tmpVar_113;
      tmpVar_113 = vdm_FREE_id__s;
      return vdm_FREE_FreeInFctTypeInstExpr(tmpVar_112, tmpVar_113);
    }
  }
  if (!succ_5) {
    Bool tmpVal_114;
    {
      Record argTmp_115;
      argTmp_115 = vdm_FREE_expr;
      if (argTmp_115.IsRecord()) 
        tmpVal_114 = vdm_AS_IsExpr == argTmp_115.GetTag();
      else 
        tmpVal_114 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_114)).GetValue();
    if (succ_5) {
      Record tmpVar_116;
      tmpVar_116 = vdm_FREE_expr;
      Set tmpVar_117;
      tmpVar_117 = vdm_FREE_id__s;
      return vdm_FREE_FreeInIsExpr(tmpVar_116, tmpVar_117);
    }
  }
  if (!succ_5) {
    Bool tmpVal_118;
    {
      Record argTmp_119;
      argTmp_119 = vdm_FREE_expr;
      if (argTmp_119.IsRecord()) 
        tmpVal_118 = vdm_AS_IotaExpr == argTmp_119.GetTag();
      else 
        tmpVal_118 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_118)).GetValue();
    if (succ_5) {
      Record tmpVar_120;
      tmpVar_120 = vdm_FREE_expr;
      Set tmpVar_121;
      tmpVar_121 = vdm_FREE_id__s;
      return vdm_FREE_FreeInIotaExpr(tmpVar_120, tmpVar_121);
    }
  }
  if (!succ_5) {
    Bool tmpVal_122;
    {
      Record argTmp_123;
      argTmp_123 = vdm_FREE_expr;
      if (argTmp_123.IsRecord()) 
        tmpVal_122 = vdm_AS_BoolLit == argTmp_123.GetTag();
      else 
        tmpVal_122 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_122)).GetValue();
    if (!succ_5) {
      Bool tmpVal_124;
      {
        Record argTmp_125;
        argTmp_125 = vdm_FREE_expr;
        if (argTmp_125.IsRecord()) 
          tmpVal_124 = vdm_AS_CharLit == argTmp_125.GetTag();
        else 
          tmpVal_124 = false;
      }
      succ_5 = ((Bool) (selRes_4 == tmpVal_124)).GetValue();
    }
    if (!succ_5) {
      Bool tmpVal_126;
      {
        Record argTmp_127;
        argTmp_127 = vdm_FREE_expr;
        if (argTmp_127.IsRecord()) 
          tmpVal_126 = vdm_AS_TextLit == argTmp_127.GetTag();
        else 
          tmpVal_126 = false;
      }
      succ_5 = ((Bool) (selRes_4 == tmpVal_126)).GetValue();
    }
    if (!succ_5) {
      Bool tmpVal_128;
      {
        Record argTmp_129;
        argTmp_129 = vdm_FREE_expr;
        if (argTmp_129.IsRecord()) 
          tmpVal_128 = vdm_AS_QuoteLit == argTmp_129.GetTag();
        else 
          tmpVal_128 = false;
      }
      succ_5 = ((Bool) (selRes_4 == tmpVal_128)).GetValue();
    }
    if (!succ_5) {
      Bool tmpVal_130;
      {
        Record argTmp_131;
        argTmp_131 = vdm_FREE_expr;
        if (argTmp_131.IsRecord()) 
          tmpVal_130 = vdm_AS_RealLit == argTmp_131.GetTag();
        else 
          tmpVal_130 = false;
      }
      succ_5 = ((Bool) (selRes_4 == tmpVal_130)).GetValue();
    }
    if (!succ_5) {
      Bool tmpVal_132;
      {
        Record argTmp_133;
        argTmp_133 = vdm_FREE_expr;
        if (argTmp_133.IsRecord()) 
          tmpVal_132 = vdm_AS_NilLit == argTmp_133.GetTag();
        else 
          tmpVal_132 = false;
      }
      succ_5 = ((Bool) (selRes_4 == tmpVal_132)).GetValue();
    }
    if (succ_5) {
      Map rexpr_134;
      rexpr_134 = Map();
      return rexpr_134;
    }
  }
  if (!succ_5) {
    Bool tmpVal_135;
    {
      Record argTmp_136;
      argTmp_136 = vdm_FREE_expr;
      if (argTmp_136.IsRecord()) 
        tmpVal_135 = vdm_AS_Name == argTmp_136.GetTag();
      else 
        tmpVal_135 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_135)).GetValue();
    if (succ_5) {
      Record tmpVar_137;
      tmpVar_137 = vdm_FREE_expr;
      Set tmpVar_138;
      tmpVar_138 = vdm_FREE_id__s;
      return vdm_FREE_FreeInName(tmpVar_137, tmpVar_138);
    }
  }
  if (!succ_5) {
    Bool tmpVal_139;
    {
      Record argTmp_140;
      argTmp_140 = vdm_FREE_expr;
      if (argTmp_140.IsRecord()) 
        tmpVal_139 = vdm_AS_OldName == argTmp_140.GetTag();
      else 
        tmpVal_139 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_139)).GetValue();
    if (succ_5) {
      Record tmpVar_141;
      tmpVar_141 = vdm_FREE_expr;
      Set tmpVar_142;
      tmpVar_142 = vdm_FREE_id__s;
      return vdm_FREE_FreeInOldName(tmpVar_141, tmpVar_142);
    }
  }
  if (!succ_5) {
    Bool tmpVal_143;
    {
      Record argTmp_144;
      argTmp_144 = vdm_FREE_expr;
      if (argTmp_144.IsRecord()) 
        tmpVal_143 = vdm_AS_UndefinedExpr == argTmp_144.GetTag();
      else 
        tmpVal_143 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_143)).GetValue();
    if (succ_5) {
      Map rexpr_145;
      rexpr_145 = Map();
      return rexpr_145;
    }
  }
  if (!succ_5) {
    Bool tmpVal_146;
    {
      Record argTmp_147;
      argTmp_147 = vdm_FREE_expr;
      if (argTmp_147.IsRecord()) 
        tmpVal_146 = vdm_AS_BracketedExpr == argTmp_147.GetTag();
      else 
        tmpVal_146 = false;
    }
    succ_5 = ((Bool) (selRes_4 == tmpVal_146)).GetValue();
    if (succ_5) {
      Record tmpVar_148;
      tmpVar_148 = vdm_FREE_expr;
      Set tmpVar_149;
      tmpVar_149 = vdm_FREE_id__s;
      return vdm_FREE_FreeInBracketedExpr(tmpVar_148, tmpVar_149);
    }
  }
  if (!succ_5) {
    Map rexpr_150;
    rexpr_150 = Map();
    return rexpr_150;
  }
}

Map vdm_FREE_FreeInFctTypeInstExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_polyfct(vdm_AS_Name, length_AS_Name);
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_FctTypeInstExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_polyfct = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7(vdm_AS_Name, length_AS_Name);
    tmpVar_7 = vdm_FREE_polyfct;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInFctTypeInstExpr");
}

Map vdm_FREE_FreeInFieldSelectExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_record__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_FieldSelectExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_record__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_record__e;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInFieldSelectExpr");
}

Map vdm_FREE_FreeInFnDef(Record vdm_FREE_fn, Set vdm_FREE_id__s) {
  Map vdm_FREE_res__m;
  Set vdm_FREE_newid__s;
  vdm_FREE_newid__s = vdm_FREE_id__s;
  {
    Bool cond_4;
    {
      Record argTmp_5;
      argTmp_5 = vdm_FREE_fn;
      if (argTmp_5.IsRecord()) 
        cond_4 = vdm_AS_ExplFnDef == argTmp_5.GetTag();
      else 
        cond_4 = false;
    }
    if (cond_4.GetValue()) {
      bool succ_49;
      Record tmpVal_50;
      tmpVal_50 = vdm_FREE_fn;
      Generic vdm_FREE_Post__e;
      Generic vdm_FREE_Pre__e;
      Record vdm_FREE_body;
      Sequence vdm_FREE_parms;
      succ_49 = true;
      {
        succ_49 = false;
        if (tmpVal_50.IsRecord()) 
          if (vdm_AS_ExplFnDef == ((Record) tmpVal_50).GetTag()) {
            Sequence e_l_51;
            for (int i_52 = 1; i_52 <= ((Record) tmpVal_50).Length(); i_52++) 
              e_l_51.ImpAppend(((Record) tmpVal_50).GetField(i_52));
            if (succ_49 = 7 == (Int) (e_l_51.Length())) {
              Generic permI_53;
              permI_53 = (Generic) (e_l_51.Hd());
              succ_49 = true;
              succ_49 = true;
              permI_53 = (Generic) (e_l_51[2]);
              if (succ_49) 
                succ_49 = true;
              permI_53 = (Generic) (e_l_51[3]);
              if (succ_49) 
                succ_49 = true;
              permI_53 = (Generic) (e_l_51[4]);
              if (succ_49) {
                vdm_FREE_parms = permI_53;
                succ_49 = true;
              }
              permI_53 = (Generic) (e_l_51[5]);
              if (succ_49) {
                vdm_FREE_body = permI_53;
                succ_49 = true;
              }
              permI_53 = (Generic) (e_l_51[6]);
              if (succ_49) {
                vdm_FREE_Pre__e = permI_53;
                succ_49 = true;
              }
              permI_53 = (Generic) (e_l_51[7]);
              if (succ_49) {
                vdm_FREE_Post__e = permI_53;
                succ_49 = true;
              }
            }
          }
      }
      if (!succ_49) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Sequence sq_54;
        sq_54 = vdm_FREE_parms;
        Sequence vdm_FREE_pat__l;
        bool succ_56;
        Generic tmpe_67;
        for (int i_66 = sq_54.First(tmpe_67); i_66; i_66 = sq_54.Next(tmpe_67)) {
          Sequence elem_55 = tmpe_67;
          {
            succ_56 = true;
            {
              vdm_FREE_pat__l = elem_55;
              succ_56 = true;
            }
            if (succ_56) {
              Sequence sq_57;
              sq_57 = vdm_FREE_pat__l;
              Record vdm_FREE_pat;
              bool succ_59;
              Generic tmpe_65;
              for (int i_64 = sq_57.First(tmpe_65); i_64; i_64 = sq_57.Next(tmpe_65)) {
                Record elem_58 = tmpe_65;
                {
                  succ_59 = true;
                  {
                    vdm_FREE_pat = elem_58;
                    succ_59 = true;
                  }
                  if (succ_59) {
                    Set rhs_60;
                    {
                      rhs_60 = vdm_FREE_newid__s;
                      rhs_60.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat));
                    }
                    vdm_FREE_newid__s = rhs_60;
                  }
                  else 
                    RunTime("Pattern did not match in sequence for loop");
                }
              }
            }
            else 
              RunTime("Pattern did not match in sequence for loop");
          }
        }
        {
          Map rhs_68;
          rhs_68 = vdm_FREE_FreeInExpr(vdm_FREE_body, vdm_FREE_newid__s);
          vdm_FREE_res__m = rhs_68;
        }
        {
          Set rhs_71;
          {
            rhs_71 = vdm_FREE_newid__s;
            rhs_71.ImpUnion(vdm_FREE_res__m.Dom());
          }
          vdm_FREE_newid__s = rhs_71;
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInPreExpr(vdm_FREE_Pre__e, vdm_FREE_newid__s);
          {
            Map rhs_79;
            {
              Map m1_86 = vdm_FREE_res__m;
              Map m2_87 = vdm_FREE_tmp__m;
              Set com_82 = m1_86.Dom();
              com_82.ImpIntersect(m2_87.Dom());
              int all_applies_83 = 1;
              Generic d_84;
              for (int bb_85 = com_82.First(d_84); bb_85 && all_applies_83; bb_85 = com_82.Next(d_84)) 
                all_applies_83 *= m1_86[d_84] == m2_87[d_84];
              if (all_applies_83) 
                m1_86.ImpOverride(m2_87);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_79 = m1_86;
            }
            vdm_FREE_res__m = rhs_79;
            {
              Set rhs_88;
              {
                rhs_88 = vdm_FREE_newid__s;
                rhs_88.ImpUnion(vdm_FREE_tmp__m.Dom());
              }
              vdm_FREE_newid__s = rhs_88;
            }
          }
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInPostExpr(vdm_FREE_Post__e, vdm_FREE_newid__s);
          {
            Map rhs_96;
            {
              Map m1_103 = vdm_FREE_res__m;
              Map m2_104 = vdm_FREE_tmp__m;
              Set com_99 = m1_103.Dom();
              com_99.ImpIntersect(m2_104.Dom());
              int all_applies_100 = 1;
              Generic d_101;
              for (int bb_102 = com_99.First(d_101); bb_102 && all_applies_100; bb_102 = com_99.Next(d_101)) 
                all_applies_100 *= m1_103[d_101] == m2_104[d_101];
              if (all_applies_100) 
                m1_103.ImpOverride(m2_104);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_96 = m1_103;
            }
            vdm_FREE_res__m = rhs_96;
          }
        }
        {
          Map rexpr_105;
          rexpr_105 = vdm_FREE_res__m;
          return rexpr_105;
        }
      }
    }
    else {
      bool succ_6;
      Record tmpVal_7;
      tmpVal_7 = vdm_FREE_fn;
      Record vdm_FREE_Post__e;
      Generic vdm_FREE_Pre__e;
      Sequence vdm_FREE_partps;
      succ_6 = true;
      {
        succ_6 = false;
        if (tmpVal_7.IsRecord()) 
          if (vdm_AS_ImplFnDef == ((Record) tmpVal_7).GetTag()) {
            Sequence e_l_8;
            for (int i_9 = 1; i_9 <= ((Record) tmpVal_7).Length(); i_9++) 
              e_l_8.ImpAppend(((Record) tmpVal_7).GetField(i_9));
            if (succ_6 = 6 == (Int) (e_l_8.Length())) {
              Generic permI_10;
              permI_10 = (Generic) (e_l_8.Hd());
              succ_6 = true;
              succ_6 = true;
              permI_10 = (Generic) (e_l_8[2]);
              if (succ_6) 
                succ_6 = true;
              permI_10 = (Generic) (e_l_8[3]);
              if (succ_6) {
                vdm_FREE_partps = permI_10;
                succ_6 = true;
              }
              permI_10 = (Generic) (e_l_8[4]);
              if (succ_6) 
                succ_6 = true;
              permI_10 = (Generic) (e_l_8[5]);
              if (succ_6) {
                vdm_FREE_Pre__e = permI_10;
                succ_6 = true;
              }
              permI_10 = (Generic) (e_l_8[6]);
              if (succ_6) {
                vdm_FREE_Post__e = permI_10;
                succ_6 = true;
              }
            }
          }
      }
      if (!succ_6) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Sequence sq_11;
        sq_11 = vdm_FREE_partps;
        Sequence vdm_FREE_pat__l;
        bool succ_13;
        Generic tmpe_27;
        for (int i_26 = sq_11.First(tmpe_27); i_26; i_26 = sq_11.Next(tmpe_27)) {
          Record elem_12 = tmpe_27;
          {
            succ_13 = true;
            {
              succ_13 = false;
              if (elem_12.IsRecord()) 
                if (vdm_AS_PatTypePair == elem_12.GetTag()) {
                  Sequence e_l_23;
                  for (int i_24 = 1; i_24 <= elem_12.Length(); i_24++) 
                    e_l_23.ImpAppend(elem_12.GetField(i_24));
                  if (succ_13 = 2 == (Int) (e_l_23.Length())) {
                    Generic permI_25;
                    permI_25 = (Generic) (e_l_23.Hd());
                    succ_13 = true;
                    {
                      vdm_FREE_pat__l = permI_25;
                      succ_13 = true;
                    }
                    permI_25 = (Generic) (e_l_23[2]);
                    if (succ_13) 
                      succ_13 = true;
                  }
                }
            }
            if (succ_13) {
              Sequence sq_14;
              sq_14 = vdm_FREE_pat__l;
              Record vdm_FREE_pat;
              bool succ_16;
              Generic tmpe_22;
              for (int i_21 = sq_14.First(tmpe_22); i_21; i_21 = sq_14.Next(tmpe_22)) {
                Record elem_15 = tmpe_22;
                {
                  succ_16 = true;
                  {
                    vdm_FREE_pat = elem_15;
                    succ_16 = true;
                  }
                  if (succ_16) {
                    Set rhs_17;
                    {
                      rhs_17 = vdm_FREE_newid__s;
                      rhs_17.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat));
                    }
                    vdm_FREE_newid__s = rhs_17;
                  }
                  else 
                    RunTime("Pattern did not match in sequence for loop");
                }
              }
            }
            else 
              RunTime("Pattern did not match in sequence for loop");
          }
        }
        {
          Map rhs_28;
          rhs_28 = vdm_FREE_FreeInPreExpr(vdm_FREE_Pre__e, vdm_FREE_newid__s);
          vdm_FREE_res__m = rhs_28;
        }
        {
          Set rhs_31;
          {
            rhs_31 = vdm_FREE_newid__s;
            rhs_31.ImpUnion(vdm_FREE_res__m.Dom());
          }
          vdm_FREE_newid__s = rhs_31;
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInPostExpr(vdm_FREE_Post__e, vdm_FREE_newid__s);
          {
            Map rhs_39;
            {
              Map m1_46 = vdm_FREE_res__m;
              Map m2_47 = vdm_FREE_tmp__m;
              Set com_42 = m1_46.Dom();
              com_42.ImpIntersect(m2_47.Dom());
              int all_applies_43 = 1;
              Generic d_44;
              for (int bb_45 = com_42.First(d_44); bb_45 && all_applies_43; bb_45 = com_42.Next(d_44)) 
                all_applies_43 *= m1_46[d_44] == m2_47[d_44];
              if (all_applies_43) 
                m1_46.ImpOverride(m2_47);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_39 = m1_46;
            }
            vdm_FREE_res__m = rhs_39;
          }
        }
        {
          Map rexpr_48;
          rexpr_48 = vdm_FREE_res__m;
          return rexpr_48;
        }
      }
    }
  }
}

Map vdm_FREE_FreeInIfExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_altn__e;
  Record vdm_FREE_cons__e;
  Sequence vdm_FREE_elif;
  Set vdm_FREE_id__s;
  Record vdm_FREE_test__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IfExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 5 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_test__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_cons__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_elif = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) {
            vdm_FREE_altn__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[5]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInExpr(vdm_FREE_test__e, vdm_FREE_newid__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        rhs_10 = vdm_FREE_newid__s;
        rhs_10.ImpUnion(vdm_FREE_res__m.Dom());
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_cons__e, vdm_FREE_newid__s);
      {
        Map rhs_18;
        {
          Map m1_25 = vdm_FREE_res__m;
          Map m2_26 = vdm_FREE_tmp__m;
          Set com_21 = m1_25.Dom();
          com_21.ImpIntersect(m2_26.Dom());
          int all_applies_22 = 1;
          Generic d_23;
          for (int bb_24 = com_21.First(d_23); bb_24 && all_applies_22; bb_24 = com_21.Next(d_23)) 
            all_applies_22 *= m1_25[d_23] == m2_26[d_23];
          if (all_applies_22) 
            m1_25.ImpOverride(m2_26);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_18 = m1_25;
        }
        vdm_FREE_res__m = rhs_18;
        {
          Set rhs_27;
          {
            rhs_27 = vdm_FREE_newid__s;
            rhs_27.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_27;
        }
      }
    }
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInElseifExpr(vdm_FREE_elif, vdm_FREE_newid__s);
      {
        Map rhs_35;
        {
          Map m1_42 = vdm_FREE_res__m;
          Map m2_43 = vdm_FREE_tmp__m;
          Set com_38 = m1_42.Dom();
          com_38.ImpIntersect(m2_43.Dom());
          int all_applies_39 = 1;
          Generic d_40;
          for (int bb_41 = com_38.First(d_40); bb_41 && all_applies_39; bb_41 = com_38.Next(d_40)) 
            all_applies_39 *= m1_42[d_40] == m2_43[d_40];
          if (all_applies_39) 
            m1_42.ImpOverride(m2_43);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_35 = m1_42;
        }
        vdm_FREE_res__m = rhs_35;
        {
          Set rhs_44;
          {
            rhs_44 = vdm_FREE_newid__s;
            rhs_44.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_44;
        }
      }
    }
    {
      Map rhs_48;
      rhs_48 = vdm_FREE_FreeInExpr(vdm_FREE_altn__e, vdm_FREE_newid__s);
      vdm_FREE_res__m = rhs_48;
    }
    {
      Map rexpr_51;
      rexpr_51 = vdm_FREE_res__m;
      return rexpr_51;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInIfExpr");
}

Map vdm_FREE_FreeInIotaExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_bind;
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IotaExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_bind = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Set vdm_FREE_patid__s;
    vdm_FREE_patid__s = vdm_FREE_IdentInBind(vdm_FREE_bind);
    Map vdm_FREE_expid__m;
    vdm_FREE_expid__m = vdm_FREE_FreeInBind(vdm_FREE_bind, vdm_FREE_id__s);
    {
      Set vdm_FREE_newid__s;
      Set unArg_15;
      unArg_15 = Set().Insert(vdm_FREE_id__s);
      unArg_15.Insert(vdm_FREE_patid__s);
      unArg_15.Insert(vdm_FREE_expid__m.Dom());
      {
        Set rduset_20;
        Generic tmpe_23;
        for (int bb_22 = unArg_15.First(tmpe_23); bb_22; bb_22 = unArg_15.Next(tmpe_23)) {
          Set e_21 = tmpe_23;
          rduset_20.ImpUnion(e_21);
        }
        vdm_FREE_newid__s = rduset_20;
      }
      {
        Map vdm_FREE_tmp__m;
        vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        {
          Map vdm_FREE_res__m;
          {
            Map m1_36 = vdm_FREE_expid__m;
            Map m2_37 = vdm_FREE_tmp__m;
            Set com_32 = m1_36.Dom();
            com_32.ImpIntersect(m2_37.Dom());
            int all_applies_33 = 1;
            Generic d_34;
            for (int bb_35 = com_32.First(d_34); bb_35 && all_applies_33; bb_35 = com_32.Next(d_34)) 
              all_applies_33 *= m1_36[d_34] == m2_37[d_34];
            if (all_applies_33) 
              m1_36.ImpOverride(m2_37);
            else 
              RunTime("EvalMapMerge Duplicates not equal");
            vdm_FREE_res__m = m1_36;
          }
          {
            Map rexpr_38;
            rexpr_38 = vdm_FREE_res__m;
            return rexpr_38;
          }
        }
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInIotaExpr");
}

Map vdm_FREE_FreeInIsExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_arg__e;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IsExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          succ_3 = true;
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_arg__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_arg__e;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInIsExpr");
}

Map vdm_FREE_FreeInLambdaExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_body__e;
  Set vdm_FREE_id__s;
  Sequence vdm_FREE_tb__l;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LambdaExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_tb__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_body__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Set vdm_FREE_newid__s;
    Set unArg_9;
    Set res_s_10;
    {
      Sequence seq_lv_17;
      bool succ_15;
      Bool tsucc_18;
      tsucc_18 = true;
      {
        Set tmpVar_v_16;
        {
          Set riseq_21;
          int max_22 = (Int) (vdm_FREE_tb__l.Length());
          for (int i_23 = 1; i_23 <= max_22; i_23++) 
            riseq_21.Insert((Int) i_23);
          tmpVar_v_16 = riseq_21;
        }
{ seq_lv_17.ImpAppend(tmpVar_v_16); }
      }
      Set allComb_19 = GenAllComb(seq_lv_17);
      Int vdm_FREE_i;
      Generic tmpe_32;
      for (int bb_31 = allComb_19.First(tmpe_32); bb_31; bb_31 = allComb_19.Next(tmpe_32)) {
        Sequence tmp_29 = tmpe_32;
        {
          if (succ_15 = 1 == (Int) (tmp_29.Length())) {
            Int permI_30;
            permI_30 = (Int) (tmp_29.Hd());
            succ_15 = true;
            {
              vdm_FREE_i = permI_30;
              succ_15 = true;
            }
          }
          if (succ_15) {
            Set elem_11;
            {
              Record tmpVar_12(vdm_AS_TypeBind, length_AS_TypeBind);
              {
                Sequence tmpseq_13;
                tmpseq_13 = vdm_FREE_tb__l;
                tmpVar_12 = (Record) (tmpseq_13[vdm_FREE_i.GetValue()]);
              }
              elem_11 = vdm_FREE_IdentInBind(tmpVar_12);
            }
            res_s_10.Insert(elem_11);
          }
        }
      }
    }
    unArg_9 = res_s_10;
    {
      Set rduset_33;
      Generic tmpe_36;
      for (int bb_35 = unArg_9.First(tmpe_36); bb_35; bb_35 = unArg_9.Next(tmpe_36)) {
        Set e_34 = tmpe_36;
        rduset_33.ImpUnion(e_34);
      }
      vdm_FREE_newid__s = rduset_33;
    }
    {
      Record tmpVar_37;
      tmpVar_37 = vdm_FREE_body__e;
      Set tmpVar_38;
      {
        tmpVar_38 = vdm_FREE_id__s;
        tmpVar_38.ImpUnion(vdm_FREE_newid__s);
      }
      return vdm_FREE_FreeInExpr(tmpVar_37, tmpVar_38);
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInLambdaExpr");
}

Map vdm_FREE_FreeInLetBeSTExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_in__e;
  Record vdm_FREE_lhs;
  Generic vdm_FREE_st__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LetBeSTExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 4 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_lhs = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_st__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_in__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Set vdm_FREE_patid__s;
    vdm_FREE_patid__s = vdm_FREE_IdentInBind(vdm_FREE_lhs);
    Map vdm_FREE_expid__m;
    vdm_FREE_expid__m = vdm_FREE_FreeInBind(vdm_FREE_lhs, vdm_FREE_id__s);
    {
      Map vdm_FREE_stid__m;
      Set tmpVar_16;
      {
        Set var1_17;
        var1_17 = vdm_FREE_id__s;
        var1_17.ImpUnion(vdm_FREE_patid__s);
        tmpVar_16 = var1_17;
        tmpVar_16.ImpUnion(vdm_FREE_expid__m.Dom());
      }
      vdm_FREE_stid__m = vdm_FREE_FreeInExpr(vdm_FREE_st__e, tmpVar_16);
      {
        Set vdm_FREE_newid__s;
        Set unArg_24;
        unArg_24 = Set().Insert(vdm_FREE_id__s);
        unArg_24.Insert(vdm_FREE_expid__m.Dom());
        unArg_24.Insert(vdm_FREE_stid__m.Dom());
        unArg_24.Insert(vdm_FREE_patid__s);
        {
          Set rduset_31;
          Generic tmpe_34;
          for (int bb_33 = unArg_24.First(tmpe_34); bb_33; bb_33 = unArg_24.Next(tmpe_34)) {
            Set e_32 = tmpe_34;
            rduset_31.ImpUnion(e_32);
          }
          vdm_FREE_newid__s = rduset_31;
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_in__e, vdm_FREE_newid__s);
          {
            Map vdm_FREE_res__m;
            Set unArg_41;
            unArg_41 = Set().Insert(vdm_FREE_expid__m);
            unArg_41.Insert(vdm_FREE_stid__m);
            unArg_41.Insert(vdm_FREE_tmp__m);
            {
              Map rdmmap_45;
              Generic tmpe_54;
              for (int bb_53 = unArg_41.First(tmpe_54); bb_53; bb_53 = unArg_41.Next(tmpe_54)) {
                Map e_46 = tmpe_54;
                {
                  Set eq_dom_48 = rdmmap_45.Dom();
                  eq_dom_48.ImpIntersect(e_46.Dom());
                  bool all_dup_eq_49 = true;
                  Generic tmpe_52;
                  for (int bb_51 = eq_dom_48.First(tmpe_52); bb_51 && all_dup_eq_49; bb_51 = eq_dom_48.Next(tmpe_52)) {
                    Record d_50 = tmpe_52;
{ all_dup_eq_49 = (Record) (rdmmap_45[d_50]) == (Record) (e_46[d_50]); }
                  }
                  if (!all_dup_eq_49) 
                    RunTime("Duplicate entries for 'merge' had different values");
                  rdmmap_45.ImpOverride(e_46);
                }
              }
              vdm_FREE_res__m = rdmmap_45;
            }
            {
              Map rexpr_55;
              rexpr_55 = vdm_FREE_res__m;
              return rexpr_55;
            }
          }
        }
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInLetBeSTExpr");
}

Map vdm_FREE_FreeInLetExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_in__e;
  Sequence vdm_FREE_localdef;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LetExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_localdef = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_in__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_localdef;
      Record vdm_FREE_ldef;
      bool succ_9;
      Generic tmpe_34;
      for (int i_33 = sq_7.First(tmpe_34); i_33; i_33 = sq_7.Next(tmpe_34)) {
        Record elem_8 = tmpe_34;
        {
          succ_9 = true;
          {
            vdm_FREE_ldef = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            Bool selRes_10;
            selRes_10 = (Bool) true;
            bool succ_11 = true;
            {
              Bool tmpVal_12;
              {
                Record argTmp_13;
                argTmp_13 = vdm_FREE_ldef;
                if (argTmp_13.IsRecord()) 
                  tmpVal_12 = vdm_AS_ExplFnDef == argTmp_13.GetTag();
                else 
                  tmpVal_12 = false;
              }
              succ_11 = ((Bool) (selRes_10 == tmpVal_12)).GetValue();
              if (succ_11) {
                Set rhs_14;
                {
                  Set var2_16;
                  Record tmpVar_17(vdm_AS_Name, length_AS_Name);
                  Record tmpRec_18;
                  tmpRec_18 = vdm_FREE_ldef;
                  if (((Record) tmpRec_18).Is(vdm_AS_ImplFnDef)) 
                    tmpVar_17 = ((Record) tmpRec_18).GetField(pos_AS_ImplFnDef_nm);
                  else 
                    if (((Record) tmpRec_18).Is(vdm_AS_ExtExplFnDef)) 
                      tmpVar_17 = ((Record) tmpRec_18).GetField(pos_AS_ExtExplFnDef_nm);
                    else 
                      if (((Record) tmpRec_18).Is(vdm_AS_ExplFnDef)) 
                        tmpVar_17 = ((Record) tmpRec_18).GetField(pos_AS_ExplFnDef_nm);
                      else 
                        RunTime("Unknown record field selector");
                  var2_16 = Set().Insert(tmpVar_17);
                  rhs_14 = vdm_FREE_newid__s;
                  rhs_14.ImpUnion(var2_16);
                }
                vdm_FREE_newid__s = rhs_14;
              }
            }
            if (!succ_11) {
              Bool tmpVal_19;
              {
                Record argTmp_20;
                argTmp_20 = vdm_FREE_ldef;
                if (argTmp_20.IsRecord()) 
                  tmpVal_19 = vdm_AS_ImplFnDef == argTmp_20.GetTag();
                else 
                  tmpVal_19 = false;
              }
              succ_11 = ((Bool) (selRes_10 == tmpVal_19)).GetValue();
              if (succ_11) {
                Set rhs_21;
                {
                  Set var2_23;
                  Record tmpVar_24(vdm_AS_Name, length_AS_Name);
                  Record tmpRec_25;
                  tmpRec_25 = vdm_FREE_ldef;
                  if (((Record) tmpRec_25).Is(vdm_AS_ImplFnDef)) 
                    tmpVar_24 = ((Record) tmpRec_25).GetField(pos_AS_ImplFnDef_nm);
                  else 
                    if (((Record) tmpRec_25).Is(vdm_AS_ExtExplFnDef)) 
                      tmpVar_24 = ((Record) tmpRec_25).GetField(pos_AS_ExtExplFnDef_nm);
                    else 
                      if (((Record) tmpRec_25).Is(vdm_AS_ExplFnDef)) 
                        tmpVar_24 = ((Record) tmpRec_25).GetField(pos_AS_ExplFnDef_nm);
                      else 
                        RunTime("Unknown record field selector");
                  var2_23 = Set().Insert(tmpVar_24);
                  rhs_21 = vdm_FREE_newid__s;
                  rhs_21.ImpUnion(var2_23);
                }
                vdm_FREE_newid__s = rhs_21;
              }
            }
            if (!succ_11) {
              Bool tmpVal_26;
              {
                Record argTmp_27;
                argTmp_27 = vdm_FREE_ldef;
                if (argTmp_27.IsRecord()) 
                  tmpVal_26 = vdm_AS_ValueDef == argTmp_27.GetTag();
                else 
                  tmpVal_26 = false;
              }
              succ_11 = ((Bool) (selRes_10 == tmpVal_26)).GetValue();
              if (succ_11) {
                Set rhs_28;
                {
                  Set var2_30;
                  Record tmpVar_31;
                  {
                    Record tmpRec_32;
                    tmpRec_32 = vdm_FREE_ldef;
                    if (((Record) tmpRec_32).Is(vdm_AS_ValueDef)) 
                      tmpVar_31 = ((Record) tmpRec_32).GetField(pos_AS_ValueDef_pat);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  var2_30 = vdm_FREE_IdentInPattern(tmpVar_31);
                  rhs_28 = vdm_FREE_newid__s;
                  rhs_28.ImpUnion(var2_30);
                }
                vdm_FREE_newid__s = rhs_28;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Sequence sq_35;
      sq_35 = vdm_FREE_localdef;
      Record vdm_FREE_ldef;
      bool succ_37;
      Generic tmpe_99;
      for (int i_98 = sq_35.First(tmpe_99); i_98; i_98 = sq_35.Next(tmpe_99)) {
        Record elem_36 = tmpe_99;
        {
          succ_37 = true;
          {
            vdm_FREE_ldef = elem_36;
            succ_37 = true;
          }
          if (succ_37) {
            Bool selRes_38;
            selRes_38 = (Bool) true;
            bool succ_39 = true;
            {
              Bool tmpVal_40;
              {
                Record argTmp_41;
                argTmp_41 = vdm_FREE_ldef;
                if (argTmp_41.IsRecord()) 
                  tmpVal_40 = vdm_AS_ExplFnDef == argTmp_41.GetTag();
                else 
                  tmpVal_40 = false;
              }
              succ_39 = ((Bool) (selRes_38 == tmpVal_40)).GetValue();
              if (succ_39) {
                Map vdm_FREE_tmp__m;
                vdm_FREE_tmp__m = vdm_FREE_FreeInFnDef(vdm_FREE_ldef, vdm_FREE_newid__s);
                {
                  Map rhs_46;
                  {
                    Map m1_53 = vdm_FREE_res__m;
                    Map m2_54 = vdm_FREE_tmp__m;
                    Set com_49 = m1_53.Dom();
                    com_49.ImpIntersect(m2_54.Dom());
                    int all_applies_50 = 1;
                    Generic d_51;
                    for (int bb_52 = com_49.First(d_51); bb_52 && all_applies_50; bb_52 = com_49.Next(d_51)) 
                      all_applies_50 *= m1_53[d_51] == m2_54[d_51];
                    if (all_applies_50) 
                      m1_53.ImpOverride(m2_54);
                    else 
                      RunTime("EvalMapMerge Duplicates not equal");
                    rhs_46 = m1_53;
                  }
                  vdm_FREE_res__m = rhs_46;
                  {
                    Set rhs_55;
                    {
                      rhs_55 = vdm_FREE_newid__s;
                      rhs_55.ImpUnion(vdm_FREE_tmp__m.Dom());
                    }
                    vdm_FREE_newid__s = rhs_55;
                  }
                }
              }
            }
            if (!succ_39) {
              Bool tmpVal_59;
              {
                Record argTmp_60;
                argTmp_60 = vdm_FREE_ldef;
                if (argTmp_60.IsRecord()) 
                  tmpVal_59 = vdm_AS_ImplFnDef == argTmp_60.GetTag();
                else 
                  tmpVal_59 = false;
              }
              succ_39 = ((Bool) (selRes_38 == tmpVal_59)).GetValue();
              if (succ_39) {
                Map vdm_FREE_tmp__m;
                vdm_FREE_tmp__m = vdm_FREE_FreeInFnDef(vdm_FREE_ldef, vdm_FREE_newid__s);
                {
                  Map rhs_65;
                  {
                    Map m1_72 = vdm_FREE_res__m;
                    Map m2_73 = vdm_FREE_tmp__m;
                    Set com_68 = m1_72.Dom();
                    com_68.ImpIntersect(m2_73.Dom());
                    int all_applies_69 = 1;
                    Generic d_70;
                    for (int bb_71 = com_68.First(d_70); bb_71 && all_applies_69; bb_71 = com_68.Next(d_70)) 
                      all_applies_69 *= m1_72[d_70] == m2_73[d_70];
                    if (all_applies_69) 
                      m1_72.ImpOverride(m2_73);
                    else 
                      RunTime("EvalMapMerge Duplicates not equal");
                    rhs_65 = m1_72;
                  }
                  vdm_FREE_res__m = rhs_65;
                  {
                    Set rhs_74;
                    {
                      rhs_74 = vdm_FREE_newid__s;
                      rhs_74.ImpUnion(vdm_FREE_tmp__m.Dom());
                    }
                    vdm_FREE_newid__s = rhs_74;
                  }
                }
              }
            }
            if (!succ_39) {
              Bool tmpVal_78;
              {
                Record argTmp_79;
                argTmp_79 = vdm_FREE_ldef;
                if (argTmp_79.IsRecord()) 
                  tmpVal_78 = vdm_AS_ValueDef == argTmp_79.GetTag();
                else 
                  tmpVal_78 = false;
              }
              succ_39 = ((Bool) (selRes_38 == tmpVal_78)).GetValue();
              if (succ_39) {
                Map vdm_FREE_tmp__m;
                Record tmpVar_82;
                {
                  Record tmpRec_83;
                  tmpRec_83 = vdm_FREE_ldef;
                  if (((Record) tmpRec_83).Is(vdm_AS_ValueDef)) 
                    tmpVar_82 = ((Record) tmpRec_83).GetField(pos_AS_ValueDef_val);
                  else 
                    RunTime("Unknown record field selector");
                }
                vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(tmpVar_82, vdm_FREE_newid__s);
                {
                  Map rhs_85;
                  {
                    Map m1_92 = vdm_FREE_res__m;
                    Map m2_93 = vdm_FREE_tmp__m;
                    Set com_88 = m1_92.Dom();
                    com_88.ImpIntersect(m2_93.Dom());
                    int all_applies_89 = 1;
                    Generic d_90;
                    for (int bb_91 = com_88.First(d_90); bb_91 && all_applies_89; bb_91 = com_88.Next(d_90)) 
                      all_applies_89 *= m1_92[d_90] == m2_93[d_90];
                    if (all_applies_89) 
                      m1_92.ImpOverride(m2_93);
                    else 
                      RunTime("EvalMapMerge Duplicates not equal");
                    rhs_85 = m1_92;
                  }
                  vdm_FREE_res__m = rhs_85;
                  {
                    Set rhs_94;
                    {
                      rhs_94 = vdm_FREE_newid__s;
                      rhs_94.ImpUnion(vdm_FREE_tmp__m.Dom());
                    }
                    vdm_FREE_newid__s = rhs_94;
                  }
                }
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rhs_100;
      {
        Map m1_109 = vdm_FREE_res__m;
        Map m2_110 = vdm_FREE_FreeInExpr(vdm_FREE_in__e, vdm_FREE_newid__s);
        Set com_105 = m1_109.Dom();
        com_105.ImpIntersect(m2_110.Dom());
        int all_applies_106 = 1;
        Generic d_107;
        for (int bb_108 = com_105.First(d_107); bb_108 && all_applies_106; bb_108 = com_105.Next(d_107)) 
          all_applies_106 *= m1_109[d_107] == m2_110[d_107];
        if (all_applies_106) 
          m1_109.ImpOverride(m2_110);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_100 = m1_109;
      }
      vdm_FREE_res__m = rhs_100;
    }
    {
      Map rexpr_111;
      rexpr_111 = vdm_FREE_res__m;
      return rexpr_111;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInLetExpr");
}

Map vdm_FREE_FreeInMapComprehensionExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_bind__l;
  Record vdm_FREE_elem(vdm_AS_Maplet, length_AS_Maplet);
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 5 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_elem = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_bind__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[5]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInMultBindSeq(vdm_FREE_bind__l, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        Set unArg_11;
        unArg_11 = Set().Insert(vdm_FREE_id__s);
        unArg_11.Insert(vdm_FREE_res__m.Dom());
        unArg_11.Insert(vdm_FREE_IdentInMultBindSeq(vdm_FREE_bind__l));
        {
          Set rduset_17;
          Generic tmpe_20;
          for (int bb_19 = unArg_11.First(tmpe_20); bb_19; bb_19 = unArg_11.Next(tmpe_20)) {
            Set e_18 = tmpe_20;
            rduset_17.ImpUnion(e_18);
          }
          rhs_10 = rduset_17;
        }
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      bool succ_21;
      Record tmpVal_22(vdm_AS_Maplet, length_AS_Maplet);
      tmpVal_22 = vdm_FREE_elem;
      Record vdm_FREE_dom__e;
      Record vdm_FREE_rng__e;
      succ_21 = true;
      {
        succ_21 = false;
        if (tmpVal_22.IsRecord()) 
          if (vdm_AS_Maplet == tmpVal_22.GetTag()) {
            Sequence e_l_23;
            for (int i_24 = 1; i_24 <= tmpVal_22.Length(); i_24++) 
              e_l_23.ImpAppend(tmpVal_22.GetField(i_24));
            if (succ_21 = 2 == (Int) (e_l_23.Length())) {
              Record permI_25;
              permI_25 = (Record) (e_l_23.Hd());
              succ_21 = true;
              {
                vdm_FREE_dom__e = permI_25;
                succ_21 = true;
              }
              permI_25 = (Record) (e_l_23[2]);
              if (succ_21) {
                vdm_FREE_rng__e = permI_25;
                succ_21 = true;
              }
            }
          }
      }
      if (!succ_21) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Map vdm_FREE_tmp__m;
        vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_dom__e, vdm_FREE_newid__s);
        {
          Map rhs_30;
          {
            Map m1_37 = vdm_FREE_res__m;
            Map m2_38 = vdm_FREE_tmp__m;
            Set com_33 = m1_37.Dom();
            com_33.ImpIntersect(m2_38.Dom());
            int all_applies_34 = 1;
            Generic d_35;
            for (int bb_36 = com_33.First(d_35); bb_36 && all_applies_34; bb_36 = com_33.Next(d_35)) 
              all_applies_34 *= m1_37[d_35] == m2_38[d_35];
            if (all_applies_34) 
              m1_37.ImpOverride(m2_38);
            else 
              RunTime("EvalMapMerge Duplicates not equal");
            rhs_30 = m1_37;
          }
          vdm_FREE_res__m = rhs_30;
          {
            Set rhs_39;
            {
              rhs_39 = vdm_FREE_newid__s;
              rhs_39.ImpUnion(vdm_FREE_tmp__m.Dom());
            }
            vdm_FREE_newid__s = rhs_39;
          }
        }
        {
          Map vdm_FREE_tmp__m;
          vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_rng__e, vdm_FREE_newid__s);
          {
            Map rhs_47;
            {
              Map m1_54 = vdm_FREE_res__m;
              Map m2_55 = vdm_FREE_tmp__m;
              Set com_50 = m1_54.Dom();
              com_50.ImpIntersect(m2_55.Dom());
              int all_applies_51 = 1;
              Generic d_52;
              for (int bb_53 = com_50.First(d_52); bb_53 && all_applies_51; bb_53 = com_50.Next(d_52)) 
                all_applies_51 *= m1_54[d_52] == m2_55[d_52];
              if (all_applies_51) 
                m1_54.ImpOverride(m2_55);
              else 
                RunTime("EvalMapMerge Duplicates not equal");
              rhs_47 = m1_54;
            }
            vdm_FREE_res__m = rhs_47;
            {
              Set rhs_56;
              {
                rhs_56 = vdm_FREE_newid__s;
                rhs_56.ImpUnion(vdm_FREE_tmp__m.Dom());
              }
              vdm_FREE_newid__s = rhs_56;
            }
          }
        }
      }
    }
    {
      Map rhs_60;
      {
        Map m1_69 = vdm_FREE_res__m;
        Map m2_70 = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        Set com_65 = m1_69.Dom();
        com_65.ImpIntersect(m2_70.Dom());
        int all_applies_66 = 1;
        Generic d_67;
        for (int bb_68 = com_65.First(d_67); bb_68 && all_applies_66; bb_68 = com_65.Next(d_67)) 
          all_applies_66 *= m1_69[d_67] == m2_70[d_67];
        if (all_applies_66) 
          m1_69.ImpOverride(m2_70);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_60 = m1_69;
      }
      vdm_FREE_res__m = rhs_60;
    }
    {
      Map rexpr_71;
      rexpr_71 = vdm_FREE_res__m;
      return rexpr_71;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInMapComprehensionExpr");
}

Map vdm_FREE_FreeInMapEnumerationExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_els__l;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_els__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_els__l;
      Record vdm_FREE_dom__e;
      Record vdm_FREE_rng__e;
      bool succ_9;
      Generic tmpe_48;
      for (int i_47 = sq_7.First(tmpe_48); i_47; i_47 = sq_7.Next(tmpe_48)) {
        Record elem_8 = tmpe_48;
        {
          succ_9 = true;
          {
            succ_9 = false;
            if (elem_8.IsRecord()) 
              if (vdm_AS_Maplet == elem_8.GetTag()) {
                Sequence e_l_44;
                for (int i_45 = 1; i_45 <= elem_8.Length(); i_45++) 
                  e_l_44.ImpAppend(elem_8.GetField(i_45));
                if (succ_9 = 2 == (Int) (e_l_44.Length())) {
                  Record permI_46;
                  permI_46 = (Record) (e_l_44.Hd());
                  succ_9 = true;
                  {
                    vdm_FREE_dom__e = permI_46;
                    succ_9 = true;
                  }
                  permI_46 = (Record) (e_l_44[2]);
                  if (succ_9) {
                    vdm_FREE_rng__e = permI_46;
                    succ_9 = true;
                  }
                }
              }
          }
          if (succ_9) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_dom__e, vdm_FREE_newid__s);
            {
              Map rhs_14;
              {
                Map m1_21 = vdm_FREE_res__m;
                Map m2_22 = vdm_FREE_tmp__m;
                Set com_17 = m1_21.Dom();
                com_17.ImpIntersect(m2_22.Dom());
                int all_applies_18 = 1;
                Generic d_19;
                for (int bb_20 = com_17.First(d_19); bb_20 && all_applies_18; bb_20 = com_17.Next(d_19)) 
                  all_applies_18 *= m1_21[d_19] == m2_22[d_19];
                if (all_applies_18) 
                  m1_21.ImpOverride(m2_22);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_14 = m1_21;
              }
              vdm_FREE_res__m = rhs_14;
              {
                Set rhs_23;
                {
                  rhs_23 = vdm_FREE_newid__s;
                  rhs_23.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_23;
              }
            }
            {
              Map vdm_FREE_tmp__m;
              vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_rng__e, vdm_FREE_newid__s);
              {
                Map rhs_31;
                {
                  Map m1_38 = vdm_FREE_res__m;
                  Map m2_39 = vdm_FREE_tmp__m;
                  Set com_34 = m1_38.Dom();
                  com_34.ImpIntersect(m2_39.Dom());
                  int all_applies_35 = 1;
                  Generic d_36;
                  for (int bb_37 = com_34.First(d_36); bb_37 && all_applies_35; bb_37 = com_34.Next(d_36)) 
                    all_applies_35 *= m1_38[d_36] == m2_39[d_36];
                  if (all_applies_35) 
                    m1_38.ImpOverride(m2_39);
                  else 
                    RunTime("EvalMapMerge Duplicates not equal");
                  rhs_31 = m1_38;
                }
                vdm_FREE_res__m = rhs_31;
                {
                  Set rhs_40;
                  {
                    rhs_40 = vdm_FREE_newid__s;
                    rhs_40.ImpUnion(vdm_FREE_tmp__m.Dom());
                  }
                  vdm_FREE_newid__s = rhs_40;
                }
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_49;
      rexpr_49 = vdm_FREE_res__m;
      return rexpr_49;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInMapEnumerationExpr");
}

Map vdm_FREE_FreeInMapInverseExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_op;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapInverseExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_op = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_op;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInMapInverseExpr");
}

Map vdm_FREE_FreeInMultBindSeq(Sequence vdm_FREE_bind__l, Set vdm_FREE_id__s) {
  Set vdm_FREE_newid__s;
  vdm_FREE_newid__s = vdm_FREE_id__s;
  Map vdm_FREE_res__m;
  vdm_FREE_res__m = Map();
  {
    Sequence sq_4;
    sq_4 = vdm_FREE_bind__l;
    Record vdm_FREE_bind;
    bool succ_6;
    Generic tmpe_51;
    for (int i_50 = sq_4.First(tmpe_51); i_50; i_50 = sq_4.Next(tmpe_51)) {
      Record elem_5 = tmpe_51;
      {
        succ_6 = true;
        {
          vdm_FREE_bind = elem_5;
          succ_6 = true;
        }
        if (succ_6) {
          Record selRes_7;
          selRes_7 = vdm_FREE_bind;
          bool succ_8 = true;
          {
            Sequence vdm_FREE_pat__l;
            Record vdm_FREE_set__e;
            {
              succ_8 = false;
              if (selRes_7.IsRecord()) 
                if (vdm_AS_MultSetBind == ((Record) selRes_7).GetTag()) {
                  Sequence e_l_9;
                  for (int i_10 = 1; i_10 <= ((Record) selRes_7).Length(); i_10++) 
                    e_l_9.ImpAppend(((Record) selRes_7).GetField(i_10));
                  if (succ_8 = 2 == (Int) (e_l_9.Length())) {
                    Generic permI_11;
                    permI_11 = (Generic) (e_l_9.Hd());
                    succ_8 = true;
                    {
                      vdm_FREE_pat__l = permI_11;
                      succ_8 = true;
                    }
                    permI_11 = (Generic) (e_l_9[2]);
                    if (succ_8) {
                      vdm_FREE_set__e = permI_11;
                      succ_8 = true;
                    }
                  }
                }
            }
            if (succ_8) {
              Sequence sq_12;
              sq_12 = vdm_FREE_pat__l;
              Record vdm_FREE_pat;
              bool succ_14;
              Generic tmpe_20;
              for (int i_19 = sq_12.First(tmpe_20); i_19; i_19 = sq_12.Next(tmpe_20)) {
                Record elem_13 = tmpe_20;
                {
                  succ_14 = true;
                  {
                    vdm_FREE_pat = elem_13;
                    succ_14 = true;
                  }
                  if (succ_14) {
                    Set rhs_15;
                    {
                      rhs_15 = vdm_FREE_newid__s;
                      rhs_15.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat));
                    }
                    vdm_FREE_newid__s = rhs_15;
                  }
                  else 
                    RunTime("Pattern did not match in sequence for loop");
                }
              }
              {
                Map vdm_FREE_tmp__m;
                vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_set__e, vdm_FREE_newid__s);
                {
                  Map rhs_25;
                  {
                    Map m1_32 = vdm_FREE_res__m;
                    Map m2_33 = vdm_FREE_tmp__m;
                    Set com_28 = m1_32.Dom();
                    com_28.ImpIntersect(m2_33.Dom());
                    int all_applies_29 = 1;
                    Generic d_30;
                    for (int bb_31 = com_28.First(d_30); bb_31 && all_applies_29; bb_31 = com_28.Next(d_30)) 
                      all_applies_29 *= m1_32[d_30] == m2_33[d_30];
                    if (all_applies_29) 
                      m1_32.ImpOverride(m2_33);
                    else 
                      RunTime("EvalMapMerge Duplicates not equal");
                    rhs_25 = m1_32;
                  }
                  vdm_FREE_res__m = rhs_25;
                  {
                    Set rhs_34;
                    {
                      rhs_34 = vdm_FREE_newid__s;
                      rhs_34.ImpUnion(vdm_FREE_tmp__m.Dom());
                    }
                    vdm_FREE_newid__s = rhs_34;
                  }
                }
              }
            }
          }
          if (!succ_8) {
            Sequence vdm_FREE_pat__l;
            {
              succ_8 = false;
              if (selRes_7.IsRecord()) 
                if (vdm_AS_MultTypeBind == ((Record) selRes_7).GetTag()) {
                  Sequence e_l_38;
                  for (int i_39 = 1; i_39 <= ((Record) selRes_7).Length(); i_39++) 
                    e_l_38.ImpAppend(((Record) selRes_7).GetField(i_39));
                  if (succ_8 = 2 == (Int) (e_l_38.Length())) {
                    Generic permI_40;
                    permI_40 = (Generic) (e_l_38.Hd());
                    succ_8 = true;
                    {
                      vdm_FREE_pat__l = permI_40;
                      succ_8 = true;
                    }
                    permI_40 = (Generic) (e_l_38[2]);
                    if (succ_8) 
                      succ_8 = true;
                  }
                }
            }
            if (succ_8) {
              Sequence sq_41;
              sq_41 = vdm_FREE_pat__l;
              Record vdm_FREE_pat;
              bool succ_43;
              Generic tmpe_49;
              for (int i_48 = sq_41.First(tmpe_49); i_48; i_48 = sq_41.Next(tmpe_49)) {
                Record elem_42 = tmpe_49;
                {
                  succ_43 = true;
                  {
                    vdm_FREE_pat = elem_42;
                    succ_43 = true;
                  }
                  if (succ_43) {
                    Set rhs_44;
                    {
                      rhs_44 = vdm_FREE_newid__s;
                      rhs_44.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat));
                    }
                    vdm_FREE_newid__s = rhs_44;
                  }
                  else 
                    RunTime("Pattern did not match in sequence for loop");
                }
              }
            }
          }
        }
        else 
          RunTime("Pattern did not match in sequence for loop");
      }
    }
  }
  {
    Map rexpr_52;
    rexpr_52 = vdm_FREE_res__m;
    return rexpr_52;
  }
}

Map vdm_FREE_FreeInName(Record vdm_FREE_name, Set vdm_FREE_id__s) {
  Bool cond_4;
{ cond_4 = (Bool) (vdm_FREE_id__s.InSet(vdm_FREE_name)); }
  if (cond_4.GetValue()) {
    Map rexpr_17;
    rexpr_17 = Map();
    return rexpr_17;
  }
  else {
    bool succ_7;
    Generic tmpVal_8;
    tmpVal_8 = vdm_FREE_LookUpInTopEnv(vdm_FREE_name);
    Generic vdm_FREE_val;
    succ_7 = true;
    {
      vdm_FREE_val = tmpVal_8;
      succ_7 = true;
    }
    if (!succ_7) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Bool cond_10;
      cond_10 = (Bool) (vdm_FREE_val == Nil());
      if (cond_10.GetValue()) {
        Map rexpr_16;
        rexpr_16 = Map();
        return rexpr_16;
      }
      else {
        Map rexpr_13;
        rexpr_13 = Map().Insert(vdm_FREE_name, vdm_FREE_val);
        return rexpr_13;
      }
    }
  }
}

Map vdm_FREE_FreeInOldName(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Sequence vdm_FREE_old__id;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_OldName == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_old__id = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record vdm_FREE_old__name(vdm_AS_Name, length_AS_Name);
    vdm_FREE_old__name = Record(vdm_AS_Name, length_AS_Name);
    vdm_FREE_old__name.SetField(1, vdm_FREE_old__id);
    vdm_FREE_old__name.SetField(2, Nil());
    {
      Bool cond_11;
{ cond_11 = (Bool) (vdm_FREE_id__s.InSet(vdm_FREE_old__name)); }
      if (cond_11.GetValue()) {
        Map rexpr_20;
        rexpr_20 = Map();
        return rexpr_20;
      }
      else {
        Bool cond_14;
        cond_14 = vdm_FREE_IsOldState(vdm_FREE_old__name);
        if (cond_14.GetValue()) {
          Map rexpr_16;
          rexpr_16 = Map().Insert(vdm_FREE_old__name, vdm_FREE_GetOldStateVal(vdm_FREE_old__name));
          return rexpr_16;
        }
        else { RunTime("Can not evaluate an error statement"); }
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInOldName");
}

Map vdm_FREE_FreeInPostExpr(Generic vdm_FREE_expr, Set vdm_FREE_id__s) {
  Bool cond_4;
  cond_4 = (Bool) (vdm_FREE_expr == Nil());
  if (cond_4.GetValue()) {
    Map rexpr_9;
    rexpr_9 = Map();
    return rexpr_9;
  }
  else {
    Generic tmpVar_7;
    tmpVar_7 = vdm_FREE_expr;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
}

Map vdm_FREE_FreeInPreExpr(Generic vdm_FREE_expr, Set vdm_FREE_id__s) {
  Bool cond_4;
  cond_4 = (Bool) (vdm_FREE_expr == Nil());
  if (cond_4.GetValue()) {
    Map rexpr_9;
    rexpr_9 = Map();
    return rexpr_9;
  }
  else {
    Generic tmpVar_7;
    tmpVar_7 = vdm_FREE_expr;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
}

Map vdm_FREE_FreeInPrefixExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_arg__e;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_PrefixExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          succ_3 = true;
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_arg__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_arg__e;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInPrefixExpr");
}

Map vdm_FREE_FreeInRecordConstructorExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_fields__le;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_RecordConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          succ_3 = true;
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_fields__le = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_fields__le;
      Record vdm_FREE_elm;
      bool succ_9;
      Generic tmpe_28;
      for (int i_27 = sq_7.First(tmpe_28); i_27; i_27 = sq_7.Next(tmpe_28)) {
        Record elem_8 = tmpe_28;
        {
          succ_9 = true;
          {
            vdm_FREE_elm = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elm, vdm_FREE_newid__s);
            {
              Map rhs_14;
              {
                Map m1_21 = vdm_FREE_res__m;
                Map m2_22 = vdm_FREE_tmp__m;
                Set com_17 = m1_21.Dom();
                com_17.ImpIntersect(m2_22.Dom());
                int all_applies_18 = 1;
                Generic d_19;
                for (int bb_20 = com_17.First(d_19); bb_20 && all_applies_18; bb_20 = com_17.Next(d_19)) 
                  all_applies_18 *= m1_21[d_19] == m2_22[d_19];
                if (all_applies_18) 
                  m1_21.ImpOverride(m2_22);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_14 = m1_21;
              }
              vdm_FREE_res__m = rhs_14;
              {
                Set rhs_23;
                {
                  rhs_23 = vdm_FREE_newid__s;
                  rhs_23.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_23;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_29;
      rexpr_29 = vdm_FREE_res__m;
      return rexpr_29;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInRecordConstructorExpr");
}

Map vdm_FREE_FreeInRecordModifierExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Sequence vdm_FREE_modifiers;
  Record vdm_FREE_rec__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_RecordModifierExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_rec__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_modifiers = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInExpr(vdm_FREE_rec__e, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        rhs_10 = vdm_FREE_id__s;
        rhs_10.ImpUnion(vdm_FREE_res__m.Dom());
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Sequence sq_14;
      sq_14 = vdm_FREE_modifiers;
      Record vdm_FREE_expr;
      bool succ_16;
      Generic tmpe_38;
      for (int i_37 = sq_14.First(tmpe_38); i_37; i_37 = sq_14.Next(tmpe_38)) {
        Record elem_15 = tmpe_38;
        {
          succ_16 = true;
          {
            succ_16 = false;
            if (elem_15.IsRecord()) 
              if (vdm_AS_RecordModification == elem_15.GetTag()) {
                Sequence e_l_34;
                for (int i_35 = 1; i_35 <= elem_15.Length(); i_35++) 
                  e_l_34.ImpAppend(elem_15.GetField(i_35));
                if (succ_16 = 2 == (Int) (e_l_34.Length())) {
                  Record permI_36;
                  permI_36 = (Record) (e_l_34.Hd());
                  succ_16 = true;
                  succ_16 = true;
                  permI_36 = (Record) (e_l_34[2]);
                  if (succ_16) {
                    vdm_FREE_expr = permI_36;
                    succ_16 = true;
                  }
                }
              }
          }
          if (succ_16) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_expr, vdm_FREE_newid__s);
            {
              Map rhs_21;
              {
                Map m1_28 = vdm_FREE_res__m;
                Map m2_29 = vdm_FREE_tmp__m;
                Set com_24 = m1_28.Dom();
                com_24.ImpIntersect(m2_29.Dom());
                int all_applies_25 = 1;
                Generic d_26;
                for (int bb_27 = com_24.First(d_26); bb_27 && all_applies_25; bb_27 = com_24.Next(d_26)) 
                  all_applies_25 *= m1_28[d_26] == m2_29[d_26];
                if (all_applies_25) 
                  m1_28.ImpOverride(m2_29);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_21 = m1_28;
              }
              vdm_FREE_res__m = rhs_21;
              {
                Set rhs_30;
                {
                  rhs_30 = vdm_FREE_newid__s;
                  rhs_30.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_30;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_39;
      rexpr_39 = vdm_FREE_res__m;
      return rexpr_39;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInRecordModifierExpr");
}

Map vdm_FREE_FreeInSeqComprehensionExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_bind(vdm_AS_SetBind, length_AS_SetBind);
  Record vdm_FREE_elem__e;
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 5 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_elem__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_bind = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[5]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInBind(vdm_FREE_bind, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        Set unArg_11;
        unArg_11 = Set().Insert(vdm_FREE_id__s);
        unArg_11.Insert(vdm_FREE_res__m.Dom());
        unArg_11.Insert(vdm_FREE_IdentInBind(vdm_FREE_bind));
        {
          Set rduset_17;
          Generic tmpe_20;
          for (int bb_19 = unArg_11.First(tmpe_20); bb_19; bb_19 = unArg_11.Next(tmpe_20)) {
            Set e_18 = tmpe_20;
            rduset_17.ImpUnion(e_18);
          }
          rhs_10 = rduset_17;
        }
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elem__e, vdm_FREE_newid__s);
      {
        Map rhs_25;
        {
          Map m1_32 = vdm_FREE_res__m;
          Map m2_33 = vdm_FREE_tmp__m;
          Set com_28 = m1_32.Dom();
          com_28.ImpIntersect(m2_33.Dom());
          int all_applies_29 = 1;
          Generic d_30;
          for (int bb_31 = com_28.First(d_30); bb_31 && all_applies_29; bb_31 = com_28.Next(d_30)) 
            all_applies_29 *= m1_32[d_30] == m2_33[d_30];
          if (all_applies_29) 
            m1_32.ImpOverride(m2_33);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_25 = m1_32;
        }
        vdm_FREE_res__m = rhs_25;
        {
          Set rhs_34;
          {
            rhs_34 = vdm_FREE_newid__s;
            rhs_34.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_34;
        }
      }
    }
    {
      Map rhs_38;
      {
        Map m1_47 = vdm_FREE_res__m;
        Map m2_48 = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        Set com_43 = m1_47.Dom();
        com_43.ImpIntersect(m2_48.Dom());
        int all_applies_44 = 1;
        Generic d_45;
        for (int bb_46 = com_43.First(d_45); bb_46 && all_applies_44; bb_46 = com_43.Next(d_45)) 
          all_applies_44 *= m1_47[d_45] == m2_48[d_45];
        if (all_applies_44) 
          m1_47.ImpOverride(m2_48);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_38 = m1_47;
      }
      vdm_FREE_res__m = rhs_38;
    }
    {
      Map rexpr_49;
      rexpr_49 = vdm_FREE_res__m;
      return rexpr_49;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSeqComprehensionExpr");
}

Map vdm_FREE_FreeInSeqEnumerationExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_els__l;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_els__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_els__l;
      Record vdm_FREE_elm;
      bool succ_9;
      Generic tmpe_28;
      for (int i_27 = sq_7.First(tmpe_28); i_27; i_27 = sq_7.Next(tmpe_28)) {
        Record elem_8 = tmpe_28;
        {
          succ_9 = true;
          {
            vdm_FREE_elm = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elm, vdm_FREE_newid__s);
            {
              Map rhs_14;
              {
                Map m1_21 = vdm_FREE_res__m;
                Map m2_22 = vdm_FREE_tmp__m;
                Set com_17 = m1_21.Dom();
                com_17.ImpIntersect(m2_22.Dom());
                int all_applies_18 = 1;
                Generic d_19;
                for (int bb_20 = com_17.First(d_19); bb_20 && all_applies_18; bb_20 = com_17.Next(d_19)) 
                  all_applies_18 *= m1_21[d_19] == m2_22[d_19];
                if (all_applies_18) 
                  m1_21.ImpOverride(m2_22);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_14 = m1_21;
              }
              vdm_FREE_res__m = rhs_14;
              {
                Set rhs_23;
                {
                  rhs_23 = vdm_FREE_newid__s;
                  rhs_23.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_23;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_29;
      rexpr_29 = vdm_FREE_res__m;
      return rexpr_29;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSeqEnumerationExpr");
}

Map vdm_FREE_FreeInSeqModifyMapOverrideExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_map__e;
  Record vdm_FREE_seqmap__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqModifyMapOverrideExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_seqmap__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_map__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_tmp__m;
    vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_seqmap__e, vdm_FREE_id__s);
    {
      Map vdm_FREE_res__m;
      Set tmpVar_14;
      {
        tmpVar_14 = vdm_FREE_id__s;
        tmpVar_14.ImpUnion(vdm_FREE_tmp__m.Dom());
      }
      vdm_FREE_res__m = vdm_FREE_FreeInExpr(vdm_FREE_map__e, tmpVar_14);
      {
        Map rexpr_18;
        {
          Map m1_25 = vdm_FREE_res__m;
          Map m2_26 = vdm_FREE_tmp__m;
          Set com_21 = m1_25.Dom();
          com_21.ImpIntersect(m2_26.Dom());
          int all_applies_22 = 1;
          Generic d_23;
          for (int bb_24 = com_21.First(d_23); bb_24 && all_applies_22; bb_24 = com_21.Next(d_23)) 
            all_applies_22 *= m1_25[d_23] == m2_26[d_23];
          if (all_applies_22) 
            m1_25.ImpOverride(m2_26);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rexpr_18 = m1_25;
        }
        return rexpr_18;
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSeqModifyMapOverrideExpr");
}

Map vdm_FREE_FreeInSetComprehensionExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_bind__l;
  Record vdm_FREE_elem__e;
  Set vdm_FREE_id__s;
  Record vdm_FREE_pred__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 5 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_elem__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_bind__l = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_pred__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
          permI_6 = (Generic) (e_l_4[5]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInMultBindSeq(vdm_FREE_bind__l, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        Set unArg_11;
        unArg_11 = Set().Insert(vdm_FREE_id__s);
        unArg_11.Insert(vdm_FREE_res__m.Dom());
        unArg_11.Insert(vdm_FREE_IdentInMultBindSeq(vdm_FREE_bind__l));
        {
          Set rduset_17;
          Generic tmpe_20;
          for (int bb_19 = unArg_11.First(tmpe_20); bb_19; bb_19 = unArg_11.Next(tmpe_20)) {
            Set e_18 = tmpe_20;
            rduset_17.ImpUnion(e_18);
          }
          rhs_10 = rduset_17;
        }
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elem__e, vdm_FREE_newid__s);
      {
        Map rhs_25;
        {
          Map m1_32 = vdm_FREE_res__m;
          Map m2_33 = vdm_FREE_tmp__m;
          Set com_28 = m1_32.Dom();
          com_28.ImpIntersect(m2_33.Dom());
          int all_applies_29 = 1;
          Generic d_30;
          for (int bb_31 = com_28.First(d_30); bb_31 && all_applies_29; bb_31 = com_28.Next(d_30)) 
            all_applies_29 *= m1_32[d_30] == m2_33[d_30];
          if (all_applies_29) 
            m1_32.ImpOverride(m2_33);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_25 = m1_32;
        }
        vdm_FREE_res__m = rhs_25;
        {
          Set rhs_34;
          {
            rhs_34 = vdm_FREE_newid__s;
            rhs_34.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_34;
        }
      }
    }
    {
      Map rhs_38;
      {
        Map m1_47 = vdm_FREE_res__m;
        Map m2_48 = vdm_FREE_FreeInExpr(vdm_FREE_pred__e, vdm_FREE_newid__s);
        Set com_43 = m1_47.Dom();
        com_43.ImpIntersect(m2_48.Dom());
        int all_applies_44 = 1;
        Generic d_45;
        for (int bb_46 = com_43.First(d_45); bb_46 && all_applies_44; bb_46 = com_43.Next(d_45)) 
          all_applies_44 *= m1_47[d_45] == m2_48[d_45];
        if (all_applies_44) 
          m1_47.ImpOverride(m2_48);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_38 = m1_47;
      }
      vdm_FREE_res__m = rhs_38;
    }
    {
      Map rexpr_49;
      rexpr_49 = vdm_FREE_res__m;
      return rexpr_49;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSetComprehensionExpr");
}

Map vdm_FREE_FreeInSetEnumerationExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_elm__le;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_elm__le = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_elm__le;
      Record vdm_FREE_elm__e;
      bool succ_9;
      Generic tmpe_28;
      for (int i_27 = sq_7.First(tmpe_28); i_27; i_27 = sq_7.Next(tmpe_28)) {
        Record elem_8 = tmpe_28;
        {
          succ_9 = true;
          {
            vdm_FREE_elm__e = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elm__e, vdm_FREE_newid__s);
            {
              Map rhs_14;
              {
                Map m1_21 = vdm_FREE_res__m;
                Map m2_22 = vdm_FREE_tmp__m;
                Set com_17 = m1_21.Dom();
                com_17.ImpIntersect(m2_22.Dom());
                int all_applies_18 = 1;
                Generic d_19;
                for (int bb_20 = com_17.First(d_19); bb_20 && all_applies_18; bb_20 = com_17.Next(d_19)) 
                  all_applies_18 *= m1_21[d_19] == m2_22[d_19];
                if (all_applies_18) 
                  m1_21.ImpOverride(m2_22);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_14 = m1_21;
              }
              vdm_FREE_res__m = rhs_14;
              {
                Set rhs_23;
                {
                  rhs_23 = vdm_FREE_newid__s;
                  rhs_23.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_23;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_29;
      rexpr_29 = vdm_FREE_res__m;
      return rexpr_29;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSetEnumerationExpr");
}

Map vdm_FREE_FreeInSetRangeExpr(Record var_1_1, Set var_2_2) {
  Set vdm_FREE_id__s;
  Record vdm_FREE_lb__e;
  Record vdm_FREE_ub__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetRangeExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_lb__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_ub__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    Set vdm_FREE_newid__s;
    {
      Map rhs_7;
      rhs_7 = vdm_FREE_FreeInExpr(vdm_FREE_lb__e, vdm_FREE_id__s);
      vdm_FREE_res__m = rhs_7;
    }
    {
      Set rhs_10;
      {
        rhs_10 = vdm_FREE_id__s;
        rhs_10.ImpUnion(vdm_FREE_res__m.Dom());
      }
      vdm_FREE_newid__s = rhs_10;
    }
    {
      Map rhs_14;
      {
        Map m1_23 = vdm_FREE_res__m;
        Map m2_24 = vdm_FREE_FreeInExpr(vdm_FREE_ub__e, vdm_FREE_newid__s);
        Set com_19 = m1_23.Dom();
        com_19.ImpIntersect(m2_24.Dom());
        int all_applies_20 = 1;
        Generic d_21;
        for (int bb_22 = com_19.First(d_21); bb_22 && all_applies_20; bb_22 = com_19.Next(d_21)) 
          all_applies_20 *= m1_23[d_21] == m2_24[d_21];
        if (all_applies_20) 
          m1_23.ImpOverride(m2_24);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_14 = m1_23;
      }
      vdm_FREE_res__m = rhs_14;
    }
    {
      Map rexpr_25;
      rexpr_25 = vdm_FREE_res__m;
      return rexpr_25;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSetRangeExpr");
}

Map vdm_FREE_FreeInSubSequenceExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_from__e;
  Set vdm_FREE_id__s;
  Record vdm_FREE_seq__e;
  Record vdm_FREE_to__e;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SubSequenceExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 4 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_seq__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            vdm_FREE_from__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) {
            vdm_FREE_to__e = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[4]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_seq__e, vdm_FREE_newid__s);
      {
        Map rhs_11;
        {
          Map m1_18 = vdm_FREE_res__m;
          Map m2_19 = vdm_FREE_tmp__m;
          Set com_14 = m1_18.Dom();
          com_14.ImpIntersect(m2_19.Dom());
          int all_applies_15 = 1;
          Generic d_16;
          for (int bb_17 = com_14.First(d_16); bb_17 && all_applies_15; bb_17 = com_14.Next(d_16)) 
            all_applies_15 *= m1_18[d_16] == m2_19[d_16];
          if (all_applies_15) 
            m1_18.ImpOverride(m2_19);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_11 = m1_18;
        }
        vdm_FREE_res__m = rhs_11;
        {
          Set rhs_20;
          {
            rhs_20 = vdm_FREE_newid__s;
            rhs_20.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_20;
        }
      }
    }
    {
      Map vdm_FREE_tmp__m;
      vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_from__e, vdm_FREE_newid__s);
      {
        Map rhs_28;
        {
          Map m1_35 = vdm_FREE_res__m;
          Map m2_36 = vdm_FREE_tmp__m;
          Set com_31 = m1_35.Dom();
          com_31.ImpIntersect(m2_36.Dom());
          int all_applies_32 = 1;
          Generic d_33;
          for (int bb_34 = com_31.First(d_33); bb_34 && all_applies_32; bb_34 = com_31.Next(d_33)) 
            all_applies_32 *= m1_35[d_33] == m2_36[d_33];
          if (all_applies_32) 
            m1_35.ImpOverride(m2_36);
          else 
            RunTime("EvalMapMerge Duplicates not equal");
          rhs_28 = m1_35;
        }
        vdm_FREE_res__m = rhs_28;
        {
          Set rhs_37;
          {
            rhs_37 = vdm_FREE_newid__s;
            rhs_37.ImpUnion(vdm_FREE_tmp__m.Dom());
          }
          vdm_FREE_newid__s = rhs_37;
        }
      }
    }
    {
      Map rhs_41;
      {
        Map m1_50 = vdm_FREE_res__m;
        Map m2_51 = vdm_FREE_FreeInExpr(vdm_FREE_to__e, vdm_FREE_newid__s);
        Set com_46 = m1_50.Dom();
        com_46.ImpIntersect(m2_51.Dom());
        int all_applies_47 = 1;
        Generic d_48;
        for (int bb_49 = com_46.First(d_48); bb_49 && all_applies_47; bb_49 = com_46.Next(d_48)) 
          all_applies_47 *= m1_50[d_48] == m2_51[d_48];
        if (all_applies_47) 
          m1_50.ImpOverride(m2_51);
        else 
          RunTime("EvalMapMerge Duplicates not equal");
        rhs_41 = m1_50;
      }
      vdm_FREE_res__m = rhs_41;
    }
    {
      Map rexpr_52;
      rexpr_52 = vdm_FREE_res__m;
      return rexpr_52;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInSubSequenceExpr");
}

Map vdm_FREE_FreeInTokenConstructorExpr(Record var_1_1, Set var_2_2) {
  Record vdm_FREE_expr;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_TokenConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_expr = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record tmpVar_7;
    tmpVar_7 = vdm_FREE_expr;
    Set tmpVar_8;
    tmpVar_8 = vdm_FREE_id__s;
    return vdm_FREE_FreeInExpr(tmpVar_7, tmpVar_8);
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInTokenConstructorExpr");
}

Map vdm_FREE_FreeInTupleConstructorExpr(Record var_1_1, Set var_2_2) {
  Sequence vdm_FREE_fields__le;
  Set vdm_FREE_id__s;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_TupleConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_FREE_fields__le = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_FREE_id__s = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_FREE_res__m;
    vdm_FREE_res__m = Map();
    Set vdm_FREE_newid__s;
    vdm_FREE_newid__s = vdm_FREE_id__s;
    {
      Sequence sq_7;
      sq_7 = vdm_FREE_fields__le;
      Record vdm_FREE_elm;
      bool succ_9;
      Generic tmpe_28;
      for (int i_27 = sq_7.First(tmpe_28); i_27; i_27 = sq_7.Next(tmpe_28)) {
        Record elem_8 = tmpe_28;
        {
          succ_9 = true;
          {
            vdm_FREE_elm = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            Map vdm_FREE_tmp__m;
            vdm_FREE_tmp__m = vdm_FREE_FreeInExpr(vdm_FREE_elm, vdm_FREE_newid__s);
            {
              Map rhs_14;
              {
                Map m1_21 = vdm_FREE_res__m;
                Map m2_22 = vdm_FREE_tmp__m;
                Set com_17 = m1_21.Dom();
                com_17.ImpIntersect(m2_22.Dom());
                int all_applies_18 = 1;
                Generic d_19;
                for (int bb_20 = com_17.First(d_19); bb_20 && all_applies_18; bb_20 = com_17.Next(d_19)) 
                  all_applies_18 *= m1_21[d_19] == m2_22[d_19];
                if (all_applies_18) 
                  m1_21.ImpOverride(m2_22);
                else 
                  RunTime("EvalMapMerge Duplicates not equal");
                rhs_14 = m1_21;
              }
              vdm_FREE_res__m = rhs_14;
              {
                Set rhs_23;
                {
                  rhs_23 = vdm_FREE_newid__s;
                  rhs_23.ImpUnion(vdm_FREE_tmp__m.Dom());
                }
                vdm_FREE_newid__s = rhs_23;
              }
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Map rexpr_29;
      rexpr_29 = vdm_FREE_res__m;
      return rexpr_29;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: FreeInTupleConstructorExpr");
}

Record vdm_FREE_FreeMapToBlkEnv(Map vdm_FREE_id__m) {
  Record vdm_FREE_env(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
  vdm_FREE_env = vdm_FREE_MkEmptyBlkEnv((Quote) "READ_ONLY");
  {
    Set iset_4;
    iset_4 = vdm_FREE_id__m.Dom();
    Record vdm_FREE_id(vdm_AS_Name, length_AS_Name);
    bool succ_6;
    Generic tmpe_18;
    for (int bb_17 = iset_4.First(tmpe_18); bb_17; bb_17 = iset_4.Next(tmpe_18)) {
      Record elem_5 = tmpe_18;
      {
        succ_6 = true;
        {
          vdm_FREE_id = elem_5;
          succ_6 = true;
        }
        if (succ_6) {
          Record rhs_8(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
          {
            Record tmpVar_10(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
            {
              Record tmpVar_12;
              {
                Map tmp_m_13;
                tmp_m_13 = vdm_FREE_id__m;
                tmpVar_12 = (Record) (((Map) tmp_m_13)[vdm_FREE_id]);
              }
              tmpVar_10 = vdm_FREE_MkBlkEnv(vdm_FREE_id, tmpVar_12, Nil(), (Quote) "READ_ONLY");
            }
            rhs_8 = vdm_FREE_CombineBlkEnv(vdm_FREE_env, tmpVar_10);
          }
          vdm_FREE_env = rhs_8;
        }
        else 
          RunTime("Pattern did not match in set for loop");
      }
    }
  }
  {
    Record rexpr_19(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
    rexpr_19 = vdm_FREE_env;
    return rexpr_19;
  }
}

Set vdm_FREE_IdentInBind(Record vdm_FREE_bind) {
  Record tmpVar_3;
  {
    Record tmpRec_4;
    tmpRec_4 = vdm_FREE_bind;
    if (((Record) tmpRec_4).Is(vdm_AS_TypeBind)) 
      tmpVar_3 = ((Record) tmpRec_4).GetField(pos_AS_TypeBind_pat);
    else 
      if (((Record) tmpRec_4).Is(vdm_AS_SetBind)) 
        tmpVar_3 = ((Record) tmpRec_4).GetField(pos_AS_SetBind_pat);
      else 
        RunTime("Unknown record field selector");
  }
  return vdm_FREE_IdentInPattern(tmpVar_3);
}

Set vdm_FREE_IdentInMultBindSeq(Sequence vdm_FREE_bind__l) {
  Set vdm_FREE_id__s;
  vdm_FREE_id__s = Set();
  {
    Sequence sq_3;
    sq_3 = vdm_FREE_bind__l;
    Record vdm_FREE_bind;
    bool succ_5;
    Generic tmpe_17;
    for (int i_16 = sq_3.First(tmpe_17); i_16; i_16 = sq_3.Next(tmpe_17)) {
      Record elem_4 = tmpe_17;
      {
        succ_5 = true;
        {
          vdm_FREE_bind = elem_4;
          succ_5 = true;
        }
        if (succ_5) {
          Sequence sq_6;
          {
            Record tmpRec_9;
            tmpRec_9 = vdm_FREE_bind;
            if (((Record) tmpRec_9).Is(vdm_AS_MultTypeBind)) 
              sq_6 = ((Record) tmpRec_9).GetField(pos_AS_MultTypeBind_pat);
            else 
              if (((Record) tmpRec_9).Is(vdm_AS_MultSetBind)) 
                sq_6 = ((Record) tmpRec_9).GetField(pos_AS_MultSetBind_pat);
              else 
                RunTime("Unknown record field selector");
          }
          Record vdm_FREE_pat__p;
          bool succ_8;
          Generic tmpe_15;
          for (int i_14 = sq_6.First(tmpe_15); i_14; i_14 = sq_6.Next(tmpe_15)) {
            Record elem_7 = tmpe_15;
            {
              succ_8 = true;
              {
                vdm_FREE_pat__p = elem_7;
                succ_8 = true;
              }
              if (succ_8) {
                Set rhs_10;
                {
                  rhs_10 = vdm_FREE_id__s;
                  rhs_10.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_pat__p));
                }
                vdm_FREE_id__s = rhs_10;
              }
              else 
                RunTime("Pattern did not match in sequence for loop");
            }
          }
        }
        else 
          RunTime("Pattern did not match in sequence for loop");
      }
    }
  }
  {
    Set rexpr_18;
    rexpr_18 = vdm_FREE_id__s;
    return rexpr_18;
  }
}

Set vdm_FREE_IdentInPattern(Record vdm_FREE_pat) {
  Record selRes_3;
  selRes_3 = vdm_FREE_pat;
  bool succ_4 = true;
  {
    Generic vdm_FREE_id;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_PatternName == ((Record) selRes_3).GetTag()) {
          Sequence e_l_5;
          for (int i_6 = 1; i_6 <= ((Record) selRes_3).Length(); i_6++) 
            e_l_5.ImpAppend(((Record) selRes_3).GetField(i_6));
          if (succ_4 = 2 == (Int) (e_l_5.Length())) {
            Generic permI_7;
            permI_7 = (Generic) (e_l_5.Hd());
            succ_4 = true;
            {
              vdm_FREE_id = permI_7;
              succ_4 = true;
            }
            permI_7 = (Generic) (e_l_5[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Set rexpr_8;
{ if (((Bool) (vdm_FREE_id == Nil())).GetValue()) 
   rexpr_8 = Set();
 else { rexpr_8 = Set().Insert(vdm_FREE_id); } }
      return rexpr_8;
    }
  }
  if (!succ_4) {
    Record vdm_FREE_val;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_MatchVal == ((Record) selRes_3).GetTag()) {
          Sequence e_l_13;
          for (int i_14 = 1; i_14 <= ((Record) selRes_3).Length(); i_14++) 
            e_l_13.ImpAppend(((Record) selRes_3).GetField(i_14));
          if (succ_4 = 1 == (Int) (e_l_13.Length())) {
            Record permI_15;
            permI_15 = (Record) (e_l_13.Hd());
            succ_4 = true;
            {
              vdm_FREE_val = permI_15;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Set rexpr_16;
      rexpr_16 = Set();
      return rexpr_16;
    }
  }
  if (!succ_4) {
    Sequence vdm_FREE_Elems;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_17;
          for (int i_18 = 1; i_18 <= ((Record) selRes_3).Length(); i_18++) 
            e_l_17.ImpAppend(((Record) selRes_3).GetField(i_18));
          if (succ_4 = 2 == (Int) (e_l_17.Length())) {
            Generic permI_19;
            permI_19 = (Generic) (e_l_17.Hd());
            succ_4 = true;
            {
              vdm_FREE_Elems = permI_19;
              succ_4 = true;
            }
            permI_19 = (Generic) (e_l_17[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Set rexpr_20;
      {
        Set unArg_21;
        Set res_s_22;
        {
          Sequence seq_lv_29;
          bool succ_27;
          Bool tsucc_30;
          tsucc_30 = true;
          {
            Set tmpVar_v_28;
            {
              Set riseq_33;
              int max_34 = (Int) (vdm_FREE_Elems.Length());
              for (int i_35 = 1; i_35 <= max_34; i_35++) 
                riseq_33.Insert((Int) i_35);
              tmpVar_v_28 = riseq_33;
            }
{ seq_lv_29.ImpAppend(tmpVar_v_28); }
          }
          Set allComb_31 = GenAllComb(seq_lv_29);
          Int vdm_FREE_p;
          Generic tmpe_44;
          for (int bb_43 = allComb_31.First(tmpe_44); bb_43; bb_43 = allComb_31.Next(tmpe_44)) {
            Sequence tmp_41 = tmpe_44;
            {
              if (succ_27 = 1 == (Int) (tmp_41.Length())) {
                Int permI_42;
                permI_42 = (Int) (tmp_41.Hd());
                succ_27 = true;
                {
                  vdm_FREE_p = permI_42;
                  succ_27 = true;
                }
              }
              if (succ_27) {
                Set elem_23;
                {
                  Record tmpVar_24;
                  {
                    Sequence tmpseq_25;
                    tmpseq_25 = vdm_FREE_Elems;
                    tmpVar_24 = (Record) (tmpseq_25[vdm_FREE_p.GetValue()]);
                  }
                  elem_23 = vdm_FREE_IdentInPattern(tmpVar_24);
                }
                res_s_22.Insert(elem_23);
              }
            }
          }
        }
        unArg_21 = res_s_22;
        {
          Set rduset_45;
          Generic tmpe_48;
          for (int bb_47 = unArg_21.First(tmpe_48); bb_47; bb_47 = unArg_21.Next(tmpe_48)) {
            Set e_46 = tmpe_48;
            rduset_45.ImpUnion(e_46);
          }
          rexpr_20 = rduset_45;
        }
      }
      return rexpr_20;
    }
  }
  if (!succ_4) {
    Record vdm_FREE_lp;
    Record vdm_FREE_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetUnionPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_49;
          for (int i_50 = 1; i_50 <= ((Record) selRes_3).Length(); i_50++) 
            e_l_49.ImpAppend(((Record) selRes_3).GetField(i_50));
          if (succ_4 = 2 == (Int) (e_l_49.Length())) {
            Record permI_51;
            permI_51 = (Record) (e_l_49.Hd());
            succ_4 = true;
            {
              vdm_FREE_lp = permI_51;
              succ_4 = true;
            }
            permI_51 = (Record) (e_l_49[2]);
            if (succ_4) {
              vdm_FREE_rp = permI_51;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Set rexpr_52;
      {
        rexpr_52 = vdm_FREE_IdentInPattern(vdm_FREE_lp);
        rexpr_52.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_rp));
      }
      return rexpr_52;
    }
  }
  if (!succ_4) {
    Sequence vdm_FREE_els;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_57;
          for (int i_58 = 1; i_58 <= ((Record) selRes_3).Length(); i_58++) 
            e_l_57.ImpAppend(((Record) selRes_3).GetField(i_58));
          if (succ_4 = 2 == (Int) (e_l_57.Length())) {
            Generic permI_59;
            permI_59 = (Generic) (e_l_57.Hd());
            succ_4 = true;
            {
              vdm_FREE_els = permI_59;
              succ_4 = true;
            }
            permI_59 = (Generic) (e_l_57[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Set rexpr_60;
      {
        Set unArg_61;
        Set res_s_62;
        {
          Sequence seq_lv_69;
          bool succ_67;
          Bool tsucc_70;
          tsucc_70 = true;
          {
            Set tmpVar_v_68;
            {
              Set riseq_73;
              int max_74 = (Int) (vdm_FREE_els.Length());
              for (int i_75 = 1; i_75 <= max_74; i_75++) 
                riseq_73.Insert((Int) i_75);
              tmpVar_v_68 = riseq_73;
            }
{ seq_lv_69.ImpAppend(tmpVar_v_68); }
          }
          Set allComb_71 = GenAllComb(seq_lv_69);
          Int vdm_FREE_i;
          Generic tmpe_84;
          for (int bb_83 = allComb_71.First(tmpe_84); bb_83; bb_83 = allComb_71.Next(tmpe_84)) {
            Sequence tmp_81 = tmpe_84;
            {
              if (succ_67 = 1 == (Int) (tmp_81.Length())) {
                Int permI_82;
                permI_82 = (Int) (tmp_81.Hd());
                succ_67 = true;
                {
                  vdm_FREE_i = permI_82;
                  succ_67 = true;
                }
              }
              if (succ_67) {
                Set elem_63;
                {
                  Record tmpVar_64;
                  {
                    Sequence tmpseq_65;
                    tmpseq_65 = vdm_FREE_els;
                    tmpVar_64 = (Record) (tmpseq_65[vdm_FREE_i.GetValue()]);
                  }
                  elem_63 = vdm_FREE_IdentInPattern(tmpVar_64);
                }
                res_s_62.Insert(elem_63);
              }
            }
          }
        }
        unArg_61 = res_s_62;
        {
          Set rduset_85;
          Generic tmpe_88;
          for (int bb_87 = unArg_61.First(tmpe_88); bb_87; bb_87 = unArg_61.Next(tmpe_88)) {
            Set e_86 = tmpe_88;
            rduset_85.ImpUnion(e_86);
          }
          rexpr_60 = rduset_85;
        }
      }
      return rexpr_60;
    }
  }
  if (!succ_4) {
    Record vdm_FREE_lp;
    Record vdm_FREE_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqConcPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_89;
          for (int i_90 = 1; i_90 <= ((Record) selRes_3).Length(); i_90++) 
            e_l_89.ImpAppend(((Record) selRes_3).GetField(i_90));
          if (succ_4 = 2 == (Int) (e_l_89.Length())) {
            Record permI_91;
            permI_91 = (Record) (e_l_89.Hd());
            succ_4 = true;
            {
              vdm_FREE_lp = permI_91;
              succ_4 = true;
            }
            permI_91 = (Record) (e_l_89[2]);
            if (succ_4) {
              vdm_FREE_rp = permI_91;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Set rexpr_92;
      {
        rexpr_92 = vdm_FREE_IdentInPattern(vdm_FREE_lp);
        rexpr_92.ImpUnion(vdm_FREE_IdentInPattern(vdm_FREE_rp));
      }
      return rexpr_92;
    }
  }
  if (!succ_4) {
    Sequence vdm_FREE_fields;
    Record vdm_FREE_tag(vdm_AS_Name, length_AS_Name);
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_RecordPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_97;
          for (int i_98 = 1; i_98 <= ((Record) selRes_3).Length(); i_98++) 
            e_l_97.ImpAppend(((Record) selRes_3).GetField(i_98));
          if (succ_4 = 3 == (Int) (e_l_97.Length())) {
            Generic permI_99;
            permI_99 = (Generic) (e_l_97.Hd());
            succ_4 = true;
            {
              vdm_FREE_tag = permI_99;
              succ_4 = true;
            }
            permI_99 = (Generic) (e_l_97[2]);
            if (succ_4) {
              vdm_FREE_fields = permI_99;
              succ_4 = true;
            }
            permI_99 = (Generic) (e_l_97[3]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Set rexpr_100;
      {
        Set unArg_101;
        Set res_s_102;
        {
          Sequence seq_lv_109;
          bool succ_107;
          Bool tsucc_110;
          tsucc_110 = true;
          {
            Set tmpVar_v_108;
            {
              Set riseq_113;
              int max_114 = (Int) (vdm_FREE_fields.Length());
              for (int i_115 = 1; i_115 <= max_114; i_115++) 
                riseq_113.Insert((Int) i_115);
              tmpVar_v_108 = riseq_113;
            }
{ seq_lv_109.ImpAppend(tmpVar_v_108); }
          }
          Set allComb_111 = GenAllComb(seq_lv_109);
          Int vdm_FREE_i;
          Generic tmpe_124;
          for (int bb_123 = allComb_111.First(tmpe_124); bb_123; bb_123 = allComb_111.Next(tmpe_124)) {
            Sequence tmp_121 = tmpe_124;
            {
              if (succ_107 = 1 == (Int) (tmp_121.Length())) {
                Int permI_122;
                permI_122 = (Int) (tmp_121.Hd());
                succ_107 = true;
                {
                  vdm_FREE_i = permI_122;
                  succ_107 = true;
                }
              }
              if (succ_107) {
                Set elem_103;
                {
                  Record tmpVar_104;
                  {
                    Sequence tmpseq_105;
                    tmpseq_105 = vdm_FREE_fields;
                    tmpVar_104 = (Record) (tmpseq_105[vdm_FREE_i.GetValue()]);
                  }
                  elem_103 = vdm_FREE_IdentInPattern(tmpVar_104);
                }
                res_s_102.Insert(elem_103);
              }
            }
          }
        }
        unArg_101 = res_s_102;
        {
          Set rduset_125;
          Generic tmpe_128;
          for (int bb_127 = unArg_101.First(tmpe_128); bb_127; bb_127 = unArg_101.Next(tmpe_128)) {
            Set e_126 = tmpe_128;
            rduset_125.ImpUnion(e_126);
          }
          rexpr_100 = rduset_125;
        }
      }
      return rexpr_100;
    }
  }
  if (!succ_4) {
    Sequence vdm_FREE_fields;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_TuplePattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_129;
          for (int i_130 = 1; i_130 <= ((Record) selRes_3).Length(); i_130++) 
            e_l_129.ImpAppend(((Record) selRes_3).GetField(i_130));
          if (succ_4 = 2 == (Int) (e_l_129.Length())) {
            Generic permI_131;
            permI_131 = (Generic) (e_l_129.Hd());
            succ_4 = true;
            {
              vdm_FREE_fields = permI_131;
              succ_4 = true;
            }
            permI_131 = (Generic) (e_l_129[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Set rexpr_132;
      {
        Set unArg_133;
        Set res_s_134;
        {
          Sequence seq_lv_141;
          bool succ_139;
          Bool tsucc_142;
          tsucc_142 = true;
          {
            Set tmpVar_v_140;
            {
              Set riseq_145;
              int max_146 = (Int) (vdm_FREE_fields.Length());
              for (int i_147 = 1; i_147 <= max_146; i_147++) 
                riseq_145.Insert((Int) i_147);
              tmpVar_v_140 = riseq_145;
            }
{ seq_lv_141.ImpAppend(tmpVar_v_140); }
          }
          Set allComb_143 = GenAllComb(seq_lv_141);
          Int vdm_FREE_i;
          Generic tmpe_156;
          for (int bb_155 = allComb_143.First(tmpe_156); bb_155; bb_155 = allComb_143.Next(tmpe_156)) {
            Sequence tmp_153 = tmpe_156;
            {
              if (succ_139 = 1 == (Int) (tmp_153.Length())) {
                Int permI_154;
                permI_154 = (Int) (tmp_153.Hd());
                succ_139 = true;
                {
                  vdm_FREE_i = permI_154;
                  succ_139 = true;
                }
              }
              if (succ_139) {
                Set elem_135;
                {
                  Record tmpVar_136;
                  {
                    Sequence tmpseq_137;
                    tmpseq_137 = vdm_FREE_fields;
                    tmpVar_136 = (Record) (tmpseq_137[vdm_FREE_i.GetValue()]);
                  }
                  elem_135 = vdm_FREE_IdentInPattern(tmpVar_136);
                }
                res_s_134.Insert(elem_135);
              }
            }
          }
        }
        unArg_133 = res_s_134;
        {
          Set rduset_157;
          Generic tmpe_160;
          for (int bb_159 = unArg_133.First(tmpe_160); bb_159; bb_159 = unArg_133.Next(tmpe_160)) {
            Set e_158 = tmpe_160;
            rduset_157.ImpUnion(e_158);
          }
          rexpr_132 = rduset_157;
        }
      }
      return rexpr_132;
    }
  }
  if (!succ_4) {
    Record vdm_FREE_pat;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetBind == ((Record) selRes_3).GetTag()) {
          Sequence e_l_161;
          for (int i_162 = 1; i_162 <= ((Record) selRes_3).Length(); i_162++) 
            e_l_161.ImpAppend(((Record) selRes_3).GetField(i_162));
          if (succ_4 = 2 == (Int) (e_l_161.Length())) {
            Record permI_163;
            permI_163 = (Record) (e_l_161.Hd());
            succ_4 = true;
            {
              vdm_FREE_pat = permI_163;
              succ_4 = true;
            }
            permI_163 = (Record) (e_l_161[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Record tmpVar_164;
      tmpVar_164 = vdm_FREE_pat;
      return vdm_FREE_IdentInPattern(tmpVar_164);
    }
  }
  if (!succ_4) {
    Record vdm_FREE_pat;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_TypeBind == ((Record) selRes_3).GetTag()) {
          Sequence e_l_165;
          for (int i_166 = 1; i_166 <= ((Record) selRes_3).Length(); i_166++) 
            e_l_165.ImpAppend(((Record) selRes_3).GetField(i_166));
          if (succ_4 = 2 == (Int) (e_l_165.Length())) {
            Record permI_167;
            permI_167 = (Record) (e_l_165.Hd());
            succ_4 = true;
            {
              vdm_FREE_pat = permI_167;
              succ_4 = true;
            }
            permI_167 = (Record) (e_l_165[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Record tmpVar_168;
      tmpVar_168 = vdm_FREE_pat;
      return vdm_FREE_IdentInPattern(tmpVar_168);
    }
  }
  if (!succ_4) 
    RunTime("Can not evaluate an error statement");
}

Generic vdm_FREE_LookUpInTopEnv(Record vdm_FREE_name) {
  bool succ_3;
  Record tmpVal_4(vdm_AS_Name, length_AS_Name);
  tmpVal_4 = vdm_FREE_LookUpRename(vdm_FREE_name);
  Record vdm_FREE_new__name(vdm_AS_Name, length_AS_Name);
  succ_3 = true;
  {
    vdm_FREE_new__name = tmpVal_4;
    succ_3 = true;
  }
  if (!succ_3) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Bool cond_6;
    cond_6 = vdm_FREE_IsLocalVal(vdm_FREE_new__name);
    if (cond_6.GetValue()) {
      Record tmpVar_9(vdm_AS_Name, length_AS_Name);
      tmpVar_9 = vdm_FREE_new__name;
      return vdm_FREE_GetLocalVal(tmpVar_9);
    }
    else {
      Generic rexpr_8;
      rexpr_8 = Nil();
      return rexpr_8;
    }
  }
}
