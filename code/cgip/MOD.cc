//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at Fri 10-Jan-97 by the VDM-SLtoC++ Code Generator
// (vdmde - v3.0l - Fri 10-Jan-97)
//
// Supported compiler: g++ version 2.7.2
//



#include "MOD.h"

#define vdm_MOD_EqualNames vdm_AUX_EqualNames
#define vdm_MOD_IsRealName vdm_AUX_IsRealName
#define vdm_MOD_IsTypeDef vdm_AUX_IsTypeDef
#define vdm_MOD_StateInvariant vdm_DEF_StateInvariant
#define vdm_MOD_TransFN vdm_DEF_TransFN
#define vdm_MOD_TransTP vdm_DEF_TransTP
#define vdm_MOD_TranslateDefinitions vdm_DEF_TranslateDefinitions
#define vdm_MOD_TranslateImplExportSig vdm_DEF_TranslateImplExportSig
#define vdm_MOD_EvalExpr vdm_EXPR_EvalExpr
#define vdm_MOD_PatternMatch vdm_PAT_PatternMatch
#define vdm_MOD_DTC vdm_SETTINGS_DTC
#define vdm_MOD_CurrentModule vdm_STATE_CurrentModule
#define vdm_MOD_GetModule vdm_STATE_GetModule
#define vdm_MOD_InstantiateModule vdm_STATE_InstantiateModule
#define vdm_MOD_InstantiateModules vdm_STATE_InstantiateModules
#define vdm_MOD_PopBlkEnv vdm_STATE_PopBlkEnv
#define vdm_MOD_PushBlkEnv vdm_STATE_PushBlkEnv
#define vdm_MOD_SubType vdm_STATE_SubType
#define vdm_MOD_UpdateRenameAndImport vdm_STATE_UpdateRenameAndImport

static Generic vdm_MOD_BuildExportSig(Generic, Record, Map);
static Map vdm_MOD_GetPrePostFns(Record, Map, Map);
static Map vdm_MOD_GetPrePostOps(Record, Map);
static Map vdm_MOD_GetTpInvariant(Record, Map);
static Bool vdm_MOD_HasFnPrePostCond(Record, Map, Map);
static Bool vdm_MOD_HasOpPrePostCond(Record, Map);
static Bool vdm_MOD_HasTpInvariant(Record, Map);
static Bool vdm_MOD_IsAllPatternName(Record);
static Map vdm_MOD_MakeRenamings(Record, Map);
static Map vdm_MOD_UpdateBasicType(Record, Record);
static Record vdm_MOD_UpdateFnAndOps(Record, Record);
static Map vdm_MOD_UpdateImport(Map, Record, Set);
static Map vdm_MOD_UpdateTypeName(Record, Record, Record);
static Sequence vdm_MOD_UpdateValues(Record, Record);

void init_MOD() {}

Generic vdm_MOD_BuildExportSig(Generic vdm_MOD_exp__sig, Record vdm_MOD_defs, Map vdm_MOD_ren) {
  Bool cond_5;
  cond_5 = (Bool) (vdm_MOD_exp__sig == Nil());
  if (cond_5.GetValue()) {
    Generic rexpr_136;
    rexpr_136 = vdm_MOD_exp__sig;
    return rexpr_136;
  }
  else {
    Record vdm_MOD_new__sig(vdm_AS_ExportSig, length_AS_ExportSig);
    vdm_MOD_new__sig = vdm_MOD_exp__sig;
    {
      Set iset_8;
      {
        Map unArg_11;
        Record tmpRec_12(vdm_AS_ExportSig, length_AS_ExportSig);
        tmpRec_12 = vdm_MOD_new__sig;
        if (tmpRec_12.Is(vdm_AS_ExportSig)) 
          unArg_11 = tmpRec_12.GetField(pos_AS_ExportSig_fns);
        else 
          RunTime("Unknown record field selector");
        iset_8 = unArg_11.Dom();
      }
      Record vdm_MOD_name(vdm_AS_Name, length_AS_Name);
      bool succ_10;
      Generic tmpe_51;
      for (int bb_50 = iset_8.First(tmpe_51); bb_50; bb_50 = iset_8.Next(tmpe_51)) {
        Record elem_9 = tmpe_51;
        {
          succ_10 = true;
          {
            vdm_MOD_name = elem_9;
            succ_10 = true;
          }
          if (succ_10) {
            bool succ_13;
            Record tmpVal_14(vdm_AS_Name, length_AS_Name);
            {
              Bool cond_15;
{ cond_15 = (Bool) (vdm_MOD_ren.Dom().InSet(vdm_MOD_name)); }
              if (cond_15.GetValue()) {
                Map tmp_m_19;
                tmp_m_19 = vdm_MOD_ren;
                tmpVal_14 = (Record) (((Map) tmp_m_19)[vdm_MOD_name]);
              }
              else { tmpVal_14 = vdm_MOD_name; }
            }
            Record vdm_MOD_new__name(vdm_AS_Name, length_AS_Name);
            succ_13 = true;
            {
              vdm_MOD_new__name = tmpVal_14;
              succ_13 = true;
            }
            if (!succ_13) 
              RunTime("Pattern match did not succeed in value definition");
            {
              Bool cond_21;
              {
                Map tmpVar_23;
                {
                  Record tmpRec_24(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                  tmpRec_24 = vdm_MOD_defs;
                  if (tmpRec_24.Is(vdm_GLOBAL_SigmaDEFS)) 
                    tmpVar_23 = tmpRec_24.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                  else 
                    RunTime("Unknown record field selector");
                }
                Map tmpVar_25;
                {
                  Record tmpRec_26(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                  tmpRec_26 = vdm_MOD_defs;
                  if (tmpRec_26.Is(vdm_GLOBAL_SigmaDEFS)) 
                    tmpVar_25 = tmpRec_26.GetField(pos_GLOBAL_SigmaDEFS_explpolys);
                  else 
                    RunTime("Unknown record field selector");
                }
                cond_21 = vdm_MOD_HasFnPrePostCond(vdm_MOD_new__name, tmpVar_23, tmpVar_25);
              }
              if (cond_21.GetValue()) {
                Map rhs_27;
                {
                  Map seqmap_28;
                  {
                    Record tmpRec_31(vdm_AS_ExportSig, length_AS_ExportSig);
                    tmpRec_31 = vdm_MOD_new__sig;
                    if (tmpRec_31.Is(vdm_AS_ExportSig)) 
                      seqmap_28 = tmpRec_31.GetField(pos_AS_ExportSig_fns);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Map modmap_29;
                  {
                    Map tmpVar_33;
                    {
                      Record tmpRec_34(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                      tmpRec_34 = vdm_MOD_defs;
                      if (tmpRec_34.Is(vdm_GLOBAL_SigmaDEFS)) 
                        tmpVar_33 = tmpRec_34.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    Map tmpVar_35;
                    {
                      Record tmpRec_36(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                      tmpRec_36 = vdm_MOD_defs;
                      if (tmpRec_36.Is(vdm_GLOBAL_SigmaDEFS)) 
                        tmpVar_35 = tmpRec_36.GetField(pos_GLOBAL_SigmaDEFS_explpolys);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    modmap_29 = vdm_MOD_GetPrePostFns(vdm_MOD_new__name, tmpVar_33, tmpVar_35);
                  }
                  seqmap_28.ImpOverride(modmap_29);
                  rhs_27 = seqmap_28;
                }
                Record mu_rhs_37(vdm_AS_ExportSig, length_AS_ExportSig);                {
                  Record tmpRE_38(vdm_AS_ExportSig, length_AS_ExportSig);
                  tmpRE_38 = vdm_MOD_new__sig;
                  int mu_39;
                  mu_39 = pos_AS_ExportSig_fns;
                  Map val_40;
                  {
                    Map seqmap_41;
                    {
                      Record tmpRec_44(vdm_AS_ExportSig, length_AS_ExportSig);
                      tmpRec_44 = vdm_MOD_new__sig;
                      if (tmpRec_44.Is(vdm_AS_ExportSig)) 
                        seqmap_41 = tmpRec_44.GetField(pos_AS_ExportSig_fns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    Map modmap_42;
                    {
                      Map tmpVar_46;
                      {
                        Record tmpRec_47(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                        tmpRec_47 = vdm_MOD_defs;
                        if (tmpRec_47.Is(vdm_GLOBAL_SigmaDEFS)) 
                          tmpVar_46 = tmpRec_47.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                        else 
                          RunTime("Unknown record field selector");
                      }
                      Map tmpVar_48;
                      {
                        Record tmpRec_49(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                        tmpRec_49 = vdm_MOD_defs;
                        if (tmpRec_49.Is(vdm_GLOBAL_SigmaDEFS)) 
                          tmpVar_48 = tmpRec_49.GetField(pos_GLOBAL_SigmaDEFS_explpolys);
                        else 
                          RunTime("Unknown record field selector");
                      }
                      modmap_42 = vdm_MOD_GetPrePostFns(vdm_MOD_new__name, tmpVar_46, tmpVar_48);
                    }
                    seqmap_41.ImpOverride(modmap_42);
                    val_40 = seqmap_41;
                  }
                  tmpRE_38.SetField(mu_39, val_40);
                  mu_rhs_37 = tmpRE_38;
                }                vdm_MOD_new__sig = mu_rhs_37;
              }
            }
          }
          else 
            RunTime("Pattern did not match in set for loop");
        }
      }
    }
    {
      Set iset_52;
      {
        Map unArg_55;
        Record tmpRec_56(vdm_AS_ExportSig, length_AS_ExportSig);
        tmpRec_56 = vdm_MOD_new__sig;
        if (tmpRec_56.Is(vdm_AS_ExportSig)) 
          unArg_55 = tmpRec_56.GetField(pos_AS_ExportSig_ops);
        else 
          RunTime("Unknown record field selector");
        iset_52 = unArg_55.Dom();
      }
      Record vdm_MOD_name(vdm_AS_Name, length_AS_Name);
      bool succ_54;
      Generic tmpe_89;
      for (int bb_88 = iset_52.First(tmpe_89); bb_88; bb_88 = iset_52.Next(tmpe_89)) {
        Record elem_53 = tmpe_89;
        {
          succ_54 = true;
          {
            vdm_MOD_name = elem_53;
            succ_54 = true;
          }
          if (succ_54) {
            bool succ_57;
            Record tmpVal_58(vdm_AS_Name, length_AS_Name);
            {
              Bool cond_59;
{ cond_59 = (Bool) (vdm_MOD_ren.Dom().InSet(vdm_MOD_name)); }
              if (cond_59.GetValue()) {
                Map tmp_m_63;
                tmp_m_63 = vdm_MOD_ren;
                tmpVal_58 = (Record) (((Map) tmp_m_63)[vdm_MOD_name]);
              }
              else { tmpVal_58 = vdm_MOD_name; }
            }
            Record vdm_MOD_new__name(vdm_AS_Name, length_AS_Name);
            succ_57 = true;
            {
              vdm_MOD_new__name = tmpVal_58;
              succ_57 = true;
            }
            if (!succ_57) 
              RunTime("Pattern match did not succeed in value definition");
            {
              Bool cond_65;
              {
                Map tmpVar_67;
                {
                  Record tmpRec_68(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                  tmpRec_68 = vdm_MOD_defs;
                  if (tmpRec_68.Is(vdm_GLOBAL_SigmaDEFS)) 
                    tmpVar_67 = tmpRec_68.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                  else 
                    RunTime("Unknown record field selector");
                }
                cond_65 = vdm_MOD_HasOpPrePostCond(vdm_MOD_new__name, tmpVar_67);
              }
              if (cond_65.GetValue()) {
                Map rhs_69;
                {
                  Map seqmap_70;
                  {
                    Record tmpRec_73(vdm_AS_ExportSig, length_AS_ExportSig);
                    tmpRec_73 = vdm_MOD_new__sig;
                    if (tmpRec_73.Is(vdm_AS_ExportSig)) 
                      seqmap_70 = tmpRec_73.GetField(pos_AS_ExportSig_fns);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Map modmap_71;
                  {
                    Map tmpVar_75;
                    {
                      Record tmpRec_76(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                      tmpRec_76 = vdm_MOD_defs;
                      if (tmpRec_76.Is(vdm_GLOBAL_SigmaDEFS)) 
                        tmpVar_75 = tmpRec_76.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    modmap_71 = vdm_MOD_GetPrePostOps(vdm_MOD_new__name, tmpVar_75);
                  }
                  seqmap_70.ImpOverride(modmap_71);
                  rhs_69 = seqmap_70;
                }
                Record mu_rhs_77(vdm_AS_ExportSig, length_AS_ExportSig);                {
                  Record tmpRE_78(vdm_AS_ExportSig, length_AS_ExportSig);
                  tmpRE_78 = vdm_MOD_new__sig;
                  int mu_79;
                  mu_79 = pos_AS_ExportSig_fns;
                  Map val_80;
                  {
                    Map seqmap_81;
                    {
                      Record tmpRec_84(vdm_AS_ExportSig, length_AS_ExportSig);
                      tmpRec_84 = vdm_MOD_new__sig;
                      if (tmpRec_84.Is(vdm_AS_ExportSig)) 
                        seqmap_81 = tmpRec_84.GetField(pos_AS_ExportSig_fns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    Map modmap_82;
                    {
                      Map tmpVar_86;
                      {
                        Record tmpRec_87(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                        tmpRec_87 = vdm_MOD_defs;
                        if (tmpRec_87.Is(vdm_GLOBAL_SigmaDEFS)) 
                          tmpVar_86 = tmpRec_87.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                        else 
                          RunTime("Unknown record field selector");
                      }
                      modmap_82 = vdm_MOD_GetPrePostOps(vdm_MOD_new__name, tmpVar_86);
                    }
                    seqmap_81.ImpOverride(modmap_82);
                    val_80 = seqmap_81;
                  }
                  tmpRE_78.SetField(mu_79, val_80);
                  mu_rhs_77 = tmpRE_78;
                }                vdm_MOD_new__sig = mu_rhs_77;
              }
            }
          }
          else 
            RunTime("Pattern did not match in set for loop");
        }
      }
    }
    {
      Set iset_90;
      {
        Map unArg_93;
        Record tmpRec_94(vdm_AS_ExportSig, length_AS_ExportSig);
        tmpRec_94 = vdm_MOD_new__sig;
        if (tmpRec_94.Is(vdm_AS_ExportSig)) 
          unArg_93 = tmpRec_94.GetField(pos_AS_ExportSig_tps);
        else 
          RunTime("Unknown record field selector");
        iset_90 = unArg_93.Dom();
      }
      Record vdm_MOD_name(vdm_AS_Name, length_AS_Name);
      bool succ_92;
      Generic tmpe_134;
      for (int bb_133 = iset_90.First(tmpe_134); bb_133; bb_133 = iset_90.Next(tmpe_134)) {
        Record elem_91 = tmpe_134;
        {
          succ_92 = true;
          {
            vdm_MOD_name = elem_91;
            succ_92 = true;
          }
          if (succ_92) {
            bool succ_95;
            Record tmpVal_96(vdm_AS_Name, length_AS_Name);
            {
              Bool cond_97;
{ cond_97 = (Bool) (vdm_MOD_ren.Dom().InSet(vdm_MOD_name)); }
              if (cond_97.GetValue()) {
                Map tmp_m_101;
                tmp_m_101 = vdm_MOD_ren;
                tmpVal_96 = (Record) (((Map) tmp_m_101)[vdm_MOD_name]);
              }
              else { tmpVal_96 = vdm_MOD_name; }
            }
            Record vdm_MOD_new__name(vdm_AS_Name, length_AS_Name);
            succ_95 = true;
            {
              vdm_MOD_new__name = tmpVal_96;
              succ_95 = true;
            }
            if (!succ_95) 
              RunTime("Pattern match did not succeed in value definition");
            {
              Bool cond_103;
              {
                Bool var1_104;
                Generic var1_106;
                Map tmp_m_108;
                {
                  Record tmpRec_110(vdm_AS_ExportSig, length_AS_ExportSig);
                  tmpRec_110 = vdm_MOD_new__sig;
                  if (tmpRec_110.Is(vdm_AS_ExportSig)) 
                    tmp_m_108 = tmpRec_110.GetField(pos_AS_ExportSig_tps);
                  else 
                    RunTime("Unknown record field selector");
                }
                var1_106 = (Generic) (((Map) tmp_m_108)[vdm_MOD_new__name]);
                var1_104 = (Bool) (var1_106 == (Quote) "STRUCT");
                if ((cond_103 = var1_104).GetValue()) {
                  Bool var2_105;
                  Map tmpVar_112;
                  {
                    Record tmpRec_113(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                    tmpRec_113 = vdm_MOD_defs;
                    if (tmpRec_113.Is(vdm_GLOBAL_SigmaDEFS)) 
                      tmpVar_112 = tmpRec_113.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  var2_105 = vdm_MOD_HasTpInvariant(vdm_MOD_new__name, tmpVar_112);
                  cond_103 = var2_105;
                }
              }
              if (cond_103.GetValue()) {
                Map rhs_114;
                {
                  Map seqmap_115;
                  {
                    Record tmpRec_118(vdm_AS_ExportSig, length_AS_ExportSig);
                    tmpRec_118 = vdm_MOD_new__sig;
                    if (tmpRec_118.Is(vdm_AS_ExportSig)) 
                      seqmap_115 = tmpRec_118.GetField(pos_AS_ExportSig_fns);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Map modmap_116;
                  {
                    Map tmpVar_120;
                    {
                      Record tmpRec_121(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                      tmpRec_121 = vdm_MOD_defs;
                      if (tmpRec_121.Is(vdm_GLOBAL_SigmaDEFS)) 
                        tmpVar_120 = tmpRec_121.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    modmap_116 = vdm_MOD_GetTpInvariant(vdm_MOD_new__name, tmpVar_120);
                  }
                  seqmap_115.ImpOverride(modmap_116);
                  rhs_114 = seqmap_115;
                }
                Record mu_rhs_122(vdm_AS_ExportSig, length_AS_ExportSig);                {
                  Record tmpRE_123(vdm_AS_ExportSig, length_AS_ExportSig);
                  tmpRE_123 = vdm_MOD_new__sig;
                  int mu_124;
                  mu_124 = pos_AS_ExportSig_fns;
                  Map val_125;
                  {
                    Map seqmap_126;
                    {
                      Record tmpRec_129(vdm_AS_ExportSig, length_AS_ExportSig);
                      tmpRec_129 = vdm_MOD_new__sig;
                      if (tmpRec_129.Is(vdm_AS_ExportSig)) 
                        seqmap_126 = tmpRec_129.GetField(pos_AS_ExportSig_fns);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    Map modmap_127;
                    {
                      Map tmpVar_131;
                      {
                        Record tmpRec_132(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
                        tmpRec_132 = vdm_MOD_defs;
                        if (tmpRec_132.Is(vdm_GLOBAL_SigmaDEFS)) 
                          tmpVar_131 = tmpRec_132.GetField(pos_GLOBAL_SigmaDEFS_explfns);
                        else 
                          RunTime("Unknown record field selector");
                      }
                      modmap_127 = vdm_MOD_GetTpInvariant(vdm_MOD_new__name, tmpVar_131);
                    }
                    seqmap_126.ImpOverride(modmap_127);
                    val_125 = seqmap_126;
                  }
                  tmpRE_123.SetField(mu_124, val_125);
                  mu_rhs_122 = tmpRE_123;
                }                vdm_MOD_new__sig = mu_rhs_122;
              }
            }
          }
          else 
            RunTime("Pattern did not match in set for loop");
        }
      }
    }
    {
      Record rexpr_135(vdm_AS_ExportSig, length_AS_ExportSig);
      rexpr_135 = vdm_MOD_new__sig;
      return rexpr_135;
    }
  }
}

Map vdm_MOD_BuildImportNameSet(Map vdm_MOD_imp__m) {
  Map vdm_MOD_res__m;
  vdm_MOD_res__m = Map();
  {
    Set iset_3;
    iset_3 = vdm_MOD_imp__m.Dom();
    Record vdm_MOD_id(vdm_AS_Name, length_AS_Name);
    bool succ_5;
    Generic tmpe_44;
    for (int bb_43 = iset_3.First(tmpe_44); bb_43; bb_43 = iset_3.Next(tmpe_44)) {
      Record elem_4 = tmpe_44;
      {
        succ_5 = true;
        {
          vdm_MOD_id = elem_4;
          succ_5 = true;
        }
        if (succ_5) {
          Generic vdm_MOD_imp__sig;
          Map tmp_m_9;
          tmp_m_9 = vdm_MOD_imp__m;
          vdm_MOD_imp__sig = (Generic) (((Map) tmp_m_9)[vdm_MOD_id]);
          {
            Bool cond_11;
            cond_11 = (Bool) (vdm_MOD_imp__sig == Nil());
            if (cond_11.GetValue()) {
              Map rhs_37;
              {
                Map seqmap_38;
                seqmap_38 = vdm_MOD_res__m;
                Map modmap_39;
                modmap_39 = Map().Insert(vdm_MOD_id, Nil());
                seqmap_38.ImpOverride(modmap_39);
                rhs_37 = seqmap_38;
              }
              vdm_MOD_res__m = rhs_37;
            }
            else {
              Map rhs_14;
              {
                Map seqmap_15;
                seqmap_15 = vdm_MOD_res__m;
                Map modmap_16;
                {
                  Set tmpVar2_19;
                  {
                    Set unArg_20;
                    Set tmpVar_21;
                    Map unArg_22;
                    Generic tmpRec_23;
                    tmpRec_23 = vdm_MOD_imp__sig;
                    if (tmpRec_23.IsRecord()) 
                      if (((Record) tmpRec_23).Is(vdm_AS_ImportSig)) 
                        unArg_22 = ((Record) tmpRec_23).GetField(pos_AS_ImportSig_tps);
                      else 
                        RunTime("Unknown record field selector");
                    else 
                      RunTime("A record was expected");
                    tmpVar_21 = unArg_22.Dom();
                    unArg_20 = Set().Insert(tmpVar_21);
                    Set tmpVar_24;
                    Map unArg_25;
                    Generic tmpRec_26;
                    tmpRec_26 = vdm_MOD_imp__sig;
                    if (tmpRec_26.IsRecord()) 
                      if (((Record) tmpRec_26).Is(vdm_AS_ImportSig)) 
                        unArg_25 = ((Record) tmpRec_26).GetField(pos_AS_ImportSig_val);
                      else 
                        RunTime("Unknown record field selector");
                    else 
                      RunTime("A record was expected");
                    tmpVar_24 = unArg_25.Dom();
                    unArg_20.Insert(tmpVar_24);
                    Set tmpVar_27;
                    Map unArg_28;
                    Generic tmpRec_29;
                    tmpRec_29 = vdm_MOD_imp__sig;
                    if (tmpRec_29.IsRecord()) 
                      if (((Record) tmpRec_29).Is(vdm_AS_ImportSig)) 
                        unArg_28 = ((Record) tmpRec_29).GetField(pos_AS_ImportSig_fns);
                      else 
                        RunTime("Unknown record field selector");
                    else 
                      RunTime("A record was expected");
                    tmpVar_27 = unArg_28.Dom();
                    unArg_20.Insert(tmpVar_27);
                    Set tmpVar_30;
                    Map unArg_31;
                    Generic tmpRec_32;
                    tmpRec_32 = vdm_MOD_imp__sig;
                    if (tmpRec_32.IsRecord()) 
                      if (((Record) tmpRec_32).Is(vdm_AS_ImportSig)) 
                        unArg_31 = ((Record) tmpRec_32).GetField(pos_AS_ImportSig_ops);
                      else 
                        RunTime("Unknown record field selector");
                    else 
                      RunTime("A record was expected");
                    tmpVar_30 = unArg_31.Dom();
                    unArg_20.Insert(tmpVar_30);
                    {
                      Set rduset_33;
                      Generic tmpe_36;
                      for (int bb_35 = unArg_20.First(tmpe_36); bb_35; bb_35 = unArg_20.Next(tmpe_36)) {
                        Set e_34 = tmpe_36;
                        rduset_33.ImpUnion(e_34);
                      }
                      tmpVar2_19 = rduset_33;
                    }
                  }
                  modmap_16 = Map().Insert(vdm_MOD_id, tmpVar2_19);
                }
                seqmap_15.ImpOverride(modmap_16);
                rhs_14 = seqmap_15;
              }
              vdm_MOD_res__m = rhs_14;
            }
          }
        }
        else 
          RunTime("Pattern did not match in set for loop");
      }
    }
  }
  {
    Map rexpr_45;
    rexpr_45 = vdm_MOD_res__m;
    return rexpr_45;
  }
}

Map vdm_MOD_BuildRenameMap(Map vdm_MOD_imp__m) {
  Map vdm_MOD_res__m;
  vdm_MOD_res__m = Map();
  {
    Set iset_3;
    iset_3 = vdm_MOD_imp__m.Dom();
    Record vdm_MOD_id(vdm_AS_Name, length_AS_Name);
    bool succ_5;
    Generic tmpe_35;
    for (int bb_34 = iset_3.First(tmpe_35); bb_34; bb_34 = iset_3.Next(tmpe_35)) {
      Record elem_4 = tmpe_35;
      {
        succ_5 = true;
        {
          vdm_MOD_id = elem_4;
          succ_5 = true;
        }
        if (succ_5) {
          Generic vdm_MOD_imp__sig;
          Map tmp_m_9;
          tmp_m_9 = vdm_MOD_imp__m;
          vdm_MOD_imp__sig = (Generic) (((Map) tmp_m_9)[vdm_MOD_id]);
          {
            Bool cond_11;
            cond_11 = (Bool) (!(vdm_MOD_imp__sig == Nil()));
            if (cond_11.GetValue()) {
              Bool cond_14;
              {
                Set var1_15;
                Set var1_17;
                Map unArg_19;
                Generic tmpRec_20;
                tmpRec_20 = vdm_MOD_imp__sig;
                if (tmpRec_20.IsRecord()) 
                  if (((Record) tmpRec_20).Is(vdm_AS_ImportSig)) 
                    unArg_19 = ((Record) tmpRec_20).GetField(pos_AS_ImportSig_ren);
                  else 
                    RunTime("Unknown record field selector");
                else 
                  RunTime("A record was expected");
                var1_17 = unArg_19.Dom();
                var1_15 = var1_17;
                var1_15.ImpIntersect(vdm_MOD_res__m.Dom());
                Set var2_16;
                var2_16 = Set();
                cond_14 = (Bool) (!(var1_15 == var2_16));
              }
              if (cond_14.GetValue()) 
                RunTime("Can not evaluate an error statement");
              else {
                Map rhs_22;
                {
                  Map var2_24;
                  Map tmpVar_26;
                  {
                    Generic tmpRec_27;
                    tmpRec_27 = vdm_MOD_imp__sig;
                    if (tmpRec_27.IsRecord()) 
                      if (((Record) tmpRec_27).Is(vdm_AS_ImportSig)) 
                        tmpVar_26 = ((Record) tmpRec_27).GetField(pos_AS_ImportSig_ren);
                      else 
                        RunTime("Unknown record field selector");
                    else 
                      RunTime("A record was expected");
                  }
                  var2_24 = vdm_MOD_MakeRenamings(vdm_MOD_id, tmpVar_26);
                  {
                    Map m1_32 = vdm_MOD_res__m;
                    Map m2_33 = var2_24;
                    Set com_28 = m1_32.Dom();
                    com_28.ImpIntersect(m2_33.Dom());
                    int all_applies_29 = 1;
                    Generic d_30;
                    for (int bb_31 = com_28.First(d_30); bb_31 && all_applies_29; bb_31 = com_28.Next(d_30)) 
                      all_applies_29 *= m1_32[d_30] == m2_33[d_30];
                    if (all_applies_29) 
                      m1_32.ImpOverride(m2_33);
                    else 
                      RunTime("EvalMapMerge Duplicates not equal");
                    rhs_22 = m1_32;
                  }
                }
                vdm_MOD_res__m = rhs_22;
              }
            }
          }
        }
        else 
          RunTime("Pattern did not match in set for loop");
      }
    }
  }
  {
    Map rexpr_36;
    rexpr_36 = vdm_MOD_res__m;
    return rexpr_36;
  }
}

Generic vdm_MOD_GetModuleInvariant() {
  bool succ_2;
  Record tmpVal_3(vdm_AS_Name, length_AS_Name);
  tmpVal_3 = vdm_MOD_CurrentModule();
  Record vdm_MOD_mod__name(vdm_AS_Name, length_AS_Name);
  succ_2 = true;
  {
    vdm_MOD_mod__name = tmpVal_3;
    succ_2 = true;
  }
  if (!succ_2) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Record vdm_MOD_sigmamo;
    vdm_MOD_sigmamo = vdm_MOD_GetModule(vdm_MOD_mod__name);
    {
      Generic rexpr_7;
      {
        Record tmpRec_8;
        tmpRec_8 = vdm_MOD_sigmamo;
        if (((Record) tmpRec_8).Is(vdm_GLOBAL_SigmaMO)) 
          rexpr_7 = ((Record) tmpRec_8).GetField(pos_GLOBAL_SigmaMO_stateinv);
        else 
          RunTime("Unknown record field selector");
      }
      return rexpr_7;
    }
  }
}

Generic vdm_MOD_GetModuleStateInit(Record vdm_MOD_name) {
  Record vdm_MOD_sigmamo;
  vdm_MOD_sigmamo = vdm_MOD_GetModule(vdm_MOD_name);
  {
    Generic rexpr_6;
    {
      Record tmpRec_7;
      tmpRec_7 = vdm_MOD_sigmamo;
      if (((Record) tmpRec_7).Is(vdm_GLOBAL_SigmaMO)) 
        rexpr_6 = ((Record) tmpRec_7).GetField(pos_GLOBAL_SigmaMO_gs__init);
      else 
        RunTime("Unknown record field selector");
    }
    return rexpr_6;
  }
}

Map vdm_MOD_GetPrePostFns(Record vdm_MOD_name, Map vdm_MOD_efns, Map vdm_MOD_epfns) {
  bool succ_5;
  Record tmpVal_6(vdm_AS_Name, length_AS_Name);
  tmpVal_6 = vdm_MOD_name;
  Sequence vdm_MOD_fn__id;
  succ_5 = true;
  {
    succ_5 = false;
    if (tmpVal_6.IsRecord()) 
      if (vdm_AS_Name == tmpVal_6.GetTag()) {
        Sequence e_l_7;
        for (int i_8 = 1; i_8 <= tmpVal_6.Length(); i_8++) 
          e_l_7.ImpAppend(tmpVal_6.GetField(i_8));
        if (succ_5 = 2 == (Int) (e_l_7.Length())) {
          Generic permI_9;
          permI_9 = (Generic) (e_l_7.Hd());
          succ_5 = true;
          {
            vdm_MOD_fn__id = permI_9;
            succ_5 = true;
          }
          permI_9 = (Generic) (e_l_7[2]);
          if (succ_5) 
            succ_5 = true;
        }
      }
  }
  if (!succ_5) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Map vdm_MOD_res__m;
    vdm_MOD_res__m = Map();
    {
      Sequence vdm_MOD_Pre__id;
      Sequence var2_13;
      Sequence tmpseq_14;
      tmpseq_14 = vdm_MOD_fn__id;
      var2_13 = (Sequence) (tmpseq_14[((Int) 1).GetValue()]);
      vdm_MOD_Pre__id.ImpConc(Sequence("pre_")).ImpConc(var2_13);
      Sequence vdm_MOD_Post__id;
      Sequence var2_18;
      Sequence tmpseq_19;
      tmpseq_19 = vdm_MOD_fn__id;
      var2_18 = (Sequence) (tmpseq_19[((Int) 1).GetValue()]);
      vdm_MOD_Post__id.ImpConc(Sequence("post_")).ImpConc(var2_18);
      {
        Bool cond_21;
        {
          Set var2_23;
          Set unArg_24;
          Set res_s_25;
          {
            Sequence seq_lv_30;
            bool succ_28;
            Bool tsucc_31;
            tsucc_31 = true;
            {
              Set tmpVar_v_29;
              tmpVar_v_29 = vdm_MOD_efns.Dom();
              {
                Set tmpVar_s_34;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_40;
                  for (int bb_39 = tmpVar_v_29.First(tmpe_40); bb_39; bb_39 = tmpVar_v_29.Next(tmpe_40)) {
                    Record tmp_35 = tmpe_40;
                    {
                      succ_28 = false;
                      if (tmp_35.IsRecord()) 
                        if (vdm_AS_Name == tmp_35.GetTag()) {
                          Sequence e_l_36;
                          for (int i_37 = 1; i_37 <= tmp_35.Length(); i_37++) 
                            e_l_36.ImpAppend(tmp_35.GetField(i_37));
                          if (succ_28 = 2 == (Int) (e_l_36.Length())) {
                            Generic permI_38;
                            permI_38 = (Generic) (e_l_36.Hd());
                            succ_28 = true;
                            {
                              vdm_MOD_ids = permI_38;
                              succ_28 = true;
                            }
                            permI_38 = (Generic) (e_l_36[2]);
                            if (succ_28) 
                              succ_28 = true;
                          }
                        }
                      if (succ_28) { tmpVar_s_34.Insert(tmp_35); }
                    }
                  }
                }
                seq_lv_30.ImpAppend(tmpVar_s_34);
              }
            }
            Set allComb_32 = GenAllComb(seq_lv_30);
            Sequence vdm_MOD_ids;
            Generic tmpe_48;
            for (int bb_47 = allComb_32.First(tmpe_48); bb_47; bb_47 = allComb_32.Next(tmpe_48)) {
              Sequence tmp_42 = tmpe_48;
              {
                if (succ_28 = 1 == (Int) (tmp_42.Length())) {
                  Record permI_43(vdm_AS_Name, length_AS_Name);
                  permI_43 = (Record) (tmp_42.Hd());
                  succ_28 = true;
                  {
                    succ_28 = false;
                    if (permI_43.IsRecord()) 
                      if (vdm_AS_Name == permI_43.GetTag()) {
                        Sequence e_l_44;
                        for (int i_45 = 1; i_45 <= permI_43.Length(); i_45++) 
                          e_l_44.ImpAppend(permI_43.GetField(i_45));
                        if (succ_28 = 2 == (Int) (e_l_44.Length())) {
                          Generic permI_46;
                          permI_46 = (Generic) (e_l_44.Hd());
                          succ_28 = true;
                          {
                            vdm_MOD_ids = permI_46;
                            succ_28 = true;
                          }
                          permI_46 = (Generic) (e_l_44[2]);
                          if (succ_28) 
                            succ_28 = true;
                        }
                      }
                  }
                }
                if (succ_28) {
                  Set elem_26;
                  elem_26 = vdm_MOD_ids.Elems();
                  res_s_25.Insert(elem_26);
                }
              }
            }
          }
          unArg_24 = res_s_25;
          {
            Set rduset_49;
            Generic tmpe_52;
            for (int bb_51 = unArg_24.First(tmpe_52); bb_51; bb_51 = unArg_24.Next(tmpe_52)) {
              Set e_50 = tmpe_52;
              rduset_49.ImpUnion(e_50);
            }
            var2_23 = rduset_49;
          }
          cond_21 = (Bool) (var2_23.InSet(vdm_MOD_Pre__id));
        }
        if (cond_21.GetValue()) {
          Record vdm_MOD_Pre__name(vdm_AS_Name, length_AS_Name);
          vdm_MOD_Pre__name = Record(vdm_AS_Name, length_AS_Name);
          Sequence tmpVar_55;
          tmpVar_55 = Sequence().ImpAppend(vdm_MOD_Pre__id);
          vdm_MOD_Pre__name.SetField(1, tmpVar_55);
          vdm_MOD_Pre__name.SetField(2, Nil());
          {
            Map rhs_58;
            {
              Map seqmap_59;
              seqmap_59 = vdm_MOD_res__m;
              Map modmap_60;
              {
                Record tmpVar2_63;
                {
                  Record tmpRec_64(vdm_SEM_ExplFN, length_SEM_ExplFN);
                  {
                    Map tmp_m_65;
                    tmp_m_65 = vdm_MOD_efns;
                    tmpRec_64 = (Record) (((Map) tmp_m_65)[vdm_MOD_Pre__name]);
                  }
                  if (tmpRec_64.Is(vdm_SEM_ExplFN)) 
                    tmpVar2_63 = tmpRec_64.GetField(pos_SEM_ExplFN_tp);
                  else 
                    RunTime("Unknown record field selector");
                }
                modmap_60 = Map().Insert(vdm_MOD_Pre__name, tmpVar2_63);
              }
              seqmap_59.ImpOverride(modmap_60);
              rhs_58 = seqmap_59;
            }
            vdm_MOD_res__m = rhs_58;
          }
        }
        {
          Bool cond_67;
          {
            Set var2_69;
            Set unArg_70;
            Set res_s_71;
            {
              Sequence seq_lv_76;
              bool succ_74;
              Bool tsucc_77;
              tsucc_77 = true;
              {
                Set tmpVar_v_75;
                tmpVar_v_75 = vdm_MOD_epfns.Dom();
                {
                  Set tmpVar_s_80;
                  {
                    Sequence vdm_MOD_ids;
                    Generic tmpe_86;
                    for (int bb_85 = tmpVar_v_75.First(tmpe_86); bb_85; bb_85 = tmpVar_v_75.Next(tmpe_86)) {
                      Record tmp_81 = tmpe_86;
                      {
                        succ_74 = false;
                        if (tmp_81.IsRecord()) 
                          if (vdm_AS_Name == tmp_81.GetTag()) {
                            Sequence e_l_82;
                            for (int i_83 = 1; i_83 <= tmp_81.Length(); i_83++) 
                              e_l_82.ImpAppend(tmp_81.GetField(i_83));
                            if (succ_74 = 2 == (Int) (e_l_82.Length())) {
                              Generic permI_84;
                              permI_84 = (Generic) (e_l_82.Hd());
                              succ_74 = true;
                              {
                                vdm_MOD_ids = permI_84;
                                succ_74 = true;
                              }
                              permI_84 = (Generic) (e_l_82[2]);
                              if (succ_74) 
                                succ_74 = true;
                            }
                          }
                        if (succ_74) { tmpVar_s_80.Insert(tmp_81); }
                      }
                    }
                  }
                  seq_lv_76.ImpAppend(tmpVar_s_80);
                }
              }
              Set allComb_78 = GenAllComb(seq_lv_76);
              Sequence vdm_MOD_ids;
              Generic tmpe_94;
              for (int bb_93 = allComb_78.First(tmpe_94); bb_93; bb_93 = allComb_78.Next(tmpe_94)) {
                Sequence tmp_88 = tmpe_94;
                {
                  if (succ_74 = 1 == (Int) (tmp_88.Length())) {
                    Record permI_89(vdm_AS_Name, length_AS_Name);
                    permI_89 = (Record) (tmp_88.Hd());
                    succ_74 = true;
                    {
                      succ_74 = false;
                      if (permI_89.IsRecord()) 
                        if (vdm_AS_Name == permI_89.GetTag()) {
                          Sequence e_l_90;
                          for (int i_91 = 1; i_91 <= permI_89.Length(); i_91++) 
                            e_l_90.ImpAppend(permI_89.GetField(i_91));
                          if (succ_74 = 2 == (Int) (e_l_90.Length())) {
                            Generic permI_92;
                            permI_92 = (Generic) (e_l_90.Hd());
                            succ_74 = true;
                            {
                              vdm_MOD_ids = permI_92;
                              succ_74 = true;
                            }
                            permI_92 = (Generic) (e_l_90[2]);
                            if (succ_74) 
                              succ_74 = true;
                          }
                        }
                    }
                  }
                  if (succ_74) {
                    Set elem_72;
                    elem_72 = vdm_MOD_ids.Elems();
                    res_s_71.Insert(elem_72);
                  }
                }
              }
            }
            unArg_70 = res_s_71;
            {
              Set rduset_95;
              Generic tmpe_98;
              for (int bb_97 = unArg_70.First(tmpe_98); bb_97; bb_97 = unArg_70.Next(tmpe_98)) {
                Set e_96 = tmpe_98;
                rduset_95.ImpUnion(e_96);
              }
              var2_69 = rduset_95;
            }
            cond_67 = (Bool) (var2_69.InSet(vdm_MOD_Pre__id));
          }
          if (cond_67.GetValue()) {
            Record vdm_MOD_Pre__name(vdm_AS_Name, length_AS_Name);
            vdm_MOD_Pre__name = Record(vdm_AS_Name, length_AS_Name);
            Sequence tmpVar_101;
            tmpVar_101 = Sequence().ImpAppend(vdm_MOD_Pre__id);
            vdm_MOD_Pre__name.SetField(1, tmpVar_101);
            vdm_MOD_Pre__name.SetField(2, Nil());
            {
              Map rhs_104;
              {
                Map seqmap_105;
                seqmap_105 = vdm_MOD_res__m;
                Map modmap_106;
                {
                  Record tmpVar2_109;
                  {
                    Record tmpRec_110(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
                    {
                      Map tmp_m_111;
                      tmp_m_111 = vdm_MOD_epfns;
                      tmpRec_110 = (Record) (((Map) tmp_m_111)[vdm_MOD_Pre__name]);
                    }
                    if (tmpRec_110.Is(vdm_SEM_ExplPOLY)) 
                      tmpVar2_109 = tmpRec_110.GetField(pos_SEM_ExplPOLY_tp);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  modmap_106 = Map().Insert(vdm_MOD_Pre__name, tmpVar2_109);
                }
                seqmap_105.ImpOverride(modmap_106);
                rhs_104 = seqmap_105;
              }
              vdm_MOD_res__m = rhs_104;
            }
          }
        }
        {
          Bool cond_113;
          {
            Set var2_115;
            Set unArg_116;
            Set res_s_117;
            {
              Sequence seq_lv_122;
              bool succ_120;
              Bool tsucc_123;
              tsucc_123 = true;
              {
                Set tmpVar_v_121;
                tmpVar_v_121 = vdm_MOD_efns.Dom();
                {
                  Set tmpVar_s_126;
                  {
                    Sequence vdm_MOD_ids;
                    Generic tmpe_132;
                    for (int bb_131 = tmpVar_v_121.First(tmpe_132); bb_131; bb_131 = tmpVar_v_121.Next(tmpe_132)) {
                      Record tmp_127 = tmpe_132;
                      {
                        succ_120 = false;
                        if (tmp_127.IsRecord()) 
                          if (vdm_AS_Name == tmp_127.GetTag()) {
                            Sequence e_l_128;
                            for (int i_129 = 1; i_129 <= tmp_127.Length(); i_129++) 
                              e_l_128.ImpAppend(tmp_127.GetField(i_129));
                            if (succ_120 = 2 == (Int) (e_l_128.Length())) {
                              Generic permI_130;
                              permI_130 = (Generic) (e_l_128.Hd());
                              succ_120 = true;
                              {
                                vdm_MOD_ids = permI_130;
                                succ_120 = true;
                              }
                              permI_130 = (Generic) (e_l_128[2]);
                              if (succ_120) 
                                succ_120 = true;
                            }
                          }
                        if (succ_120) { tmpVar_s_126.Insert(tmp_127); }
                      }
                    }
                  }
                  seq_lv_122.ImpAppend(tmpVar_s_126);
                }
              }
              Set allComb_124 = GenAllComb(seq_lv_122);
              Sequence vdm_MOD_ids;
              Generic tmpe_140;
              for (int bb_139 = allComb_124.First(tmpe_140); bb_139; bb_139 = allComb_124.Next(tmpe_140)) {
                Sequence tmp_134 = tmpe_140;
                {
                  if (succ_120 = 1 == (Int) (tmp_134.Length())) {
                    Record permI_135(vdm_AS_Name, length_AS_Name);
                    permI_135 = (Record) (tmp_134.Hd());
                    succ_120 = true;
                    {
                      succ_120 = false;
                      if (permI_135.IsRecord()) 
                        if (vdm_AS_Name == permI_135.GetTag()) {
                          Sequence e_l_136;
                          for (int i_137 = 1; i_137 <= permI_135.Length(); i_137++) 
                            e_l_136.ImpAppend(permI_135.GetField(i_137));
                          if (succ_120 = 2 == (Int) (e_l_136.Length())) {
                            Generic permI_138;
                            permI_138 = (Generic) (e_l_136.Hd());
                            succ_120 = true;
                            {
                              vdm_MOD_ids = permI_138;
                              succ_120 = true;
                            }
                            permI_138 = (Generic) (e_l_136[2]);
                            if (succ_120) 
                              succ_120 = true;
                          }
                        }
                    }
                  }
                  if (succ_120) {
                    Set elem_118;
                    elem_118 = vdm_MOD_ids.Elems();
                    res_s_117.Insert(elem_118);
                  }
                }
              }
            }
            unArg_116 = res_s_117;
            {
              Set rduset_141;
              Generic tmpe_144;
              for (int bb_143 = unArg_116.First(tmpe_144); bb_143; bb_143 = unArg_116.Next(tmpe_144)) {
                Set e_142 = tmpe_144;
                rduset_141.ImpUnion(e_142);
              }
              var2_115 = rduset_141;
            }
            cond_113 = (Bool) (var2_115.InSet(vdm_MOD_Post__id));
          }
          if (cond_113.GetValue()) {
            Record vdm_MOD_Post__name(vdm_AS_Name, length_AS_Name);
            vdm_MOD_Post__name = Record(vdm_AS_Name, length_AS_Name);
            Sequence tmpVar_147;
            tmpVar_147 = Sequence().ImpAppend(vdm_MOD_Post__id);
            vdm_MOD_Post__name.SetField(1, tmpVar_147);
            vdm_MOD_Post__name.SetField(2, Nil());
            {
              Map rhs_150;
              {
                Map seqmap_151;
                seqmap_151 = vdm_MOD_res__m;
                Map modmap_152;
                {
                  Record tmpVar2_155;
                  {
                    Record tmpRec_156(vdm_SEM_ExplFN, length_SEM_ExplFN);
                    {
                      Map tmp_m_157;
                      tmp_m_157 = vdm_MOD_efns;
                      tmpRec_156 = (Record) (((Map) tmp_m_157)[vdm_MOD_Post__name]);
                    }
                    if (tmpRec_156.Is(vdm_SEM_ExplFN)) 
                      tmpVar2_155 = tmpRec_156.GetField(pos_SEM_ExplFN_tp);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  modmap_152 = Map().Insert(vdm_MOD_Post__name, tmpVar2_155);
                }
                seqmap_151.ImpOverride(modmap_152);
                rhs_150 = seqmap_151;
              }
              vdm_MOD_res__m = rhs_150;
            }
          }
        }
        {
          Bool cond_159;
          {
            Set var2_161;
            Set unArg_162;
            Set res_s_163;
            {
              Sequence seq_lv_168;
              bool succ_166;
              Bool tsucc_169;
              tsucc_169 = true;
              {
                Set tmpVar_v_167;
                tmpVar_v_167 = vdm_MOD_epfns.Dom();
                {
                  Set tmpVar_s_172;
                  {
                    Sequence vdm_MOD_ids;
                    Generic tmpe_178;
                    for (int bb_177 = tmpVar_v_167.First(tmpe_178); bb_177; bb_177 = tmpVar_v_167.Next(tmpe_178)) {
                      Record tmp_173 = tmpe_178;
                      {
                        succ_166 = false;
                        if (tmp_173.IsRecord()) 
                          if (vdm_AS_Name == tmp_173.GetTag()) {
                            Sequence e_l_174;
                            for (int i_175 = 1; i_175 <= tmp_173.Length(); i_175++) 
                              e_l_174.ImpAppend(tmp_173.GetField(i_175));
                            if (succ_166 = 2 == (Int) (e_l_174.Length())) {
                              Generic permI_176;
                              permI_176 = (Generic) (e_l_174.Hd());
                              succ_166 = true;
                              {
                                vdm_MOD_ids = permI_176;
                                succ_166 = true;
                              }
                              permI_176 = (Generic) (e_l_174[2]);
                              if (succ_166) 
                                succ_166 = true;
                            }
                          }
                        if (succ_166) { tmpVar_s_172.Insert(tmp_173); }
                      }
                    }
                  }
                  seq_lv_168.ImpAppend(tmpVar_s_172);
                }
              }
              Set allComb_170 = GenAllComb(seq_lv_168);
              Sequence vdm_MOD_ids;
              Generic tmpe_186;
              for (int bb_185 = allComb_170.First(tmpe_186); bb_185; bb_185 = allComb_170.Next(tmpe_186)) {
                Sequence tmp_180 = tmpe_186;
                {
                  if (succ_166 = 1 == (Int) (tmp_180.Length())) {
                    Record permI_181(vdm_AS_Name, length_AS_Name);
                    permI_181 = (Record) (tmp_180.Hd());
                    succ_166 = true;
                    {
                      succ_166 = false;
                      if (permI_181.IsRecord()) 
                        if (vdm_AS_Name == permI_181.GetTag()) {
                          Sequence e_l_182;
                          for (int i_183 = 1; i_183 <= permI_181.Length(); i_183++) 
                            e_l_182.ImpAppend(permI_181.GetField(i_183));
                          if (succ_166 = 2 == (Int) (e_l_182.Length())) {
                            Generic permI_184;
                            permI_184 = (Generic) (e_l_182.Hd());
                            succ_166 = true;
                            {
                              vdm_MOD_ids = permI_184;
                              succ_166 = true;
                            }
                            permI_184 = (Generic) (e_l_182[2]);
                            if (succ_166) 
                              succ_166 = true;
                          }
                        }
                    }
                  }
                  if (succ_166) {
                    Set elem_164;
                    elem_164 = vdm_MOD_ids.Elems();
                    res_s_163.Insert(elem_164);
                  }
                }
              }
            }
            unArg_162 = res_s_163;
            {
              Set rduset_187;
              Generic tmpe_190;
              for (int bb_189 = unArg_162.First(tmpe_190); bb_189; bb_189 = unArg_162.Next(tmpe_190)) {
                Set e_188 = tmpe_190;
                rduset_187.ImpUnion(e_188);
              }
              var2_161 = rduset_187;
            }
            cond_159 = (Bool) (var2_161.InSet(vdm_MOD_Post__id));
          }
          if (cond_159.GetValue()) {
            Record vdm_MOD_Post__name(vdm_AS_Name, length_AS_Name);
            vdm_MOD_Post__name = Record(vdm_AS_Name, length_AS_Name);
            Sequence tmpVar_193;
            tmpVar_193 = Sequence().ImpAppend(vdm_MOD_Post__id);
            vdm_MOD_Post__name.SetField(1, tmpVar_193);
            vdm_MOD_Post__name.SetField(2, Nil());
            {
              Map rhs_196;
              {
                Map seqmap_197;
                seqmap_197 = vdm_MOD_res__m;
                Map modmap_198;
                {
                  Record tmpVar2_201;
                  {
                    Record tmpRec_202(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
                    {
                      Map tmp_m_203;
                      tmp_m_203 = vdm_MOD_epfns;
                      tmpRec_202 = (Record) (((Map) tmp_m_203)[vdm_MOD_Post__name]);
                    }
                    if (tmpRec_202.Is(vdm_SEM_ExplPOLY)) 
                      tmpVar2_201 = tmpRec_202.GetField(pos_SEM_ExplPOLY_tp);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  modmap_198 = Map().Insert(vdm_MOD_Post__name, tmpVar2_201);
                }
                seqmap_197.ImpOverride(modmap_198);
                rhs_196 = seqmap_197;
              }
              vdm_MOD_res__m = rhs_196;
            }
          }
        }
        {
          Map rexpr_205;
          rexpr_205 = vdm_MOD_res__m;
          return rexpr_205;
        }
      }
    }
  }
}

Map vdm_MOD_GetPrePostOps(Record vdm_MOD_name, Map vdm_MOD_efns) {
  bool succ_4;
  Record tmpVal_5(vdm_AS_Name, length_AS_Name);
  tmpVal_5 = vdm_MOD_name;
  Sequence vdm_MOD_fn__id;
  succ_4 = true;
  {
    succ_4 = false;
    if (tmpVal_5.IsRecord()) 
      if (vdm_AS_Name == tmpVal_5.GetTag()) {
        Sequence e_l_6;
        for (int i_7 = 1; i_7 <= tmpVal_5.Length(); i_7++) 
          e_l_6.ImpAppend(tmpVal_5.GetField(i_7));
        if (succ_4 = 2 == (Int) (e_l_6.Length())) {
          Generic permI_8;
          permI_8 = (Generic) (e_l_6.Hd());
          succ_4 = true;
          {
            vdm_MOD_fn__id = permI_8;
            succ_4 = true;
          }
          permI_8 = (Generic) (e_l_6[2]);
          if (succ_4) 
            succ_4 = true;
        }
      }
  }
  if (!succ_4) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Map vdm_MOD_res__m;
    vdm_MOD_res__m = Map();
    {
      Sequence vdm_MOD_Pre__id;
      Sequence var2_12;
      Sequence tmpseq_13;
      tmpseq_13 = vdm_MOD_fn__id;
      var2_12 = (Sequence) (tmpseq_13[((Int) 1).GetValue()]);
      vdm_MOD_Pre__id.ImpConc(Sequence("pre_")).ImpConc(var2_12);
      Sequence vdm_MOD_Post__id;
      Sequence var2_17;
      Sequence tmpseq_18;
      tmpseq_18 = vdm_MOD_fn__id;
      var2_17 = (Sequence) (tmpseq_18[((Int) 1).GetValue()]);
      vdm_MOD_Post__id.ImpConc(Sequence("post_")).ImpConc(var2_17);
      {
        Bool cond_20;
        {
          Set var2_22;
          Set unArg_23;
          Set res_s_24;
          {
            Sequence seq_lv_29;
            bool succ_27;
            Bool tsucc_30;
            tsucc_30 = true;
            {
              Set tmpVar_v_28;
              tmpVar_v_28 = vdm_MOD_efns.Dom();
              {
                Set tmpVar_s_33;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_39;
                  for (int bb_38 = tmpVar_v_28.First(tmpe_39); bb_38; bb_38 = tmpVar_v_28.Next(tmpe_39)) {
                    Record tmp_34 = tmpe_39;
                    {
                      succ_27 = false;
                      if (tmp_34.IsRecord()) 
                        if (vdm_AS_Name == tmp_34.GetTag()) {
                          Sequence e_l_35;
                          for (int i_36 = 1; i_36 <= tmp_34.Length(); i_36++) 
                            e_l_35.ImpAppend(tmp_34.GetField(i_36));
                          if (succ_27 = 2 == (Int) (e_l_35.Length())) {
                            Generic permI_37;
                            permI_37 = (Generic) (e_l_35.Hd());
                            succ_27 = true;
                            {
                              vdm_MOD_ids = permI_37;
                              succ_27 = true;
                            }
                            permI_37 = (Generic) (e_l_35[2]);
                            if (succ_27) 
                              succ_27 = true;
                          }
                        }
                      if (succ_27) { tmpVar_s_33.Insert(tmp_34); }
                    }
                  }
                }
                seq_lv_29.ImpAppend(tmpVar_s_33);
              }
            }
            Set allComb_31 = GenAllComb(seq_lv_29);
            Sequence vdm_MOD_ids;
            Generic tmpe_47;
            for (int bb_46 = allComb_31.First(tmpe_47); bb_46; bb_46 = allComb_31.Next(tmpe_47)) {
              Sequence tmp_41 = tmpe_47;
              {
                if (succ_27 = 1 == (Int) (tmp_41.Length())) {
                  Record permI_42(vdm_AS_Name, length_AS_Name);
                  permI_42 = (Record) (tmp_41.Hd());
                  succ_27 = true;
                  {
                    succ_27 = false;
                    if (permI_42.IsRecord()) 
                      if (vdm_AS_Name == permI_42.GetTag()) {
                        Sequence e_l_43;
                        for (int i_44 = 1; i_44 <= permI_42.Length(); i_44++) 
                          e_l_43.ImpAppend(permI_42.GetField(i_44));
                        if (succ_27 = 2 == (Int) (e_l_43.Length())) {
                          Generic permI_45;
                          permI_45 = (Generic) (e_l_43.Hd());
                          succ_27 = true;
                          {
                            vdm_MOD_ids = permI_45;
                            succ_27 = true;
                          }
                          permI_45 = (Generic) (e_l_43[2]);
                          if (succ_27) 
                            succ_27 = true;
                        }
                      }
                  }
                }
                if (succ_27) {
                  Set elem_25;
                  elem_25 = vdm_MOD_ids.Elems();
                  res_s_24.Insert(elem_25);
                }
              }
            }
          }
          unArg_23 = res_s_24;
          {
            Set rduset_48;
            Generic tmpe_51;
            for (int bb_50 = unArg_23.First(tmpe_51); bb_50; bb_50 = unArg_23.Next(tmpe_51)) {
              Set e_49 = tmpe_51;
              rduset_48.ImpUnion(e_49);
            }
            var2_22 = rduset_48;
          }
          cond_20 = (Bool) (var2_22.InSet(vdm_MOD_Pre__id));
        }
        if (cond_20.GetValue()) {
          Record vdm_MOD_Pre__name(vdm_AS_Name, length_AS_Name);
          vdm_MOD_Pre__name = Record(vdm_AS_Name, length_AS_Name);
          Sequence tmpVar_54;
          tmpVar_54 = Sequence().ImpAppend(vdm_MOD_Pre__id);
          vdm_MOD_Pre__name.SetField(1, tmpVar_54);
          vdm_MOD_Pre__name.SetField(2, Nil());
          {
            Map rhs_57;
            {
              Map seqmap_58;
              seqmap_58 = vdm_MOD_res__m;
              Map modmap_59;
              {
                Record tmpVar2_62;
                {
                  Record tmpRec_63(vdm_SEM_ExplFN, length_SEM_ExplFN);
                  {
                    Map tmp_m_64;
                    tmp_m_64 = vdm_MOD_efns;
                    tmpRec_63 = (Record) (((Map) tmp_m_64)[vdm_MOD_Pre__name]);
                  }
                  if (tmpRec_63.Is(vdm_SEM_ExplFN)) 
                    tmpVar2_62 = tmpRec_63.GetField(pos_SEM_ExplFN_tp);
                  else 
                    RunTime("Unknown record field selector");
                }
                modmap_59 = Map().Insert(vdm_MOD_Pre__name, tmpVar2_62);
              }
              seqmap_58.ImpOverride(modmap_59);
              rhs_57 = seqmap_58;
            }
            vdm_MOD_res__m = rhs_57;
          }
        }
        {
          Bool cond_66;
          {
            Set var2_68;
            Set unArg_69;
            Set res_s_70;
            {
              Sequence seq_lv_75;
              bool succ_73;
              Bool tsucc_76;
              tsucc_76 = true;
              {
                Set tmpVar_v_74;
                tmpVar_v_74 = vdm_MOD_efns.Dom();
                {
                  Set tmpVar_s_79;
                  {
                    Sequence vdm_MOD_ids;
                    Generic tmpe_85;
                    for (int bb_84 = tmpVar_v_74.First(tmpe_85); bb_84; bb_84 = tmpVar_v_74.Next(tmpe_85)) {
                      Record tmp_80 = tmpe_85;
                      {
                        succ_73 = false;
                        if (tmp_80.IsRecord()) 
                          if (vdm_AS_Name == tmp_80.GetTag()) {
                            Sequence e_l_81;
                            for (int i_82 = 1; i_82 <= tmp_80.Length(); i_82++) 
                              e_l_81.ImpAppend(tmp_80.GetField(i_82));
                            if (succ_73 = 2 == (Int) (e_l_81.Length())) {
                              Generic permI_83;
                              permI_83 = (Generic) (e_l_81.Hd());
                              succ_73 = true;
                              {
                                vdm_MOD_ids = permI_83;
                                succ_73 = true;
                              }
                              permI_83 = (Generic) (e_l_81[2]);
                              if (succ_73) 
                                succ_73 = true;
                            }
                          }
                        if (succ_73) { tmpVar_s_79.Insert(tmp_80); }
                      }
                    }
                  }
                  seq_lv_75.ImpAppend(tmpVar_s_79);
                }
              }
              Set allComb_77 = GenAllComb(seq_lv_75);
              Sequence vdm_MOD_ids;
              Generic tmpe_93;
              for (int bb_92 = allComb_77.First(tmpe_93); bb_92; bb_92 = allComb_77.Next(tmpe_93)) {
                Sequence tmp_87 = tmpe_93;
                {
                  if (succ_73 = 1 == (Int) (tmp_87.Length())) {
                    Record permI_88(vdm_AS_Name, length_AS_Name);
                    permI_88 = (Record) (tmp_87.Hd());
                    succ_73 = true;
                    {
                      succ_73 = false;
                      if (permI_88.IsRecord()) 
                        if (vdm_AS_Name == permI_88.GetTag()) {
                          Sequence e_l_89;
                          for (int i_90 = 1; i_90 <= permI_88.Length(); i_90++) 
                            e_l_89.ImpAppend(permI_88.GetField(i_90));
                          if (succ_73 = 2 == (Int) (e_l_89.Length())) {
                            Generic permI_91;
                            permI_91 = (Generic) (e_l_89.Hd());
                            succ_73 = true;
                            {
                              vdm_MOD_ids = permI_91;
                              succ_73 = true;
                            }
                            permI_91 = (Generic) (e_l_89[2]);
                            if (succ_73) 
                              succ_73 = true;
                          }
                        }
                    }
                  }
                  if (succ_73) {
                    Set elem_71;
                    elem_71 = vdm_MOD_ids.Elems();
                    res_s_70.Insert(elem_71);
                  }
                }
              }
            }
            unArg_69 = res_s_70;
            {
              Set rduset_94;
              Generic tmpe_97;
              for (int bb_96 = unArg_69.First(tmpe_97); bb_96; bb_96 = unArg_69.Next(tmpe_97)) {
                Set e_95 = tmpe_97;
                rduset_94.ImpUnion(e_95);
              }
              var2_68 = rduset_94;
            }
            cond_66 = (Bool) (var2_68.InSet(vdm_MOD_Post__id));
          }
          if (cond_66.GetValue()) {
            Record vdm_MOD_Post__name(vdm_AS_Name, length_AS_Name);
            vdm_MOD_Post__name = Record(vdm_AS_Name, length_AS_Name);
            Sequence tmpVar_100;
            tmpVar_100 = Sequence().ImpAppend(vdm_MOD_Post__id);
            vdm_MOD_Post__name.SetField(1, tmpVar_100);
            vdm_MOD_Post__name.SetField(2, Nil());
            {
              Map rhs_103;
              {
                Map seqmap_104;
                seqmap_104 = vdm_MOD_res__m;
                Map modmap_105;
                {
                  Record tmpVar2_108;
                  {
                    Record tmpRec_109(vdm_SEM_ExplFN, length_SEM_ExplFN);
                    {
                      Map tmp_m_110;
                      tmp_m_110 = vdm_MOD_efns;
                      tmpRec_109 = (Record) (((Map) tmp_m_110)[vdm_MOD_Post__name]);
                    }
                    if (tmpRec_109.Is(vdm_SEM_ExplFN)) 
                      tmpVar2_108 = tmpRec_109.GetField(pos_SEM_ExplFN_tp);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  modmap_105 = Map().Insert(vdm_MOD_Post__name, tmpVar2_108);
                }
                seqmap_104.ImpOverride(modmap_105);
                rhs_103 = seqmap_104;
              }
              vdm_MOD_res__m = rhs_103;
            }
          }
        }
        {
          Map rexpr_112;
          rexpr_112 = vdm_MOD_res__m;
          return rexpr_112;
        }
      }
    }
  }
}

Map vdm_MOD_GetTpInvariant(Record vdm_MOD_name, Map vdm_MOD_efns) {
  bool succ_4;
  Record tmpVal_5(vdm_AS_Name, length_AS_Name);
  tmpVal_5 = vdm_MOD_name;
  Sequence vdm_MOD_fn__id;
  succ_4 = true;
  {
    succ_4 = false;
    if (tmpVal_5.IsRecord()) 
      if (vdm_AS_Name == tmpVal_5.GetTag()) {
        Sequence e_l_6;
        for (int i_7 = 1; i_7 <= tmpVal_5.Length(); i_7++) 
          e_l_6.ImpAppend(tmpVal_5.GetField(i_7));
        if (succ_4 = 2 == (Int) (e_l_6.Length())) {
          Generic permI_8;
          permI_8 = (Generic) (e_l_6.Hd());
          succ_4 = true;
          {
            vdm_MOD_fn__id = permI_8;
            succ_4 = true;
          }
          permI_8 = (Generic) (e_l_6[2]);
          if (succ_4) 
            succ_4 = true;
        }
      }
  }
  if (!succ_4) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Sequence vdm_MOD_Inv__id;
    Sequence var2_12;
    Sequence tmpseq_13;
    tmpseq_13 = vdm_MOD_fn__id;
    var2_12 = (Sequence) (tmpseq_13[((Int) 1).GetValue()]);
    vdm_MOD_Inv__id.ImpConc(Sequence("inv_")).ImpConc(var2_12);
    {
      Record vdm_MOD_Inv__name(vdm_AS_Name, length_AS_Name);
      vdm_MOD_Inv__name = Record(vdm_AS_Name, length_AS_Name);
      Sequence tmpVar_17;
      tmpVar_17 = Sequence().ImpAppend(vdm_MOD_Inv__id);
      vdm_MOD_Inv__name.SetField(1, tmpVar_17);
      vdm_MOD_Inv__name.SetField(2, Nil());
      {
        Map rexpr_20;
        {
          Record tmpVar2_22;
          {
            Record tmpRec_23(vdm_SEM_ExplFN, length_SEM_ExplFN);
            {
              Map tmp_m_24;
              tmp_m_24 = vdm_MOD_efns;
              tmpRec_23 = (Record) (((Map) tmp_m_24)[vdm_MOD_Inv__name]);
            }
            if (tmpRec_23.Is(vdm_SEM_ExplFN)) 
              tmpVar2_22 = tmpRec_23.GetField(pos_SEM_ExplFN_tp);
            else 
              RunTime("Unknown record field selector");
          }
          rexpr_20 = Map().Insert(vdm_MOD_Inv__name, tmpVar2_22);
        }
        return rexpr_20;
      }
    }
  }
}

Bool vdm_MOD_HasFnPrePostCond(Record vdm_MOD_name, Map vdm_MOD_efns, Map vdm_MOD_epfns) {
  Bool cond_5;
  cond_5 = vdm_MOD_IsRealName(vdm_MOD_name);
  if (cond_5.GetValue()) {
    Bool rexpr_159;
    rexpr_159 = (Bool) false;
    return rexpr_159;
  }
  else {
    bool succ_7;
    Record tmpVal_8(vdm_AS_Name, length_AS_Name);
    tmpVal_8 = vdm_MOD_name;
    Sequence vdm_MOD_fn__id;
    succ_7 = true;
    {
      succ_7 = false;
      if (tmpVal_8.IsRecord()) 
        if (vdm_AS_Name == tmpVal_8.GetTag()) {
          Sequence e_l_9;
          for (int i_10 = 1; i_10 <= tmpVal_8.Length(); i_10++) 
            e_l_9.ImpAppend(tmpVal_8.GetField(i_10));
          if (succ_7 = 2 == (Int) (e_l_9.Length())) {
            Generic permI_11;
            permI_11 = (Generic) (e_l_9.Hd());
            succ_7 = true;
            {
              vdm_MOD_fn__id = permI_11;
              succ_7 = true;
            }
            permI_11 = (Generic) (e_l_9[2]);
            if (succ_7) 
              succ_7 = true;
          }
        }
    }
    if (!succ_7) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Bool rexpr_12;
      {
        Bool var1_13;
        Bool var1_15;
        Bool var1_17;
        Sequence var1_19;
        Sequence var2_22;
        Sequence tmpseq_23;
        tmpseq_23 = vdm_MOD_fn__id;
        var2_22 = (Sequence) (tmpseq_23[((Int) 1).GetValue()]);
        var1_19.ImpConc(Sequence("pre_")).ImpConc(var2_22);
        Set var2_20;
        Set unArg_25;
        Set res_s_26;
        {
          Sequence seq_lv_31;
          bool succ_29;
          Bool tsucc_32;
          tsucc_32 = true;
          {
            Set tmpVar_v_30;
            tmpVar_v_30 = vdm_MOD_efns.Dom();
            {
              Set tmpVar_s_35;
              {
                Sequence vdm_MOD_ids;
                Generic tmpe_41;
                for (int bb_40 = tmpVar_v_30.First(tmpe_41); bb_40; bb_40 = tmpVar_v_30.Next(tmpe_41)) {
                  Record tmp_36 = tmpe_41;
                  {
                    succ_29 = false;
                    if (tmp_36.IsRecord()) 
                      if (vdm_AS_Name == tmp_36.GetTag()) {
                        Sequence e_l_37;
                        for (int i_38 = 1; i_38 <= tmp_36.Length(); i_38++) 
                          e_l_37.ImpAppend(tmp_36.GetField(i_38));
                        if (succ_29 = 2 == (Int) (e_l_37.Length())) {
                          Generic permI_39;
                          permI_39 = (Generic) (e_l_37.Hd());
                          succ_29 = true;
                          {
                            vdm_MOD_ids = permI_39;
                            succ_29 = true;
                          }
                          permI_39 = (Generic) (e_l_37[2]);
                          if (succ_29) 
                            succ_29 = true;
                        }
                      }
                    if (succ_29) { tmpVar_s_35.Insert(tmp_36); }
                  }
                }
              }
              seq_lv_31.ImpAppend(tmpVar_s_35);
            }
          }
          Set allComb_33 = GenAllComb(seq_lv_31);
          Sequence vdm_MOD_ids;
          Generic tmpe_49;
          for (int bb_48 = allComb_33.First(tmpe_49); bb_48; bb_48 = allComb_33.Next(tmpe_49)) {
            Sequence tmp_43 = tmpe_49;
            {
              if (succ_29 = 1 == (Int) (tmp_43.Length())) {
                Record permI_44(vdm_AS_Name, length_AS_Name);
                permI_44 = (Record) (tmp_43.Hd());
                succ_29 = true;
                {
                  succ_29 = false;
                  if (permI_44.IsRecord()) 
                    if (vdm_AS_Name == permI_44.GetTag()) {
                      Sequence e_l_45;
                      for (int i_46 = 1; i_46 <= permI_44.Length(); i_46++) 
                        e_l_45.ImpAppend(permI_44.GetField(i_46));
                      if (succ_29 = 2 == (Int) (e_l_45.Length())) {
                        Generic permI_47;
                        permI_47 = (Generic) (e_l_45.Hd());
                        succ_29 = true;
                        {
                          vdm_MOD_ids = permI_47;
                          succ_29 = true;
                        }
                        permI_47 = (Generic) (e_l_45[2]);
                        if (succ_29) 
                          succ_29 = true;
                      }
                    }
                }
              }
              if (succ_29) {
                Set elem_27;
                elem_27 = vdm_MOD_ids.Elems();
                res_s_26.Insert(elem_27);
              }
            }
          }
        }
        unArg_25 = res_s_26;
        {
          Set rduset_50;
          Generic tmpe_53;
          for (int bb_52 = unArg_25.First(tmpe_53); bb_52; bb_52 = unArg_25.Next(tmpe_53)) {
            Set e_51 = tmpe_53;
            rduset_50.ImpUnion(e_51);
          }
          var2_20 = rduset_50;
        }
        var1_17 = (Bool) (var2_20.InSet(var1_19));
        if (!(var1_15 = var1_17).GetValue()) {
          Bool var2_18;
          Sequence var1_54;
          Sequence var2_57;
          Sequence tmpseq_58;
          tmpseq_58 = vdm_MOD_fn__id;
          var2_57 = (Sequence) (tmpseq_58[((Int) 1).GetValue()]);
          var1_54.ImpConc(Sequence("post_")).ImpConc(var2_57);
          Set var2_55;
          Set unArg_60;
          Set res_s_61;
          {
            Sequence seq_lv_66;
            bool succ_64;
            Bool tsucc_67;
            tsucc_67 = true;
            {
              Set tmpVar_v_65;
              tmpVar_v_65 = vdm_MOD_efns.Dom();
              {
                Set tmpVar_s_70;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_76;
                  for (int bb_75 = tmpVar_v_65.First(tmpe_76); bb_75; bb_75 = tmpVar_v_65.Next(tmpe_76)) {
                    Record tmp_71 = tmpe_76;
                    {
                      succ_64 = false;
                      if (tmp_71.IsRecord()) 
                        if (vdm_AS_Name == tmp_71.GetTag()) {
                          Sequence e_l_72;
                          for (int i_73 = 1; i_73 <= tmp_71.Length(); i_73++) 
                            e_l_72.ImpAppend(tmp_71.GetField(i_73));
                          if (succ_64 = 2 == (Int) (e_l_72.Length())) {
                            Generic permI_74;
                            permI_74 = (Generic) (e_l_72.Hd());
                            succ_64 = true;
                            {
                              vdm_MOD_ids = permI_74;
                              succ_64 = true;
                            }
                            permI_74 = (Generic) (e_l_72[2]);
                            if (succ_64) 
                              succ_64 = true;
                          }
                        }
                      if (succ_64) { tmpVar_s_70.Insert(tmp_71); }
                    }
                  }
                }
                seq_lv_66.ImpAppend(tmpVar_s_70);
              }
            }
            Set allComb_68 = GenAllComb(seq_lv_66);
            Sequence vdm_MOD_ids;
            Generic tmpe_84;
            for (int bb_83 = allComb_68.First(tmpe_84); bb_83; bb_83 = allComb_68.Next(tmpe_84)) {
              Sequence tmp_78 = tmpe_84;
              {
                if (succ_64 = 1 == (Int) (tmp_78.Length())) {
                  Record permI_79(vdm_AS_Name, length_AS_Name);
                  permI_79 = (Record) (tmp_78.Hd());
                  succ_64 = true;
                  {
                    succ_64 = false;
                    if (permI_79.IsRecord()) 
                      if (vdm_AS_Name == permI_79.GetTag()) {
                        Sequence e_l_80;
                        for (int i_81 = 1; i_81 <= permI_79.Length(); i_81++) 
                          e_l_80.ImpAppend(permI_79.GetField(i_81));
                        if (succ_64 = 2 == (Int) (e_l_80.Length())) {
                          Generic permI_82;
                          permI_82 = (Generic) (e_l_80.Hd());
                          succ_64 = true;
                          {
                            vdm_MOD_ids = permI_82;
                            succ_64 = true;
                          }
                          permI_82 = (Generic) (e_l_80[2]);
                          if (succ_64) 
                            succ_64 = true;
                        }
                      }
                  }
                }
                if (succ_64) {
                  Set elem_62;
                  elem_62 = vdm_MOD_ids.Elems();
                  res_s_61.Insert(elem_62);
                }
              }
            }
          }
          unArg_60 = res_s_61;
          {
            Set rduset_85;
            Generic tmpe_88;
            for (int bb_87 = unArg_60.First(tmpe_88); bb_87; bb_87 = unArg_60.Next(tmpe_88)) {
              Set e_86 = tmpe_88;
              rduset_85.ImpUnion(e_86);
            }
            var2_55 = rduset_85;
          }
          var2_18 = (Bool) (var2_55.InSet(var1_54));
          var1_15 = var2_18;
        }
        if (!(var1_13 = var1_15).GetValue()) {
          Bool var2_16;
          Sequence var1_89;
          Sequence var2_92;
          Sequence tmpseq_93;
          tmpseq_93 = vdm_MOD_fn__id;
          var2_92 = (Sequence) (tmpseq_93[((Int) 1).GetValue()]);
          var1_89.ImpConc(Sequence("pre_")).ImpConc(var2_92);
          Set var2_90;
          Set unArg_95;
          Set res_s_96;
          {
            Sequence seq_lv_101;
            bool succ_99;
            Bool tsucc_102;
            tsucc_102 = true;
            {
              Set tmpVar_v_100;
              tmpVar_v_100 = vdm_MOD_epfns.Dom();
              {
                Set tmpVar_s_105;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_111;
                  for (int bb_110 = tmpVar_v_100.First(tmpe_111); bb_110; bb_110 = tmpVar_v_100.Next(tmpe_111)) {
                    Record tmp_106 = tmpe_111;
                    {
                      succ_99 = false;
                      if (tmp_106.IsRecord()) 
                        if (vdm_AS_Name == tmp_106.GetTag()) {
                          Sequence e_l_107;
                          for (int i_108 = 1; i_108 <= tmp_106.Length(); i_108++) 
                            e_l_107.ImpAppend(tmp_106.GetField(i_108));
                          if (succ_99 = 2 == (Int) (e_l_107.Length())) {
                            Generic permI_109;
                            permI_109 = (Generic) (e_l_107.Hd());
                            succ_99 = true;
                            {
                              vdm_MOD_ids = permI_109;
                              succ_99 = true;
                            }
                            permI_109 = (Generic) (e_l_107[2]);
                            if (succ_99) 
                              succ_99 = true;
                          }
                        }
                      if (succ_99) { tmpVar_s_105.Insert(tmp_106); }
                    }
                  }
                }
                seq_lv_101.ImpAppend(tmpVar_s_105);
              }
            }
            Set allComb_103 = GenAllComb(seq_lv_101);
            Sequence vdm_MOD_ids;
            Generic tmpe_119;
            for (int bb_118 = allComb_103.First(tmpe_119); bb_118; bb_118 = allComb_103.Next(tmpe_119)) {
              Sequence tmp_113 = tmpe_119;
              {
                if (succ_99 = 1 == (Int) (tmp_113.Length())) {
                  Record permI_114(vdm_AS_Name, length_AS_Name);
                  permI_114 = (Record) (tmp_113.Hd());
                  succ_99 = true;
                  {
                    succ_99 = false;
                    if (permI_114.IsRecord()) 
                      if (vdm_AS_Name == permI_114.GetTag()) {
                        Sequence e_l_115;
                        for (int i_116 = 1; i_116 <= permI_114.Length(); i_116++) 
                          e_l_115.ImpAppend(permI_114.GetField(i_116));
                        if (succ_99 = 2 == (Int) (e_l_115.Length())) {
                          Generic permI_117;
                          permI_117 = (Generic) (e_l_115.Hd());
                          succ_99 = true;
                          {
                            vdm_MOD_ids = permI_117;
                            succ_99 = true;
                          }
                          permI_117 = (Generic) (e_l_115[2]);
                          if (succ_99) 
                            succ_99 = true;
                        }
                      }
                  }
                }
                if (succ_99) {
                  Set elem_97;
                  elem_97 = vdm_MOD_ids.Elems();
                  res_s_96.Insert(elem_97);
                }
              }
            }
          }
          unArg_95 = res_s_96;
          {
            Set rduset_120;
            Generic tmpe_123;
            for (int bb_122 = unArg_95.First(tmpe_123); bb_122; bb_122 = unArg_95.Next(tmpe_123)) {
              Set e_121 = tmpe_123;
              rduset_120.ImpUnion(e_121);
            }
            var2_90 = rduset_120;
          }
          var2_16 = (Bool) (var2_90.InSet(var1_89));
          var1_13 = var2_16;
        }
        if (!(rexpr_12 = var1_13).GetValue()) {
          Bool var2_14;
          Sequence var1_124;
          Sequence var2_127;
          Sequence tmpseq_128;
          tmpseq_128 = vdm_MOD_fn__id;
          var2_127 = (Sequence) (tmpseq_128[((Int) 1).GetValue()]);
          var1_124.ImpConc(Sequence("post_")).ImpConc(var2_127);
          Set var2_125;
          Set unArg_130;
          Set res_s_131;
          {
            Sequence seq_lv_136;
            bool succ_134;
            Bool tsucc_137;
            tsucc_137 = true;
            {
              Set tmpVar_v_135;
              tmpVar_v_135 = vdm_MOD_epfns.Dom();
              {
                Set tmpVar_s_140;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_146;
                  for (int bb_145 = tmpVar_v_135.First(tmpe_146); bb_145; bb_145 = tmpVar_v_135.Next(tmpe_146)) {
                    Record tmp_141 = tmpe_146;
                    {
                      succ_134 = false;
                      if (tmp_141.IsRecord()) 
                        if (vdm_AS_Name == tmp_141.GetTag()) {
                          Sequence e_l_142;
                          for (int i_143 = 1; i_143 <= tmp_141.Length(); i_143++) 
                            e_l_142.ImpAppend(tmp_141.GetField(i_143));
                          if (succ_134 = 2 == (Int) (e_l_142.Length())) {
                            Generic permI_144;
                            permI_144 = (Generic) (e_l_142.Hd());
                            succ_134 = true;
                            {
                              vdm_MOD_ids = permI_144;
                              succ_134 = true;
                            }
                            permI_144 = (Generic) (e_l_142[2]);
                            if (succ_134) 
                              succ_134 = true;
                          }
                        }
                      if (succ_134) { tmpVar_s_140.Insert(tmp_141); }
                    }
                  }
                }
                seq_lv_136.ImpAppend(tmpVar_s_140);
              }
            }
            Set allComb_138 = GenAllComb(seq_lv_136);
            Sequence vdm_MOD_ids;
            Generic tmpe_154;
            for (int bb_153 = allComb_138.First(tmpe_154); bb_153; bb_153 = allComb_138.Next(tmpe_154)) {
              Sequence tmp_148 = tmpe_154;
              {
                if (succ_134 = 1 == (Int) (tmp_148.Length())) {
                  Record permI_149(vdm_AS_Name, length_AS_Name);
                  permI_149 = (Record) (tmp_148.Hd());
                  succ_134 = true;
                  {
                    succ_134 = false;
                    if (permI_149.IsRecord()) 
                      if (vdm_AS_Name == permI_149.GetTag()) {
                        Sequence e_l_150;
                        for (int i_151 = 1; i_151 <= permI_149.Length(); i_151++) 
                          e_l_150.ImpAppend(permI_149.GetField(i_151));
                        if (succ_134 = 2 == (Int) (e_l_150.Length())) {
                          Generic permI_152;
                          permI_152 = (Generic) (e_l_150.Hd());
                          succ_134 = true;
                          {
                            vdm_MOD_ids = permI_152;
                            succ_134 = true;
                          }
                          permI_152 = (Generic) (e_l_150[2]);
                          if (succ_134) 
                            succ_134 = true;
                        }
                      }
                  }
                }
                if (succ_134) {
                  Set elem_132;
                  elem_132 = vdm_MOD_ids.Elems();
                  res_s_131.Insert(elem_132);
                }
              }
            }
          }
          unArg_130 = res_s_131;
          {
            Set rduset_155;
            Generic tmpe_158;
            for (int bb_157 = unArg_130.First(tmpe_158); bb_157; bb_157 = unArg_130.Next(tmpe_158)) {
              Set e_156 = tmpe_158;
              rduset_155.ImpUnion(e_156);
            }
            var2_125 = rduset_155;
          }
          var2_14 = (Bool) (var2_125.InSet(var1_124));
          rexpr_12 = var2_14;
        }
      }
      return rexpr_12;
    }
  }
}

Bool vdm_MOD_HasOpPrePostCond(Record vdm_MOD_name, Map vdm_MOD_efns) {
  Bool cond_4;
  cond_4 = vdm_MOD_IsRealName(vdm_MOD_name);
  if (cond_4.GetValue()) {
    Bool rexpr_84;
    rexpr_84 = (Bool) false;
    return rexpr_84;
  }
  else {
    bool succ_6;
    Record tmpVal_7(vdm_AS_Name, length_AS_Name);
    tmpVal_7 = vdm_MOD_name;
    Sequence vdm_MOD_fn__id;
    succ_6 = true;
    {
      succ_6 = false;
      if (tmpVal_7.IsRecord()) 
        if (vdm_AS_Name == tmpVal_7.GetTag()) {
          Sequence e_l_8;
          for (int i_9 = 1; i_9 <= tmpVal_7.Length(); i_9++) 
            e_l_8.ImpAppend(tmpVal_7.GetField(i_9));
          if (succ_6 = 2 == (Int) (e_l_8.Length())) {
            Generic permI_10;
            permI_10 = (Generic) (e_l_8.Hd());
            succ_6 = true;
            {
              vdm_MOD_fn__id = permI_10;
              succ_6 = true;
            }
            permI_10 = (Generic) (e_l_8[2]);
            if (succ_6) 
              succ_6 = true;
          }
        }
    }
    if (!succ_6) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Bool rexpr_11;
      {
        Bool var1_12;
        Sequence var1_14;
        Sequence var2_17;
        Sequence tmpseq_18;
        tmpseq_18 = vdm_MOD_fn__id;
        var2_17 = (Sequence) (tmpseq_18[((Int) 1).GetValue()]);
        var1_14.ImpConc(Sequence("pre_")).ImpConc(var2_17);
        Set var2_15;
        Set unArg_20;
        Set res_s_21;
        {
          Sequence seq_lv_26;
          bool succ_24;
          Bool tsucc_27;
          tsucc_27 = true;
          {
            Set tmpVar_v_25;
            tmpVar_v_25 = vdm_MOD_efns.Dom();
            {
              Set tmpVar_s_30;
              {
                Sequence vdm_MOD_ids;
                Generic tmpe_36;
                for (int bb_35 = tmpVar_v_25.First(tmpe_36); bb_35; bb_35 = tmpVar_v_25.Next(tmpe_36)) {
                  Record tmp_31 = tmpe_36;
                  {
                    succ_24 = false;
                    if (tmp_31.IsRecord()) 
                      if (vdm_AS_Name == tmp_31.GetTag()) {
                        Sequence e_l_32;
                        for (int i_33 = 1; i_33 <= tmp_31.Length(); i_33++) 
                          e_l_32.ImpAppend(tmp_31.GetField(i_33));
                        if (succ_24 = 2 == (Int) (e_l_32.Length())) {
                          Generic permI_34;
                          permI_34 = (Generic) (e_l_32.Hd());
                          succ_24 = true;
                          {
                            vdm_MOD_ids = permI_34;
                            succ_24 = true;
                          }
                          permI_34 = (Generic) (e_l_32[2]);
                          if (succ_24) 
                            succ_24 = true;
                        }
                      }
                    if (succ_24) { tmpVar_s_30.Insert(tmp_31); }
                  }
                }
              }
              seq_lv_26.ImpAppend(tmpVar_s_30);
            }
          }
          Set allComb_28 = GenAllComb(seq_lv_26);
          Sequence vdm_MOD_ids;
          Generic tmpe_44;
          for (int bb_43 = allComb_28.First(tmpe_44); bb_43; bb_43 = allComb_28.Next(tmpe_44)) {
            Sequence tmp_38 = tmpe_44;
            {
              if (succ_24 = 1 == (Int) (tmp_38.Length())) {
                Record permI_39(vdm_AS_Name, length_AS_Name);
                permI_39 = (Record) (tmp_38.Hd());
                succ_24 = true;
                {
                  succ_24 = false;
                  if (permI_39.IsRecord()) 
                    if (vdm_AS_Name == permI_39.GetTag()) {
                      Sequence e_l_40;
                      for (int i_41 = 1; i_41 <= permI_39.Length(); i_41++) 
                        e_l_40.ImpAppend(permI_39.GetField(i_41));
                      if (succ_24 = 2 == (Int) (e_l_40.Length())) {
                        Generic permI_42;
                        permI_42 = (Generic) (e_l_40.Hd());
                        succ_24 = true;
                        {
                          vdm_MOD_ids = permI_42;
                          succ_24 = true;
                        }
                        permI_42 = (Generic) (e_l_40[2]);
                        if (succ_24) 
                          succ_24 = true;
                      }
                    }
                }
              }
              if (succ_24) {
                Set elem_22;
                elem_22 = vdm_MOD_ids.Elems();
                res_s_21.Insert(elem_22);
              }
            }
          }
        }
        unArg_20 = res_s_21;
        {
          Set rduset_45;
          Generic tmpe_48;
          for (int bb_47 = unArg_20.First(tmpe_48); bb_47; bb_47 = unArg_20.Next(tmpe_48)) {
            Set e_46 = tmpe_48;
            rduset_45.ImpUnion(e_46);
          }
          var2_15 = rduset_45;
        }
        var1_12 = (Bool) (var2_15.InSet(var1_14));
        if (!(rexpr_11 = var1_12).GetValue()) {
          Bool var2_13;
          Sequence var1_49;
          Sequence var2_52;
          Sequence tmpseq_53;
          tmpseq_53 = vdm_MOD_fn__id;
          var2_52 = (Sequence) (tmpseq_53[((Int) 1).GetValue()]);
          var1_49.ImpConc(Sequence("post_")).ImpConc(var2_52);
          Set var2_50;
          Set unArg_55;
          Set res_s_56;
          {
            Sequence seq_lv_61;
            bool succ_59;
            Bool tsucc_62;
            tsucc_62 = true;
            {
              Set tmpVar_v_60;
              tmpVar_v_60 = vdm_MOD_efns.Dom();
              {
                Set tmpVar_s_65;
                {
                  Sequence vdm_MOD_ids;
                  Generic tmpe_71;
                  for (int bb_70 = tmpVar_v_60.First(tmpe_71); bb_70; bb_70 = tmpVar_v_60.Next(tmpe_71)) {
                    Record tmp_66 = tmpe_71;
                    {
                      succ_59 = false;
                      if (tmp_66.IsRecord()) 
                        if (vdm_AS_Name == tmp_66.GetTag()) {
                          Sequence e_l_67;
                          for (int i_68 = 1; i_68 <= tmp_66.Length(); i_68++) 
                            e_l_67.ImpAppend(tmp_66.GetField(i_68));
                          if (succ_59 = 2 == (Int) (e_l_67.Length())) {
                            Generic permI_69;
                            permI_69 = (Generic) (e_l_67.Hd());
                            succ_59 = true;
                            {
                              vdm_MOD_ids = permI_69;
                              succ_59 = true;
                            }
                            permI_69 = (Generic) (e_l_67[2]);
                            if (succ_59) 
                              succ_59 = true;
                          }
                        }
                      if (succ_59) { tmpVar_s_65.Insert(tmp_66); }
                    }
                  }
                }
                seq_lv_61.ImpAppend(tmpVar_s_65);
              }
            }
            Set allComb_63 = GenAllComb(seq_lv_61);
            Sequence vdm_MOD_ids;
            Generic tmpe_79;
            for (int bb_78 = allComb_63.First(tmpe_79); bb_78; bb_78 = allComb_63.Next(tmpe_79)) {
              Sequence tmp_73 = tmpe_79;
              {
                if (succ_59 = 1 == (Int) (tmp_73.Length())) {
                  Record permI_74(vdm_AS_Name, length_AS_Name);
                  permI_74 = (Record) (tmp_73.Hd());
                  succ_59 = true;
                  {
                    succ_59 = false;
                    if (permI_74.IsRecord()) 
                      if (vdm_AS_Name == permI_74.GetTag()) {
                        Sequence e_l_75;
                        for (int i_76 = 1; i_76 <= permI_74.Length(); i_76++) 
                          e_l_75.ImpAppend(permI_74.GetField(i_76));
                        if (succ_59 = 2 == (Int) (e_l_75.Length())) {
                          Generic permI_77;
                          permI_77 = (Generic) (e_l_75.Hd());
                          succ_59 = true;
                          {
                            vdm_MOD_ids = permI_77;
                            succ_59 = true;
                          }
                          permI_77 = (Generic) (e_l_75[2]);
                          if (succ_59) 
                            succ_59 = true;
                        }
                      }
                  }
                }
                if (succ_59) {
                  Set elem_57;
                  elem_57 = vdm_MOD_ids.Elems();
                  res_s_56.Insert(elem_57);
                }
              }
            }
          }
          unArg_55 = res_s_56;
          {
            Set rduset_80;
            Generic tmpe_83;
            for (int bb_82 = unArg_55.First(tmpe_83); bb_82; bb_82 = unArg_55.Next(tmpe_83)) {
              Set e_81 = tmpe_83;
              rduset_80.ImpUnion(e_81);
            }
            var2_50 = rduset_80;
          }
          var2_13 = (Bool) (var2_50.InSet(var1_49));
          rexpr_11 = var2_13;
        }
      }
      return rexpr_11;
    }
  }
}

Bool vdm_MOD_HasTpInvariant(Record vdm_MOD_name, Map vdm_MOD_efns) {
  Bool cond_4;
  cond_4 = vdm_MOD_IsRealName(vdm_MOD_name);
  if (cond_4.GetValue()) {
    Bool rexpr_47;
    rexpr_47 = (Bool) false;
    return rexpr_47;
  }
  else {
    bool succ_6;
    Record tmpVal_7(vdm_AS_Name, length_AS_Name);
    tmpVal_7 = vdm_MOD_name;
    Sequence vdm_MOD_fn__id;
    succ_6 = true;
    {
      succ_6 = false;
      if (tmpVal_7.IsRecord()) 
        if (vdm_AS_Name == tmpVal_7.GetTag()) {
          Sequence e_l_8;
          for (int i_9 = 1; i_9 <= tmpVal_7.Length(); i_9++) 
            e_l_8.ImpAppend(tmpVal_7.GetField(i_9));
          if (succ_6 = 2 == (Int) (e_l_8.Length())) {
            Generic permI_10;
            permI_10 = (Generic) (e_l_8.Hd());
            succ_6 = true;
            {
              vdm_MOD_fn__id = permI_10;
              succ_6 = true;
            }
            permI_10 = (Generic) (e_l_8[2]);
            if (succ_6) 
              succ_6 = true;
          }
        }
    }
    if (!succ_6) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Bool rexpr_11;
      {
        Sequence var1_12;
        Sequence var2_15;
        Sequence tmpseq_16;
        tmpseq_16 = vdm_MOD_fn__id;
        var2_15 = (Sequence) (tmpseq_16[((Int) 1).GetValue()]);
        var1_12.ImpConc(Sequence("inv_")).ImpConc(var2_15);
        Set var2_13;
        Set unArg_18;
        Set res_s_19;
        {
          Sequence seq_lv_24;
          bool succ_22;
          Bool tsucc_25;
          tsucc_25 = true;
          {
            Set tmpVar_v_23;
            tmpVar_v_23 = vdm_MOD_efns.Dom();
            {
              Set tmpVar_s_28;
              {
                Sequence vdm_MOD_ids;
                Generic tmpe_34;
                for (int bb_33 = tmpVar_v_23.First(tmpe_34); bb_33; bb_33 = tmpVar_v_23.Next(tmpe_34)) {
                  Record tmp_29 = tmpe_34;
                  {
                    succ_22 = false;
                    if (tmp_29.IsRecord()) 
                      if (vdm_AS_Name == tmp_29.GetTag()) {
                        Sequence e_l_30;
                        for (int i_31 = 1; i_31 <= tmp_29.Length(); i_31++) 
                          e_l_30.ImpAppend(tmp_29.GetField(i_31));
                        if (succ_22 = 2 == (Int) (e_l_30.Length())) {
                          Generic permI_32;
                          permI_32 = (Generic) (e_l_30.Hd());
                          succ_22 = true;
                          {
                            vdm_MOD_ids = permI_32;
                            succ_22 = true;
                          }
                          permI_32 = (Generic) (e_l_30[2]);
                          if (succ_22) 
                            succ_22 = true;
                        }
                      }
                    if (succ_22) { tmpVar_s_28.Insert(tmp_29); }
                  }
                }
              }
              seq_lv_24.ImpAppend(tmpVar_s_28);
            }
          }
          Set allComb_26 = GenAllComb(seq_lv_24);
          Sequence vdm_MOD_ids;
          Generic tmpe_42;
          for (int bb_41 = allComb_26.First(tmpe_42); bb_41; bb_41 = allComb_26.Next(tmpe_42)) {
            Sequence tmp_36 = tmpe_42;
            {
              if (succ_22 = 1 == (Int) (tmp_36.Length())) {
                Record permI_37(vdm_AS_Name, length_AS_Name);
                permI_37 = (Record) (tmp_36.Hd());
                succ_22 = true;
                {
                  succ_22 = false;
                  if (permI_37.IsRecord()) 
                    if (vdm_AS_Name == permI_37.GetTag()) {
                      Sequence e_l_38;
                      for (int i_39 = 1; i_39 <= permI_37.Length(); i_39++) 
                        e_l_38.ImpAppend(permI_37.GetField(i_39));
                      if (succ_22 = 2 == (Int) (e_l_38.Length())) {
                        Generic permI_40;
                        permI_40 = (Generic) (e_l_38.Hd());
                        succ_22 = true;
                        {
                          vdm_MOD_ids = permI_40;
                          succ_22 = true;
                        }
                        permI_40 = (Generic) (e_l_38[2]);
                        if (succ_22) 
                          succ_22 = true;
                      }
                    }
                }
              }
              if (succ_22) {
                Set elem_20;
                elem_20 = vdm_MOD_ids.Elems();
                res_s_19.Insert(elem_20);
              }
            }
          }
        }
        unArg_18 = res_s_19;
        {
          Set rduset_43;
          Generic tmpe_46;
          for (int bb_45 = unArg_18.First(tmpe_46); bb_45; bb_45 = unArg_18.Next(tmpe_46)) {
            Set e_44 = tmpe_46;
            rduset_43.ImpUnion(e_44);
          }
          var2_13 = rduset_43;
        }
        rexpr_11 = (Bool) (var2_13.InSet(var1_12));
      }
      return rexpr_11;
    }
  }
}

Map vdm_MOD_InitGS(Generic vdm_MOD_sd) {
  Bool cond_3;
  cond_3 = (Bool) (vdm_MOD_sd == Nil());
  if (cond_3.GetValue()) {
    Map rexpr_261;
    rexpr_261 = Map();
    return rexpr_261;
  }
  else {
    bool succ_6;
    Generic tmpVal_7;
    tmpVal_7 = vdm_MOD_sd;
    Sequence vdm_MOD_fields__lv;
    Generic vdm_MOD_init__s;
    Record vdm_MOD_name(vdm_AS_Name, length_AS_Name);
    succ_6 = true;
    {
      succ_6 = false;
      if (tmpVal_7.IsRecord()) 
        if (vdm_AS_StateDef == ((Record) tmpVal_7).GetTag()) {
          Sequence e_l_8;
          for (int i_9 = 1; i_9 <= ((Record) tmpVal_7).Length(); i_9++) 
            e_l_8.ImpAppend(((Record) tmpVal_7).GetField(i_9));
          if (succ_6 = 3 == (Int) (e_l_8.Length())) {
            Generic permI_10;
            permI_10 = (Generic) (e_l_8.Hd());
            succ_6 = true;
            {
              succ_6 = false;
              if (permI_10.IsRecord()) 
                if (vdm_AS_CompositeType == ((Record) permI_10).GetTag()) {
                  Sequence e_l_11;
                  for (int i_12 = 1; i_12 <= ((Record) permI_10).Length(); i_12++) 
                    e_l_11.ImpAppend(((Record) permI_10).GetField(i_12));
                  if (succ_6 = 2 == (Int) (e_l_11.Length())) {
                    Generic permI_13;
                    permI_13 = (Generic) (e_l_11.Hd());
                    succ_6 = true;
                    {
                      vdm_MOD_name = permI_13;
                      succ_6 = true;
                    }
                    permI_13 = (Generic) (e_l_11[2]);
                    if (succ_6) {
                      vdm_MOD_fields__lv = permI_13;
                      succ_6 = true;
                    }
                  }
                }
            }
            permI_10 = (Generic) (e_l_8[2]);
            if (succ_6) 
              succ_6 = true;
            permI_10 = (Generic) (e_l_8[3]);
            if (succ_6) {
              vdm_MOD_init__s = permI_10;
              succ_6 = true;
            }
          }
        }
    }
    if (!succ_6) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Bool cond_14;
      cond_14 = (Bool) (vdm_MOD_init__s == Nil());
      if (cond_14.GetValue()) {
        Map rexpr_231;
        {
          Map res_m_232;
          Generic md_233;
          Record mr_234(vdm_GLOBAL_State, length_GLOBAL_State);
          {
            Sequence seq_lv_245;
            bool succ_243;
            Bool tsucc_246;
            tsucc_246 = true;
            {
              Set tmpVar_v_244;
              {
                Set riseq_249;
                int max_250 = (Int) (vdm_MOD_fields__lv.Length());
                for (int i_251 = 1; i_251 <= max_250; i_251++) 
                  riseq_249.Insert((Int) i_251);
                tmpVar_v_244 = riseq_249;
              }
{ seq_lv_245.ImpAppend(tmpVar_v_244); }
            }
            Set allComb_247 = GenAllComb(seq_lv_245);
            Int vdm_MOD_i;
            Generic tmpe_260;
            for (int bb_259 = allComb_247.First(tmpe_260); bb_259; bb_259 = allComb_247.Next(tmpe_260)) {
              Sequence tmp_257 = tmpe_260;
              {
                if (succ_243 = 1 == (Int) (tmp_257.Length())) {
                  Int permI_258;
                  permI_258 = (Int) (tmp_257.Hd());
                  succ_243 = true;
                  {
                    vdm_MOD_i = permI_258;
                    succ_243 = true;
                  }
                }
                if (succ_243) {
                  Record tmpRec_235(vdm_AS_Field, length_AS_Field);
                  {
                    Sequence tmpseq_236;
                    tmpseq_236 = vdm_MOD_fields__lv;
                    tmpRec_235 = (Record) (tmpseq_236[vdm_MOD_i.GetValue()]);
                  }
                  if (tmpRec_235.Is(vdm_AS_Field)) 
                    md_233 = tmpRec_235.GetField(pos_AS_Field_sel);
                  else 
                    RunTime("Unknown record field selector");
                  {
                    mr_234 = Record(vdm_GLOBAL_State, length_GLOBAL_State);
                    mr_234.SetField(1, Record(vdm_SEM_UNDEF, length_SEM_UNDEF));
                    Record tmpVar_239;
                    {
                      Record tmpRec_240(vdm_AS_Field, length_AS_Field);
                      {
                        Sequence tmpseq_241;
                        tmpseq_241 = vdm_MOD_fields__lv;
                        tmpRec_240 = (Record) (tmpseq_241[vdm_MOD_i.GetValue()]);
                      }
                      if (tmpRec_240.Is(vdm_AS_Field)) 
                        tmpVar_239 = tmpRec_240.GetField(pos_AS_Field_type);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    mr_234.SetField(2, tmpVar_239);
                  }
                  res_m_232.Insert(md_233, mr_234);
                }
              }
            }
          }
          rexpr_231 = res_m_232;
        }
        return rexpr_231;
      }
      else {
        bool succ_17;
        Generic tmpVal_18;
        tmpVal_18 = vdm_MOD_init__s;
        Record vdm_MOD_init__e;
        Record vdm_MOD_init__p;
        succ_17 = true;
        {
          succ_17 = false;
          if (tmpVal_18.IsTuple()) {
            Sequence e_l_19;
            for (int i_20 = 1; i_20 <= ((Tuple) tmpVal_18).Length(); i_20++) 
              e_l_19.ImpAppend(((Tuple) tmpVal_18).GetField(i_20));
            if (succ_17 = 2 == (Int) (e_l_19.Length())) {
              Record permI_21;
              permI_21 = (Record) (e_l_19.Hd());
              succ_17 = true;
              {
                vdm_MOD_init__p = permI_21;
                succ_17 = true;
              }
              permI_21 = (Record) (e_l_19[2]);
              if (succ_17) {
                vdm_MOD_init__e = permI_21;
                succ_17 = true;
              }
            }
          }
        }
        if (!succ_17) 
          RunTime("Pattern match did not succeed in value definition");
        {
          Bool cond_22;
          {
            Record argTmp_23;
            argTmp_23 = vdm_MOD_init__e;
            if (argTmp_23.IsRecord()) 
              cond_22 = vdm_AS_BinaryExpr == argTmp_23.GetTag();
            else 
              cond_22 = false;
          }
          if (cond_22.GetValue()) {
            Bool cond_114;
            {
              Generic var1_115;
              Record tmpRec_117;
              tmpRec_117 = vdm_MOD_init__e;
              if (((Record) tmpRec_117).Is(vdm_AS_PrefixExpr)) 
                var1_115 = ((Record) tmpRec_117).GetField(pos_AS_PrefixExpr_opr);
              else 
                if (((Record) tmpRec_117).Is(vdm_AS_BinaryExpr)) 
                  var1_115 = ((Record) tmpRec_117).GetField(pos_AS_BinaryExpr_opr);
                else 
                  RunTime("Unknown record field selector");
              cond_114 = (Bool) (!(var1_115 == (Quote) "EQ"));
            }
            if (cond_114.GetValue()) 
              RunTime("Can not evaluate an error statement");
            {
              Bool cond_118;
              {
                Bool unArg_119;
                Record argTmp_120;
                {
                  Record tmpRec_121;
                  tmpRec_121 = vdm_MOD_init__e;
                  if (((Record) tmpRec_121).Is(vdm_AS_BinaryExpr)) 
                    argTmp_120 = ((Record) tmpRec_121).GetField(pos_AS_BinaryExpr_left);
                  else 
                    RunTime("Unknown record field selector");
                }
                if (argTmp_120.IsRecord()) 
                  unArg_119 = vdm_AS_Name == argTmp_120.GetTag();
                else 
                  unArg_119 = false;
                cond_118 = (Bool) (!unArg_119.GetValue());
              }
              if (cond_118.GetValue()) 
                RunTime("Can not evaluate an error statement");
            }
            {
              bool succ_122;
              Record tmpVal_123;
              {
                Record tmpRec_124;
                tmpRec_124 = vdm_MOD_init__e;
                if (((Record) tmpRec_124).Is(vdm_AS_BinaryExpr)) 
                  tmpVal_123 = ((Record) tmpRec_124).GetField(pos_AS_BinaryExpr_left);
                else 
                  RunTime("Unknown record field selector");
              }
              Sequence vdm_MOD_init__id;
              succ_122 = true;
              {
                succ_122 = false;
                if (tmpVal_123.IsRecord()) 
                  if (vdm_AS_Name == ((Record) tmpVal_123).GetTag()) {
                    Sequence e_l_125;
                    for (int i_126 = 1; i_126 <= ((Record) tmpVal_123).Length(); i_126++) 
                      e_l_125.ImpAppend(((Record) tmpVal_123).GetField(i_126));
                    if (succ_122 = 2 == (Int) (e_l_125.Length())) {
                      Generic permI_127;
                      permI_127 = (Generic) (e_l_125.Hd());
                      succ_122 = true;
                      {
                        vdm_MOD_init__id = permI_127;
                        succ_122 = true;
                      }
                      permI_127 = (Generic) (e_l_125[2]);
                      if (succ_122) 
                        succ_122 = true;
                    }
                  }
              }
              if (!succ_122) 
                RunTime("Pattern match did not succeed in value definition");
              {
                Bool cond_128;
                {
                  Bool unArg_129;
                  Record argTmp_130;
                  argTmp_130 = vdm_MOD_init__p;
                  if (argTmp_130.IsRecord()) 
                    unArg_129 = vdm_AS_PatternName == argTmp_130.GetTag();
                  else 
                    unArg_129 = false;
                  cond_128 = (Bool) (!unArg_129.GetValue());
                }
                if (cond_128.GetValue()) 
                  RunTime("Can not evaluate an error statement");
                else {
                  bool succ_131;
                  Record tmpVal_132;
                  tmpVal_132 = vdm_MOD_init__p;
                  Generic vdm_MOD_pat__name;
                  succ_131 = true;
                  {
                    succ_131 = false;
                    if (tmpVal_132.IsRecord()) 
                      if (vdm_AS_PatternName == ((Record) tmpVal_132).GetTag()) {
                        Sequence e_l_133;
                        for (int i_134 = 1; i_134 <= ((Record) tmpVal_132).Length(); i_134++) 
                          e_l_133.ImpAppend(((Record) tmpVal_132).GetField(i_134));
                        if (succ_131 = 2 == (Int) (e_l_133.Length())) {
                          Generic permI_135;
                          permI_135 = (Generic) (e_l_133.Hd());
                          succ_131 = true;
                          {
                            vdm_MOD_pat__name = permI_135;
                            succ_131 = true;
                          }
                          permI_135 = (Generic) (e_l_133[2]);
                          if (succ_131) 
                            succ_131 = true;
                        }
                      }
                  }
                  if (!succ_131) 
                    RunTime("Pattern match did not succeed in value definition");
                  {
                    Bool cond_136;
                    cond_136 = (Bool) (vdm_MOD_pat__name == Nil());
                    if (cond_136.GetValue()) 
                      RunTime("Can not evaluate an error statement");
                    else {
                      bool succ_139;
                      Generic tmpVal_140;
                      tmpVal_140 = vdm_MOD_pat__name;
                      Sequence vdm_MOD_pat__id;
                      succ_139 = true;
                      {
                        succ_139 = false;
                        if (tmpVal_140.IsRecord()) 
                          if (vdm_AS_Name == ((Record) tmpVal_140).GetTag()) {
                            Sequence e_l_141;
                            for (int i_142 = 1; i_142 <= ((Record) tmpVal_140).Length(); i_142++) 
                              e_l_141.ImpAppend(((Record) tmpVal_140).GetField(i_142));
                            if (succ_139 = 2 == (Int) (e_l_141.Length())) {
                              Generic permI_143;
                              permI_143 = (Generic) (e_l_141.Hd());
                              succ_139 = true;
                              {
                                vdm_MOD_pat__id = permI_143;
                                succ_139 = true;
                              }
                              permI_143 = (Generic) (e_l_141[2]);
                              if (succ_139) 
                                succ_139 = true;
                            }
                          }
                      }
                      if (!succ_139) 
                        RunTime("Pattern match did not succeed in value definition");
                      {
                        Bool cond_144;
                        cond_144 = (Bool) (!(vdm_MOD_init__id == vdm_MOD_pat__id));
                        if (cond_144.GetValue()) 
                          RunTime("Can not evaluate an error statement");
                      }
                    }
                  }
                }
              }
            }
            {
              Record vdm_MOD_init__v;
              Record tmpVar_149;
              {
                Record tmpRec_150;
                tmpRec_150 = vdm_MOD_init__e;
                if (((Record) tmpRec_150).Is(vdm_AS_BinaryExpr)) 
                  tmpVar_149 = ((Record) tmpRec_150).GetField(pos_AS_BinaryExpr_right);
                else 
                  RunTime("Unknown record field selector");
              }
              vdm_MOD_init__v = vdm_MOD_EvalExpr(tmpVar_149);
              {
                Bool cond_151;
                {
                  Record argTmp_152;
                  argTmp_152 = vdm_MOD_init__v;
                  if (argTmp_152.IsRecord()) 
                    cond_151 = vdm_SEM_REC == argTmp_152.GetTag();
                  else 
                    cond_151 = false;
                }
                if (cond_151.GetValue()) {
                  bool succ_153;
                  Record tmpVal_154;
                  tmpVal_154 = vdm_MOD_init__v;
                  Sequence vdm_MOD_initfields__lv;
                  Record vdm_MOD_initname(vdm_AS_Name, length_AS_Name);
                  succ_153 = true;
                  {
                    succ_153 = false;
                    if (tmpVal_154.IsRecord()) 
                      if (vdm_SEM_REC == ((Record) tmpVal_154).GetTag()) {
                        Sequence e_l_155;
                        for (int i_156 = 1; i_156 <= ((Record) tmpVal_154).Length(); i_156++) 
                          e_l_155.ImpAppend(((Record) tmpVal_154).GetField(i_156));
                        if (succ_153 = 2 == (Int) (e_l_155.Length())) {
                          Generic permI_157;
                          permI_157 = (Generic) (e_l_155.Hd());
                          succ_153 = true;
                          {
                            vdm_MOD_initname = permI_157;
                            succ_153 = true;
                          }
                          permI_157 = (Generic) (e_l_155[2]);
                          if (succ_153) {
                            vdm_MOD_initfields__lv = permI_157;
                            succ_153 = true;
                          }
                        }
                      }
                  }
                  if (!succ_153) 
                    RunTime("Pattern match did not succeed in value definition");
                  Record vdm_MOD_name_q(vdm_AS_Name, length_AS_Name);
                  vdm_MOD_name_q = vdm_AUX_UniqueTagName(vdm_MOD_name);
                  {
                    Bool cond_160;
{ if ((cond_160 = vdm_MOD_EqualNames(vdm_MOD_name_q, vdm_MOD_initname)).GetValue()) { cond_160 = (Bool) ((Int) (vdm_MOD_fields__lv.Length()) == (Int) (vdm_MOD_initfields__lv.Length())); } }
                    if (cond_160.GetValue()) {
                      Map vdm_MOD_res;
                      Map res_m_171;
                      Generic md_172;
                      Record mr_173(vdm_GLOBAL_State, length_GLOBAL_State);
                      {
                        Sequence seq_lv_186;
                        bool succ_184;
                        Bool tsucc_187;
                        tsucc_187 = true;
                        {
                          Set tmpVar_v_185;
                          {
                            Set riseq_190;
                            int max_191 = (Int) (vdm_MOD_fields__lv.Length());
                            for (int i_192 = 1; i_192 <= max_191; i_192++) 
                              riseq_190.Insert((Int) i_192);
                            tmpVar_v_185 = riseq_190;
                          }
{ seq_lv_186.ImpAppend(tmpVar_v_185); }
                        }
                        Set allComb_188 = GenAllComb(seq_lv_186);
                        Int vdm_MOD_i;
                        Generic tmpe_201;
                        for (int bb_200 = allComb_188.First(tmpe_201); bb_200; bb_200 = allComb_188.Next(tmpe_201)) {
                          Sequence tmp_198 = tmpe_201;
                          {
                            if (succ_184 = 1 == (Int) (tmp_198.Length())) {
                              Int permI_199;
                              permI_199 = (Int) (tmp_198.Hd());
                              succ_184 = true;
                              {
                                vdm_MOD_i = permI_199;
                                succ_184 = true;
                              }
                            }
                            if (succ_184) {
                              Record tmpRec_174(vdm_AS_Field, length_AS_Field);
                              {
                                Sequence tmpseq_175;
                                tmpseq_175 = vdm_MOD_fields__lv;
                                tmpRec_174 = (Record) (tmpseq_175[vdm_MOD_i.GetValue()]);
                              }
                              if (tmpRec_174.Is(vdm_AS_Field)) 
                                md_172 = tmpRec_174.GetField(pos_AS_Field_sel);
                              else 
                                RunTime("Unknown record field selector");
                              {
                                mr_173 = Record(vdm_GLOBAL_State, length_GLOBAL_State);
                                Record tmpVar_177;
                                {
                                  Sequence tmpseq_178;
                                  tmpseq_178 = vdm_MOD_initfields__lv;
                                  tmpVar_177 = (Record) (tmpseq_178[vdm_MOD_i.GetValue()]);
                                }
                                mr_173.SetField(1, tmpVar_177);
                                Record tmpVar_180;
                                {
                                  Record tmpRec_181(vdm_AS_Field, length_AS_Field);
                                  {
                                    Sequence tmpseq_182;
                                    tmpseq_182 = vdm_MOD_fields__lv;
                                    tmpRec_181 = (Record) (tmpseq_182[vdm_MOD_i.GetValue()]);
                                  }
                                  if (tmpRec_181.Is(vdm_AS_Field)) 
                                    tmpVar_180 = tmpRec_181.GetField(pos_AS_Field_type);
                                  else 
                                    RunTime("Unknown record field selector");
                                }
                                mr_173.SetField(2, tmpVar_180);
                              }
                              res_m_171.Insert(md_172, mr_173);
                            }
                          }
                        }
                      }
                      vdm_MOD_res = res_m_171;
                      {
                        Bool cond_202;
{ if ((cond_202 = vdm_MOD_DTC()).GetValue()) {
   Bool var2_204;
   Bool unArg_205;
   bool tmpQuant_206 = true;
   {
     Sequence seq_lv_209;
     bool succ_207;
     Bool tsucc_210;
     tsucc_210 = true;
     {
       Set tmpVar_v_208;
       tmpVar_v_208 = vdm_MOD_res.Dom();
{ seq_lv_209.ImpAppend(tmpVar_v_208); }
     }
     Set allComb_211 = GenAllComb(seq_lv_209);
     Bool pred_217;
     Generic vdm_MOD_id;
     Generic tmpe_229;
     for (int bb_228 = allComb_211.First(tmpe_229); bb_228 && tmpQuant_206; bb_228 = allComb_211.Next(tmpe_229)) {
       Sequence tmp_218 = tmpe_229;
       {
         if (succ_207 = 1 == (Int) (tmp_218.Length())) {
           Generic permI_227;
           permI_227 = (Generic) (tmp_218.Hd());
           succ_207 = true;
           {
             vdm_MOD_id = permI_227;
             succ_207 = true;
           }
         }
         if (succ_207) {
           Record tmpVar_219;
           {
             Record tmpRec_220(vdm_GLOBAL_State, length_GLOBAL_State);
             {
               Map tmp_m_221;
               tmp_m_221 = vdm_MOD_res;
               tmpRec_220 = (Record) (((Map) tmp_m_221)[vdm_MOD_id]);
             }
             if (tmpRec_220.Is(vdm_GLOBAL_State)) 
               tmpVar_219 = tmpRec_220.GetField(pos_GLOBAL_State_val);
             else 
               RunTime("Unknown record field selector");
           }
           Record tmpVar_223;
           {
             Record tmpRec_224(vdm_GLOBAL_State, length_GLOBAL_State);
             {
               Map tmp_m_225;
               tmp_m_225 = vdm_MOD_res;
               tmpRec_224 = (Record) (((Map) tmp_m_225)[vdm_MOD_id]);
             }
             if (tmpRec_224.Is(vdm_GLOBAL_State)) 
               tmpVar_223 = tmpRec_224.GetField(pos_GLOBAL_State_tp);
             else 
               RunTime("Unknown record field selector");
           }
           pred_217 = vdm_MOD_SubType(tmpVar_219, tmpVar_223);
           if (pred_217.GetValue()) {}
           else 
             tmpQuant_206 = false;
         }
       }
     }
   }
   unArg_205 = (Bool) tmpQuant_206;
   var2_204 = (Bool) (!unArg_205.GetValue());
   cond_202 = var2_204;
 } }
                        if (cond_202.GetValue()) 
                          RunTime("Can not evaluate an error statement");
                        else {
                          Map rexpr_230;
                          rexpr_230 = vdm_MOD_res;
                          return rexpr_230;
                        }
                      }
                    }
                    else { RunTime("Can not evaluate an error statement"); }
                  }
                }
                else { RunTime("Can not evaluate an error statement"); }
              }
            }
          }
          else {
            Record argTmp_24;
            argTmp_24 = vdm_MOD_init__e;
            if (argTmp_24.IsRecord()) 
              cond_22 = vdm_AS_RecordConstructorExpr == argTmp_24.GetTag();
            else 
              cond_22 = false;
            if (cond_22.GetValue()) {
              Bool cond_25;
              {
                Bool unArg_26;
                Record argTmp_27;
                argTmp_27 = vdm_MOD_init__p;
                if (argTmp_27.IsRecord()) 
                  unArg_26 = vdm_AS_RecordPattern == argTmp_27.GetTag();
                else 
                  unArg_26 = false;
                cond_25 = (Bool) (!unArg_26.GetValue());
              }
              if (cond_25.GetValue()) 
                RunTime("Can not evaluate an error statement");
              else {
                Bool cond_28;
                {
                  Bool unArg_29;
                  unArg_29 = vdm_MOD_IsAllPatternName(vdm_MOD_init__p);
                  cond_28 = (Bool) (!unArg_29.GetValue());
                }
                if (cond_28.GetValue()) 
                  RunTime("Can not evaluate an error statement");
              }
              {
                Record vdm_MOD_init__v;
                vdm_MOD_init__v = vdm_MOD_EvalExpr(vdm_MOD_init__e);
                {
                  Bool cond_34;
                  {
                    Record argTmp_35;
                    argTmp_35 = vdm_MOD_init__v;
                    if (argTmp_35.IsRecord()) 
                      cond_34 = vdm_SEM_REC == argTmp_35.GetTag();
                    else 
                      cond_34 = false;
                  }
                  if (cond_34.GetValue()) {
                    bool succ_36;
                    Record tmpVal_37;
                    tmpVal_37 = vdm_MOD_init__v;
                    Sequence vdm_MOD_initfields__lv;
                    Record vdm_MOD_initname(vdm_AS_Name, length_AS_Name);
                    succ_36 = true;
                    {
                      succ_36 = false;
                      if (tmpVal_37.IsRecord()) 
                        if (vdm_SEM_REC == ((Record) tmpVal_37).GetTag()) {
                          Sequence e_l_38;
                          for (int i_39 = 1; i_39 <= ((Record) tmpVal_37).Length(); i_39++) 
                            e_l_38.ImpAppend(((Record) tmpVal_37).GetField(i_39));
                          if (succ_36 = 2 == (Int) (e_l_38.Length())) {
                            Generic permI_40;
                            permI_40 = (Generic) (e_l_38.Hd());
                            succ_36 = true;
                            {
                              vdm_MOD_initname = permI_40;
                              succ_36 = true;
                            }
                            permI_40 = (Generic) (e_l_38[2]);
                            if (succ_36) {
                              vdm_MOD_initfields__lv = permI_40;
                              succ_36 = true;
                            }
                          }
                        }
                    }
                    if (!succ_36) 
                      RunTime("Pattern match did not succeed in value definition");
                    Record vdm_MOD_name_q(vdm_AS_Name, length_AS_Name);
                    vdm_MOD_name_q = vdm_AUX_UniqueTagName(vdm_MOD_name);
                    {
                      Bool cond_43;
{ if ((cond_43 = vdm_MOD_EqualNames(vdm_MOD_name_q, vdm_MOD_initname)).GetValue()) { cond_43 = (Bool) ((Int) (vdm_MOD_fields__lv.Length()) == (Int) (vdm_MOD_initfields__lv.Length())); } }
                      if (cond_43.GetValue()) {
                        Map vdm_MOD_res;
                        Map res_m_54;
                        Generic md_55;
                        Record mr_56(vdm_GLOBAL_State, length_GLOBAL_State);
                        {
                          Sequence seq_lv_69;
                          bool succ_67;
                          Bool tsucc_70;
                          tsucc_70 = true;
                          {
                            Set tmpVar_v_68;
                            {
                              Set riseq_73;
                              int max_74 = (Int) (vdm_MOD_fields__lv.Length());
                              for (int i_75 = 1; i_75 <= max_74; i_75++) 
                                riseq_73.Insert((Int) i_75);
                              tmpVar_v_68 = riseq_73;
                            }
{ seq_lv_69.ImpAppend(tmpVar_v_68); }
                          }
                          Set allComb_71 = GenAllComb(seq_lv_69);
                          Int vdm_MOD_i;
                          Generic tmpe_84;
                          for (int bb_83 = allComb_71.First(tmpe_84); bb_83; bb_83 = allComb_71.Next(tmpe_84)) {
                            Sequence tmp_81 = tmpe_84;
                            {
                              if (succ_67 = 1 == (Int) (tmp_81.Length())) {
                                Int permI_82;
                                permI_82 = (Int) (tmp_81.Hd());
                                succ_67 = true;
                                {
                                  vdm_MOD_i = permI_82;
                                  succ_67 = true;
                                }
                              }
                              if (succ_67) {
                                Record tmpRec_57(vdm_AS_Field, length_AS_Field);
                                {
                                  Sequence tmpseq_58;
                                  tmpseq_58 = vdm_MOD_fields__lv;
                                  tmpRec_57 = (Record) (tmpseq_58[vdm_MOD_i.GetValue()]);
                                }
                                if (tmpRec_57.Is(vdm_AS_Field)) 
                                  md_55 = tmpRec_57.GetField(pos_AS_Field_sel);
                                else 
                                  RunTime("Unknown record field selector");
                                {
                                  mr_56 = Record(vdm_GLOBAL_State, length_GLOBAL_State);
                                  Record tmpVar_60;
                                  {
                                    Sequence tmpseq_61;
                                    tmpseq_61 = vdm_MOD_initfields__lv;
                                    tmpVar_60 = (Record) (tmpseq_61[vdm_MOD_i.GetValue()]);
                                  }
                                  mr_56.SetField(1, tmpVar_60);
                                  Record tmpVar_63;
                                  {
                                    Record tmpRec_64(vdm_AS_Field, length_AS_Field);
                                    {
                                      Sequence tmpseq_65;
                                      tmpseq_65 = vdm_MOD_fields__lv;
                                      tmpRec_64 = (Record) (tmpseq_65[vdm_MOD_i.GetValue()]);
                                    }
                                    if (tmpRec_64.Is(vdm_AS_Field)) 
                                      tmpVar_63 = tmpRec_64.GetField(pos_AS_Field_type);
                                    else 
                                      RunTime("Unknown record field selector");
                                  }
                                  mr_56.SetField(2, tmpVar_63);
                                }
                                res_m_54.Insert(md_55, mr_56);
                              }
                            }
                          }
                        }
                        vdm_MOD_res = res_m_54;
                        {
                          Bool cond_85;
{ if ((cond_85 = vdm_MOD_DTC()).GetValue()) {
   Bool var2_87;
   Bool unArg_88;
   bool tmpQuant_89 = true;
   {
     Sequence seq_lv_92;
     bool succ_90;
     Bool tsucc_93;
     tsucc_93 = true;
     {
       Set tmpVar_v_91;
       tmpVar_v_91 = vdm_MOD_res.Dom();
{ seq_lv_92.ImpAppend(tmpVar_v_91); }
     }
     Set allComb_94 = GenAllComb(seq_lv_92);
     Bool pred_100;
     Generic vdm_MOD_id;
     Generic tmpe_112;
     for (int bb_111 = allComb_94.First(tmpe_112); bb_111 && tmpQuant_89; bb_111 = allComb_94.Next(tmpe_112)) {
       Sequence tmp_101 = tmpe_112;
       {
         if (succ_90 = 1 == (Int) (tmp_101.Length())) {
           Generic permI_110;
           permI_110 = (Generic) (tmp_101.Hd());
           succ_90 = true;
           {
             vdm_MOD_id = permI_110;
             succ_90 = true;
           }
         }
         if (succ_90) {
           Record tmpVar_102;
           {
             Record tmpRec_103(vdm_GLOBAL_State, length_GLOBAL_State);
             {
               Map tmp_m_104;
               tmp_m_104 = vdm_MOD_res;
               tmpRec_103 = (Record) (((Map) tmp_m_104)[vdm_MOD_id]);
             }
             if (tmpRec_103.Is(vdm_GLOBAL_State)) 
               tmpVar_102 = tmpRec_103.GetField(pos_GLOBAL_State_val);
             else 
               RunTime("Unknown record field selector");
           }
           Record tmpVar_106;
           {
             Record tmpRec_107(vdm_GLOBAL_State, length_GLOBAL_State);
             {
               Map tmp_m_108;
               tmp_m_108 = vdm_MOD_res;
               tmpRec_107 = (Record) (((Map) tmp_m_108)[vdm_MOD_id]);
             }
             if (tmpRec_107.Is(vdm_GLOBAL_State)) 
               tmpVar_106 = tmpRec_107.GetField(pos_GLOBAL_State_tp);
             else 
               RunTime("Unknown record field selector");
           }
           pred_100 = vdm_MOD_SubType(tmpVar_102, tmpVar_106);
           if (pred_100.GetValue()) {}
           else 
             tmpQuant_89 = false;
         }
       }
     }
   }
   unArg_88 = (Bool) tmpQuant_89;
   var2_87 = (Bool) (!unArg_88.GetValue());
   cond_85 = var2_87;
 } }
                          if (cond_85.GetValue()) 
                            RunTime("Can not evaluate an error statement");
                          else {
                            Map rexpr_113;
                            rexpr_113 = vdm_MOD_res;
                            return rexpr_113;
                          }
                        }
                      }
                      else { RunTime("Can not evaluate an error statement"); }
                    }
                  }
                  else { RunTime("Can not evaluate an error statement"); }
                }
              }
            }
            else { RunTime("Can not evaluate an error statement"); }
          }
        }
      }
    }
  }
}

Map vdm_MOD_InitGV(Sequence vdm_MOD_val__l) {
  Bool cond_3;
  {
    Sequence var2_5;
    var2_5 = Sequence();
    cond_3 = (Bool) (!(vdm_MOD_val__l == var2_5));
  }
  if (cond_3.GetValue()) {
    Map vdm_MOD_res__m;
    vdm_MOD_res__m = Map();
    {
      bool succ_7;
      Record tmpVal_8(vdm_AS_ValueDef, length_AS_ValueDef);
      tmpVal_8 = (Record) (vdm_MOD_val__l.Hd());
      Record vdm_MOD_exp__e;
      Record vdm_MOD_pat;
      Generic vdm_MOD_tp;
      succ_7 = true;
      {
        succ_7 = false;
        if (tmpVal_8.IsRecord()) 
          if (vdm_AS_ValueDef == tmpVal_8.GetTag()) {
            Sequence e_l_10;
            for (int i_11 = 1; i_11 <= tmpVal_8.Length(); i_11++) 
              e_l_10.ImpAppend(tmpVal_8.GetField(i_11));
            if (succ_7 = 3 == (Int) (e_l_10.Length())) {
              Generic permI_12;
              permI_12 = (Generic) (e_l_10.Hd());
              succ_7 = true;
              {
                vdm_MOD_pat = permI_12;
                succ_7 = true;
              }
              permI_12 = (Generic) (e_l_10[2]);
              if (succ_7) {
                vdm_MOD_tp = permI_12;
                succ_7 = true;
              }
              permI_12 = (Generic) (e_l_10[3]);
              if (succ_7) {
                vdm_MOD_exp__e = permI_12;
                succ_7 = true;
              }
            }
          }
      }
      if (!succ_7) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Record vdm_MOD_exp__v;
        vdm_MOD_exp__v = vdm_MOD_EvalExpr(vdm_MOD_exp__e);
        {
          Bool cond_16;
          cond_16 = vdm_MOD_DTC();
          if (cond_16.GetValue()) {
            Bool cond_17;
{ if ((cond_17 = (Bool) (!(vdm_MOD_tp == Nil()))).GetValue()) {
   Bool var2_19;
   Bool unArg_22;
   unArg_22 = vdm_MOD_SubType(vdm_MOD_exp__v, vdm_MOD_tp);
   var2_19 = (Bool) (!unArg_22.GetValue());
   cond_17 = var2_19;
 } }
            if (cond_17.GetValue()) 
              RunTime("Can not evaluate an error statement");
          }
          {
            Set vdm_MOD_env__s;
            vdm_MOD_env__s = vdm_MOD_PatternMatch(vdm_MOD_pat, vdm_MOD_exp__v);
            {
              Bool cond_29;
              {
                Set var2_31;
                var2_31 = Set();
                cond_29 = (Bool) (!(vdm_MOD_env__s == var2_31));
              }
              if (cond_29.GetValue()) {
                Set tmpSet_32;
                tmpSet_32 = vdm_MOD_env__s;
                Record vdm_MOD_env(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
                Bool tmpB_33;
                bool succ_34 = false;
                Generic tmpe_37;
                for (int bb_36 = tmpSet_32.First(tmpe_37); bb_36 && !succ_34; bb_36 = tmpSet_32.Next(tmpe_37)) {
                  Record tmpElem_35 = tmpe_37;
                  {
                    succ_34 = true;
                    {
                      vdm_MOD_env = tmpElem_35;
                      succ_34 = true;
                    }
                    if (succ_34) 
                      succ_34 = ((Bool) true).GetValue();
                  }
                }
                if (!succ_34) 
                  RunTime("The binding environment was empty");
                {
                  Sequence sq_38;
                  {
                    Record tmpRec_41(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
                    tmpRec_41 = vdm_MOD_env;
                    if (tmpRec_41.Is(vdm_SEM_BlkEnv)) 
                      sq_38 = tmpRec_41.GetField(pos_SEM_BlkEnv_id__l);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Record vdm_MOD_id(vdm_AS_Name, length_AS_Name);
                  Record vdm_MOD_val;
                  bool succ_40;
                  Generic tmpe_52;
                  for (int i_51 = sq_38.First(tmpe_52); i_51; i_51 = sq_38.Next(tmpe_52)) {
                    Record elem_39 = tmpe_52;
                    {
                      succ_40 = true;
                      {
                        succ_40 = false;
                        if (elem_39.IsRecord()) 
                          if (vdm_SEM_IdVal == elem_39.GetTag()) {
                            Sequence e_l_48;
                            for (int i_49 = 1; i_49 <= elem_39.Length(); i_49++) 
                              e_l_48.ImpAppend(elem_39.GetField(i_49));
                            if (succ_40 = 3 == (Int) (e_l_48.Length())) {
                              Generic permI_50;
                              permI_50 = (Generic) (e_l_48.Hd());
                              succ_40 = true;
                              {
                                vdm_MOD_id = permI_50;
                                succ_40 = true;
                              }
                              permI_50 = (Generic) (e_l_48[2]);
                              if (succ_40) {
                                vdm_MOD_val = permI_50;
                                succ_40 = true;
                              }
                              permI_50 = (Generic) (e_l_48[3]);
                              if (succ_40) 
                                succ_40 = true;
                            }
                          }
                      }
                      if (succ_40) {
                        Map rhs_42;
                        {
                          Map seqmap_43;
                          seqmap_43 = vdm_MOD_res__m;
                          Map modmap_44;
                          modmap_44 = Map().Insert(vdm_MOD_id, vdm_MOD_val);
                          seqmap_43.ImpOverride(modmap_44);
                          rhs_42 = seqmap_43;
                        }
                        vdm_MOD_res__m = rhs_42;
                      }
                      else 
                        RunTime("Pattern did not match in sequence for loop");
                    }
                  }
                  {
                    Record tmpVar_53(vdm_SEM_BlkEnv, length_SEM_BlkEnv);
                    tmpVar_53 = vdm_MOD_env;
                    vdm_MOD_PushBlkEnv(tmpVar_53);
                  }
                  {
                    Map rhs_54;
                    {
                      Map seqmap_55;
                      seqmap_55 = vdm_MOD_res__m;
                      Map modmap_56;
                      modmap_56 = vdm_MOD_InitGV(vdm_MOD_val__l.Tl());
                      seqmap_55.ImpOverride(modmap_56);
                      rhs_54 = seqmap_55;
                    }
                    vdm_MOD_res__m = rhs_54;
                  }
                  vdm_MOD_PopBlkEnv();
                }
              }
              else { RunTime("Can not evaluate an error statement"); }
            }
          }
        }
      }
    }
    {
      Map rexpr_60;
      rexpr_60 = vdm_MOD_res__m;
      return rexpr_60;
    }
  }
  else {
    Map rexpr_6;
    rexpr_6 = Map();
    return rexpr_6;
  }
}

Record vdm_MOD_Instantiate(Record vdm_MOD_mod__name, Record vdm_MOD_new__name, Map vdm_MOD_inst__m, Record vdm_MOD_sigmamo) {
  Record vdm_MOD_new__mo(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
  vdm_MOD_new__mo = vdm_MOD_sigmamo;
  {
    Record rhs_6(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
    {
      Record tmpVar_7(vdm_AS_Name, length_AS_Name);
      {
        tmpVar_7 = Record(vdm_AS_Name, length_AS_Name);
        Sequence tmpVar_8;
        {
          Sequence var1_9;
          Record tmpRec_11(vdm_AS_Name, length_AS_Name);
          tmpRec_11 = vdm_MOD_mod__name;
          if (tmpRec_11.Is(vdm_AS_Name)) 
            var1_9 = tmpRec_11.GetField(pos_AS_Name_ids);
          else 
            RunTime("Unknown record field selector");
          Sequence var2_10;
          Record tmpRec_12(vdm_AS_Name, length_AS_Name);
          tmpRec_12 = vdm_MOD_new__name;
          if (tmpRec_12.Is(vdm_AS_Name)) 
            var2_10 = tmpRec_12.GetField(pos_AS_Name_ids);
          else 
            RunTime("Unknown record field selector");
          tmpVar_8.ImpConc(var1_9).ImpConc(var2_10);
        }
        tmpVar_7.SetField(1, tmpVar_8);
        tmpVar_7.SetField(2, Nil());
      }
      rhs_6 = vdm_MOD_UpdateFnAndOps(tmpVar_7, vdm_MOD_sigmamo);
    }
    vdm_MOD_new__mo = rhs_6;
  }
  {
    Set iset_15;
    iset_15 = vdm_MOD_inst__m.Dom();
    Record vdm_MOD_par__id(vdm_AS_Name, length_AS_Name);
    bool succ_17;
    Generic tmpe_82;
    for (int bb_81 = iset_15.First(tmpe_82); bb_81; bb_81 = iset_15.Next(tmpe_82)) {
      Record elem_16 = tmpe_82;
      {
        succ_17 = true;
        {
          vdm_MOD_par__id = elem_16;
          succ_17 = true;
        }
        if (succ_17) {
          Record vdm_MOD_par;
          Map tmp_m_21;
          tmp_m_21 = vdm_MOD_inst__m;
          vdm_MOD_par = (Record) (((Map) tmp_m_21)[vdm_MOD_par__id]);
          {
            Bool cond_23;
            {
              Record argTmp_24;
              argTmp_24 = vdm_MOD_par;
              if (argTmp_24.IsRecord()) 
                cond_23 = vdm_AS_BasicType == argTmp_24.GetTag();
              else 
                cond_23 = false;
            }
            if (cond_23.GetValue()) {
              Map rhs_64;
              {
                Map seqmap_65;
                {
                  Record tmpRec_68(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRec_68 = vdm_MOD_new__mo;
                  if (tmpRec_68.Is(vdm_GLOBAL_SigmaMO)) 
                    seqmap_65 = tmpRec_68.GetField(pos_GLOBAL_SigmaMO_tps);
                  else 
                    RunTime("Unknown record field selector");
                }
                Map modmap_66;
                modmap_66 = vdm_MOD_UpdateBasicType(vdm_MOD_par__id, vdm_MOD_par);
                seqmap_65.ImpOverride(modmap_66);
                rhs_64 = seqmap_65;
              }
              Record mu_rhs_71(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);              {
                Record tmpRE_72(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                tmpRE_72 = vdm_MOD_new__mo;
                int mu_73;
                mu_73 = pos_GLOBAL_SigmaMO_tps;
                Map val_74;
                {
                  Map seqmap_75;
                  {
                    Record tmpRec_78(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_78 = vdm_MOD_new__mo;
                    if (tmpRec_78.Is(vdm_GLOBAL_SigmaMO)) 
                      seqmap_75 = tmpRec_78.GetField(pos_GLOBAL_SigmaMO_tps);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Map modmap_76;
                  modmap_76 = vdm_MOD_UpdateBasicType(vdm_MOD_par__id, vdm_MOD_par);
                  seqmap_75.ImpOverride(modmap_76);
                  val_74 = seqmap_75;
                }
                tmpRE_72.SetField(mu_73, val_74);
                mu_rhs_71 = tmpRE_72;
              }              vdm_MOD_new__mo = mu_rhs_71;
            }
            else {
              Bool cond_25;
              {
                Bool var1_26;
                Record argTmp_28;
                argTmp_28 = vdm_MOD_par;
                if (argTmp_28.IsRecord()) 
                  var1_26 = vdm_AS_Name == argTmp_28.GetTag();
                else 
                  var1_26 = false;
                if ((cond_25 = var1_26).GetValue()) { cond_25 = vdm_MOD_IsTypeDef(vdm_MOD_par); }
              }
              if (cond_25.GetValue()) {
                Map rhs_45;
                {
                  Map seqmap_46;
                  {
                    Record tmpRec_49(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_49 = vdm_MOD_new__mo;
                    if (tmpRec_49.Is(vdm_GLOBAL_SigmaMO)) 
                      seqmap_46 = tmpRec_49.GetField(pos_GLOBAL_SigmaMO_tps);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  Map modmap_47;
                  modmap_47 = vdm_MOD_UpdateTypeName(vdm_MOD_par__id, vdm_MOD_mod__name, vdm_MOD_par);
                  seqmap_46.ImpOverride(modmap_47);
                  rhs_45 = seqmap_46;
                }
                Record mu_rhs_53(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);                {
                  Record tmpRE_54(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRE_54 = vdm_MOD_new__mo;
                  int mu_55;
                  mu_55 = pos_GLOBAL_SigmaMO_tps;
                  Map val_56;
                  {
                    Map seqmap_57;
                    {
                      Record tmpRec_60(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                      tmpRec_60 = vdm_MOD_new__mo;
                      if (tmpRec_60.Is(vdm_GLOBAL_SigmaMO)) 
                        seqmap_57 = tmpRec_60.GetField(pos_GLOBAL_SigmaMO_tps);
                      else 
                        RunTime("Unknown record field selector");
                    }
                    Map modmap_58;
                    modmap_58 = vdm_MOD_UpdateTypeName(vdm_MOD_par__id, vdm_MOD_mod__name, vdm_MOD_par);
                    seqmap_57.ImpOverride(modmap_58);
                    val_56 = seqmap_57;
                  }
                  tmpRE_54.SetField(mu_55, val_56);
                  mu_rhs_53 = tmpRE_54;
                }                vdm_MOD_new__mo = mu_rhs_53;
              }
              else {
                Sequence rhs_30;
                {
                  Sequence var1_31;
                  Record tmpRec_33(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRec_33 = vdm_MOD_new__mo;
                  if (tmpRec_33.Is(vdm_GLOBAL_SigmaMO)) 
                    var1_31 = tmpRec_33.GetField(pos_GLOBAL_SigmaMO_gv__inst);
                  else 
                    RunTime("Unknown record field selector");
                  rhs_30.ImpConc(var1_31).ImpConc(vdm_MOD_UpdateValues(vdm_MOD_par__id, vdm_MOD_par));
                }
                Record mu_rhs_36(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);                {
                  Record tmpRE_37(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRE_37 = vdm_MOD_new__mo;
                  int mu_38;
                  mu_38 = pos_GLOBAL_SigmaMO_gv__inst;
                  Sequence val_39;
                  {
                    Sequence var1_40;
                    Record tmpRec_42(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_42 = vdm_MOD_new__mo;
                    if (tmpRec_42.Is(vdm_GLOBAL_SigmaMO)) 
                      var1_40 = tmpRec_42.GetField(pos_GLOBAL_SigmaMO_gv__inst);
                    else 
                      RunTime("Unknown record field selector");
                    val_39.ImpConc(var1_40).ImpConc(vdm_MOD_UpdateValues(vdm_MOD_par__id, vdm_MOD_par));
                  }
                  tmpRE_37.SetField(mu_38, val_39);
                  mu_rhs_36 = tmpRE_37;
                }                vdm_MOD_new__mo = mu_rhs_36;
              }
            }
          }
        }
        else 
          RunTime("Pattern did not match in set for loop");
      }
    }
  }
  {
    Record rexpr_83(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
    rexpr_83 = vdm_MOD_new__mo;
    return rexpr_83;
  }
}

Bool vdm_MOD_IsAllPatternName(Record vdm_MOD_pat__p) {
  Record selRes_3;
  selRes_3 = vdm_MOD_pat__p;
  bool succ_4 = true;
  {
    Generic vdm_MOD_id;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_PatternName == ((Record) selRes_3).GetTag()) {
          Sequence e_l_5;
          for (int i_6 = 1; i_6 <= ((Record) selRes_3).Length(); i_6++) 
            e_l_5.ImpAppend(((Record) selRes_3).GetField(i_6));
          if (succ_4 = 2 == (Int) (e_l_5.Length())) {
            Generic permI_7;
            permI_7 = (Generic) (e_l_5.Hd());
            succ_4 = true;
            {
              vdm_MOD_id = permI_7;
              succ_4 = true;
            }
            permI_7 = (Generic) (e_l_5[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Bool cond_8;
      cond_8 = (Bool) (vdm_MOD_id == Nil());
      if (cond_8.GetValue()) {
        Bool rexpr_12;
        rexpr_12 = (Bool) false;
        return rexpr_12;
      }
      else {
        Bool rexpr_11;
        rexpr_11 = (Bool) true;
        return rexpr_11;
      }
    }
  }
  if (!succ_4) {
    succ_4 = false;
    if (selRes_3.IsRecord()) 
      if (vdm_AS_MatchVal == ((Record) selRes_3).GetTag()) {
        Sequence e_l_13;
        for (int i_14 = 1; i_14 <= ((Record) selRes_3).Length(); i_14++) 
          e_l_13.ImpAppend(((Record) selRes_3).GetField(i_14));
        if (succ_4 = 1 == (Int) (e_l_13.Length())) {
          Record permI_15;
          permI_15 = (Record) (e_l_13.Hd());
          succ_4 = true;
          succ_4 = true;
        }
      }
    if (succ_4) {
      Bool rexpr_16;
      rexpr_16 = (Bool) false;
      return rexpr_16;
    }
  }
  if (!succ_4) {
    Sequence vdm_MOD_els;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_17;
          for (int i_18 = 1; i_18 <= ((Record) selRes_3).Length(); i_18++) 
            e_l_17.ImpAppend(((Record) selRes_3).GetField(i_18));
          if (succ_4 = 2 == (Int) (e_l_17.Length())) {
            Generic permI_19;
            permI_19 = (Generic) (e_l_17.Hd());
            succ_4 = true;
            {
              vdm_MOD_els = permI_19;
              succ_4 = true;
            }
            permI_19 = (Generic) (e_l_17[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Bool rexpr_20;
      {
        bool tmpQuant_21 = true;
        {
          Sequence seq_lv_24;
          bool succ_22;
          Bool tsucc_25;
          tsucc_25 = true;
          {
            Set tmpVar_v_23;
            {
              Set riseq_28;
              int max_29 = (Int) (vdm_MOD_els.Length());
              for (int i_30 = 1; i_30 <= max_29; i_30++) 
                riseq_28.Insert((Int) i_30);
              tmpVar_v_23 = riseq_28;
            }
{ seq_lv_24.ImpAppend(tmpVar_v_23); }
          }
          Set allComb_26 = GenAllComb(seq_lv_24);
          Bool pred_35;
          Int vdm_MOD_i;
          Generic tmpe_42;
          for (int bb_41 = allComb_26.First(tmpe_42); bb_41 && tmpQuant_21; bb_41 = allComb_26.Next(tmpe_42)) {
            Sequence tmp_36 = tmpe_42;
            {
              if (succ_22 = 1 == (Int) (tmp_36.Length())) {
                Int permI_40;
                permI_40 = (Int) (tmp_36.Hd());
                succ_22 = true;
                {
                  vdm_MOD_i = permI_40;
                  succ_22 = true;
                }
              }
              if (succ_22) {
                Record tmpVar_37;
                {
                  Sequence tmpseq_38;
                  tmpseq_38 = vdm_MOD_els;
                  tmpVar_37 = (Record) (tmpseq_38[vdm_MOD_i.GetValue()]);
                }
                pred_35 = vdm_MOD_IsAllPatternName(tmpVar_37);
                if (pred_35.GetValue()) {}
                else 
                  tmpQuant_21 = false;
              }
            }
          }
        }
        rexpr_20 = (Bool) tmpQuant_21;
      }
      return rexpr_20;
    }
  }
  if (!succ_4) {
    Record vdm_MOD_lp;
    Record vdm_MOD_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetUnionPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_43;
          for (int i_44 = 1; i_44 <= ((Record) selRes_3).Length(); i_44++) 
            e_l_43.ImpAppend(((Record) selRes_3).GetField(i_44));
          if (succ_4 = 2 == (Int) (e_l_43.Length())) {
            Record permI_45;
            permI_45 = (Record) (e_l_43.Hd());
            succ_4 = true;
            {
              vdm_MOD_lp = permI_45;
              succ_4 = true;
            }
            permI_45 = (Record) (e_l_43[2]);
            if (succ_4) {
              vdm_MOD_rp = permI_45;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Bool rexpr_46;
{ if ((rexpr_46 = vdm_MOD_IsAllPatternName(vdm_MOD_lp)).GetValue()) { rexpr_46 = vdm_MOD_IsAllPatternName(vdm_MOD_rp); } }
      return rexpr_46;
    }
  }
  if (!succ_4) {
    Sequence vdm_MOD_els;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_51;
          for (int i_52 = 1; i_52 <= ((Record) selRes_3).Length(); i_52++) 
            e_l_51.ImpAppend(((Record) selRes_3).GetField(i_52));
          if (succ_4 = 2 == (Int) (e_l_51.Length())) {
            Generic permI_53;
            permI_53 = (Generic) (e_l_51.Hd());
            succ_4 = true;
            {
              vdm_MOD_els = permI_53;
              succ_4 = true;
            }
            permI_53 = (Generic) (e_l_51[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Bool rexpr_54;
      {
        bool tmpQuant_55 = true;
        {
          Sequence seq_lv_58;
          bool succ_56;
          Bool tsucc_59;
          tsucc_59 = true;
          {
            Set tmpVar_v_57;
            {
              Set riseq_62;
              int max_63 = (Int) (vdm_MOD_els.Length());
              for (int i_64 = 1; i_64 <= max_63; i_64++) 
                riseq_62.Insert((Int) i_64);
              tmpVar_v_57 = riseq_62;
            }
{ seq_lv_58.ImpAppend(tmpVar_v_57); }
          }
          Set allComb_60 = GenAllComb(seq_lv_58);
          Bool pred_69;
          Int vdm_MOD_i;
          Generic tmpe_76;
          for (int bb_75 = allComb_60.First(tmpe_76); bb_75 && tmpQuant_55; bb_75 = allComb_60.Next(tmpe_76)) {
            Sequence tmp_70 = tmpe_76;
            {
              if (succ_56 = 1 == (Int) (tmp_70.Length())) {
                Int permI_74;
                permI_74 = (Int) (tmp_70.Hd());
                succ_56 = true;
                {
                  vdm_MOD_i = permI_74;
                  succ_56 = true;
                }
              }
              if (succ_56) {
                Record tmpVar_71;
                {
                  Sequence tmpseq_72;
                  tmpseq_72 = vdm_MOD_els;
                  tmpVar_71 = (Record) (tmpseq_72[vdm_MOD_i.GetValue()]);
                }
                pred_69 = vdm_MOD_IsAllPatternName(tmpVar_71);
                if (pred_69.GetValue()) {}
                else 
                  tmpQuant_55 = false;
              }
            }
          }
        }
        rexpr_54 = (Bool) tmpQuant_55;
      }
      return rexpr_54;
    }
  }
  if (!succ_4) {
    Record vdm_MOD_lp;
    Record vdm_MOD_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqConcPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_77;
          for (int i_78 = 1; i_78 <= ((Record) selRes_3).Length(); i_78++) 
            e_l_77.ImpAppend(((Record) selRes_3).GetField(i_78));
          if (succ_4 = 2 == (Int) (e_l_77.Length())) {
            Record permI_79;
            permI_79 = (Record) (e_l_77.Hd());
            succ_4 = true;
            {
              vdm_MOD_lp = permI_79;
              succ_4 = true;
            }
            permI_79 = (Record) (e_l_77[2]);
            if (succ_4) {
              vdm_MOD_rp = permI_79;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Bool rexpr_80;
{ if ((rexpr_80 = vdm_MOD_IsAllPatternName(vdm_MOD_lp)).GetValue()) { rexpr_80 = vdm_MOD_IsAllPatternName(vdm_MOD_rp); } }
      return rexpr_80;
    }
  }
  if (!succ_4) {
    Sequence vdm_MOD_els;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_RecordPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_85;
          for (int i_86 = 1; i_86 <= ((Record) selRes_3).Length(); i_86++) 
            e_l_85.ImpAppend(((Record) selRes_3).GetField(i_86));
          if (succ_4 = 3 == (Int) (e_l_85.Length())) {
            Generic permI_87;
            permI_87 = (Generic) (e_l_85.Hd());
            succ_4 = true;
            succ_4 = true;
            permI_87 = (Generic) (e_l_85[2]);
            if (succ_4) {
              vdm_MOD_els = permI_87;
              succ_4 = true;
            }
            permI_87 = (Generic) (e_l_85[3]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Bool rexpr_88;
      {
        bool tmpQuant_89 = true;
        {
          Sequence seq_lv_92;
          bool succ_90;
          Bool tsucc_93;
          tsucc_93 = true;
          {
            Set tmpVar_v_91;
            {
              Set riseq_96;
              int max_97 = (Int) (vdm_MOD_els.Length());
              for (int i_98 = 1; i_98 <= max_97; i_98++) 
                riseq_96.Insert((Int) i_98);
              tmpVar_v_91 = riseq_96;
            }
{ seq_lv_92.ImpAppend(tmpVar_v_91); }
          }
          Set allComb_94 = GenAllComb(seq_lv_92);
          Bool pred_103;
          Int vdm_MOD_i;
          Generic tmpe_110;
          for (int bb_109 = allComb_94.First(tmpe_110); bb_109 && tmpQuant_89; bb_109 = allComb_94.Next(tmpe_110)) {
            Sequence tmp_104 = tmpe_110;
            {
              if (succ_90 = 1 == (Int) (tmp_104.Length())) {
                Int permI_108;
                permI_108 = (Int) (tmp_104.Hd());
                succ_90 = true;
                {
                  vdm_MOD_i = permI_108;
                  succ_90 = true;
                }
              }
              if (succ_90) {
                Record tmpVar_105;
                {
                  Sequence tmpseq_106;
                  tmpseq_106 = vdm_MOD_els;
                  tmpVar_105 = (Record) (tmpseq_106[vdm_MOD_i.GetValue()]);
                }
                pred_103 = vdm_MOD_IsAllPatternName(tmpVar_105);
                if (pred_103.GetValue()) {}
                else 
                  tmpQuant_89 = false;
              }
            }
          }
        }
        rexpr_88 = (Bool) tmpQuant_89;
      }
      return rexpr_88;
    }
  }
  if (!succ_4) {
    Sequence vdm_MOD_els;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_TuplePattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_111;
          for (int i_112 = 1; i_112 <= ((Record) selRes_3).Length(); i_112++) 
            e_l_111.ImpAppend(((Record) selRes_3).GetField(i_112));
          if (succ_4 = 2 == (Int) (e_l_111.Length())) {
            Generic permI_113;
            permI_113 = (Generic) (e_l_111.Hd());
            succ_4 = true;
            {
              vdm_MOD_els = permI_113;
              succ_4 = true;
            }
            permI_113 = (Generic) (e_l_111[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Bool rexpr_114;
      {
        bool tmpQuant_115 = true;
        {
          Sequence seq_lv_118;
          bool succ_116;
          Bool tsucc_119;
          tsucc_119 = true;
          {
            Set tmpVar_v_117;
            {
              Set riseq_122;
              int max_123 = (Int) (vdm_MOD_els.Length());
              for (int i_124 = 1; i_124 <= max_123; i_124++) 
                riseq_122.Insert((Int) i_124);
              tmpVar_v_117 = riseq_122;
            }
{ seq_lv_118.ImpAppend(tmpVar_v_117); }
          }
          Set allComb_120 = GenAllComb(seq_lv_118);
          Bool pred_129;
          Int vdm_MOD_i;
          Generic tmpe_136;
          for (int bb_135 = allComb_120.First(tmpe_136); bb_135 && tmpQuant_115; bb_135 = allComb_120.Next(tmpe_136)) {
            Sequence tmp_130 = tmpe_136;
            {
              if (succ_116 = 1 == (Int) (tmp_130.Length())) {
                Int permI_134;
                permI_134 = (Int) (tmp_130.Hd());
                succ_116 = true;
                {
                  vdm_MOD_i = permI_134;
                  succ_116 = true;
                }
              }
              if (succ_116) {
                Record tmpVar_131;
                {
                  Sequence tmpseq_132;
                  tmpseq_132 = vdm_MOD_els;
                  tmpVar_131 = (Record) (tmpseq_132[vdm_MOD_i.GetValue()]);
                }
                pred_129 = vdm_MOD_IsAllPatternName(tmpVar_131);
                if (pred_129.GetValue()) {}
                else 
                  tmpQuant_115 = false;
              }
            }
          }
        }
        rexpr_114 = (Bool) tmpQuant_115;
      }
      return rexpr_114;
    }
  }
  if (!succ_4) {
    Bool rexpr_137;
    rexpr_137 = (Bool) false;
    return rexpr_137;
  }
}

Bool vdm_MOD_IsFullyInstantiated(Record vdm_MOD_parms, Set vdm_MOD_id__s) {
  Set vdm_MOD_tp__s;
  Sequence unArg_6;
  Record tmpRec_7(vdm_AS_ParameterSig, length_AS_ParameterSig);
  tmpRec_7 = vdm_MOD_parms;
  if (tmpRec_7.Is(vdm_AS_ParameterSig)) 
    unArg_6 = tmpRec_7.GetField(pos_AS_ParameterSig_tps);
  else 
    RunTime("Unknown record field selector");
  vdm_MOD_tp__s = unArg_6.Elems();
  Set vdm_MOD_vl__s;
  Set res_s_9;
  {
    Sequence seq_lv_13;
    bool succ_11;
    Bool tsucc_14;
    tsucc_14 = true;
    {
      Set tmpVar_v_12;
      {
        Map unArg_16;
        Record tmpRec_17(vdm_AS_ParameterSig, length_AS_ParameterSig);
        tmpRec_17 = vdm_MOD_parms;
        if (tmpRec_17.Is(vdm_AS_ParameterSig)) 
          unArg_16 = tmpRec_17.GetField(pos_AS_ParameterSig_val);
        else 
          RunTime("Unknown record field selector");
        tmpVar_v_12 = unArg_16.Dom();
      }
{ seq_lv_13.ImpAppend(tmpVar_v_12); }
    }
    Set allComb_15 = GenAllComb(seq_lv_13);
    Record vdm_MOD_id(vdm_AS_Name, length_AS_Name);
    Generic tmpe_26;
    for (int bb_25 = allComb_15.First(tmpe_26); bb_25; bb_25 = allComb_15.Next(tmpe_26)) {
      Sequence tmp_23 = tmpe_26;
      {
        if (succ_11 = 1 == (Int) (tmp_23.Length())) {
          Record permI_24(vdm_AS_Name, length_AS_Name);
          permI_24 = (Record) (tmp_23.Hd());
          succ_11 = true;
          {
            vdm_MOD_id = permI_24;
            succ_11 = true;
          }
        }
        if (succ_11) 
          res_s_9.Insert(vdm_MOD_id);
      }
    }
  }
  vdm_MOD_vl__s = res_s_9;
  Set vdm_MOD_fn__s;
  Set res_s_28;
  {
    Sequence seq_lv_32;
    bool succ_30;
    Bool tsucc_33;
    tsucc_33 = true;
    {
      Set tmpVar_v_31;
      {
        Map unArg_35;
        Record tmpRec_36(vdm_AS_ParameterSig, length_AS_ParameterSig);
        tmpRec_36 = vdm_MOD_parms;
        if (tmpRec_36.Is(vdm_AS_ParameterSig)) 
          unArg_35 = tmpRec_36.GetField(pos_AS_ParameterSig_fns);
        else 
          RunTime("Unknown record field selector");
        tmpVar_v_31 = unArg_35.Dom();
      }
{ seq_lv_32.ImpAppend(tmpVar_v_31); }
    }
    Set allComb_34 = GenAllComb(seq_lv_32);
    Record vdm_MOD_id(vdm_AS_Name, length_AS_Name);
    Generic tmpe_45;
    for (int bb_44 = allComb_34.First(tmpe_45); bb_44; bb_44 = allComb_34.Next(tmpe_45)) {
      Sequence tmp_42 = tmpe_45;
      {
        if (succ_30 = 1 == (Int) (tmp_42.Length())) {
          Record permI_43(vdm_AS_Name, length_AS_Name);
          permI_43 = (Record) (tmp_42.Hd());
          succ_30 = true;
          {
            vdm_MOD_id = permI_43;
            succ_30 = true;
          }
        }
        if (succ_30) 
          res_s_28.Insert(vdm_MOD_id);
      }
    }
  }
  vdm_MOD_fn__s = res_s_28;
  {
    Set vdm_MOD_par__s;
    Set unArg_48;
    unArg_48 = Set().Insert(vdm_MOD_tp__s);
    unArg_48.Insert(vdm_MOD_vl__s);
    unArg_48.Insert(vdm_MOD_fn__s);
    {
      Set rduset_52;
      Generic tmpe_55;
      for (int bb_54 = unArg_48.First(tmpe_55); bb_54; bb_54 = unArg_48.Next(tmpe_55)) {
        Set e_53 = tmpe_55;
        rduset_52.ImpUnion(e_53);
      }
      vdm_MOD_par__s = rduset_52;
    }
    {
      Bool rexpr_56;
      rexpr_56 = (Bool) (vdm_MOD_par__s == vdm_MOD_id__s);
      return rexpr_56;
    }
  }
}

Bool vdm_MOD_IsInstantiated(Record vdm_MOD_mod__name) {
  bool succ_3;
  Record tmpVal_4;
  tmpVal_4 = vdm_MOD_GetModule(vdm_MOD_mod__name);
  Record vdm_MOD_sigmamo;
  succ_3 = true;
  {
    vdm_MOD_sigmamo = tmpVal_4;
    succ_3 = true;
  }
  if (!succ_3) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Bool rexpr_6;
    {
      Record tmpRec_7;
      tmpRec_7 = vdm_MOD_sigmamo;
      if (((Record) tmpRec_7).Is(vdm_GLOBAL_SigmaMO)) 
        rexpr_6 = ((Record) tmpRec_7).GetField(pos_GLOBAL_SigmaMO_been__inst);
      else 
        if (((Record) tmpRec_7).Is(vdm_GLOBAL_SigmaIMO)) 
          rexpr_6 = ((Record) tmpRec_7).GetField(pos_GLOBAL_SigmaIMO_been__inst);
        else 
          RunTime("Unknown record field selector");
    }
    return rexpr_6;
  }
}

Bool vdm_MOD_IsParameterized(Record var_1_1) {
  Generic vdm_MOD_par;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_Module == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          succ_2 = true;
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            succ_2 = false;
            if (permI_5.IsRecord()) 
              if (vdm_AS_Interface == ((Record) permI_5).GetTag()) {
                Sequence e_l_6;
                for (int i_7 = 1; i_7 <= ((Record) permI_5).Length(); i_7++) 
                  e_l_6.ImpAppend(((Record) permI_5).GetField(i_7));
                if (succ_2 = 4 == (Int) (e_l_6.Length())) {
                  Generic permI_8;
                  permI_8 = (Generic) (e_l_6.Hd());
                  succ_2 = true;
                  {
                    vdm_MOD_par = permI_8;
                    succ_2 = true;
                  }
                  permI_8 = (Generic) (e_l_6[2]);
                  if (succ_2) 
                    succ_2 = true;
                  permI_8 = (Generic) (e_l_6[3]);
                  if (succ_2) 
                    succ_2 = true;
                  permI_8 = (Generic) (e_l_6[4]);
                  if (succ_2) 
                    succ_2 = true;
                }
              }
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Bool rexpr_9;
    rexpr_9 = (Bool) (!(vdm_MOD_par == Nil()));
    return rexpr_9;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: IsParameterized");
}

Record vdm_MOD_MakeParMod(Record var_1_1, Record var_2_2) {
  Generic vdm_MOD_par;
  Record vdm_MOD_sigmamo(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_Module == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 3 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          succ_3 = true;
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) {
            succ_3 = false;
            if (permI_6.IsRecord()) 
              if (vdm_AS_Interface == ((Record) permI_6).GetTag()) {
                Sequence e_l_7;
                for (int i_8 = 1; i_8 <= ((Record) permI_6).Length(); i_8++) 
                  e_l_7.ImpAppend(((Record) permI_6).GetField(i_8));
                if (succ_3 = 4 == (Int) (e_l_7.Length())) {
                  Generic permI_9;
                  permI_9 = (Generic) (e_l_7.Hd());
                  succ_3 = true;
                  {
                    vdm_MOD_par = permI_9;
                    succ_3 = true;
                  }
                  permI_9 = (Generic) (e_l_7[2]);
                  if (succ_3) 
                    succ_3 = true;
                  permI_9 = (Generic) (e_l_7[3]);
                  if (succ_3) 
                    succ_3 = true;
                  permI_9 = (Generic) (e_l_7[4]);
                  if (succ_3) 
                    succ_3 = true;
                }
              }
          }
          permI_6 = (Generic) (e_l_4[3]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_MOD_sigmamo = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Record rexpr_10(vdm_GLOBAL_SigmaPMO, length_GLOBAL_SigmaPMO);
    {
      rexpr_10 = Record(vdm_GLOBAL_SigmaPMO, length_GLOBAL_SigmaPMO);
      rexpr_10.SetField(1, vdm_MOD_sigmamo);
      rexpr_10.SetField(2, vdm_MOD_par);
    }
    return rexpr_10;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: MakeParMod");
}

Map vdm_MOD_MakeRenamings(Record var_1_1, Map var_2_2) {
  Sequence vdm_MOD_mod__id;
  Map vdm_MOD_ren__m;
  bool succ_3 = true;
  {
    succ_3 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_Name == var_1_1.GetTag()) {
        Sequence e_l_4;
        for (int i_5 = 1; i_5 <= var_1_1.Length(); i_5++) 
          e_l_4.ImpAppend(var_1_1.GetField(i_5));
        if (succ_3 = 2 == (Int) (e_l_4.Length())) {
          Generic permI_6;
          permI_6 = (Generic) (e_l_4.Hd());
          succ_3 = true;
          {
            vdm_MOD_mod__id = permI_6;
            succ_3 = true;
          }
          permI_6 = (Generic) (e_l_4[2]);
          if (succ_3) 
            succ_3 = true;
        }
      }
  }
  {
    vdm_MOD_ren__m = var_2_2;
    succ_3 = true;
  }
  if (succ_3) {
    Map vdm_MOD_res__m;
    vdm_MOD_res__m = Map();
    {
      Set iset_7;
      iset_7 = vdm_MOD_ren__m.Dom();
      Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
      bool succ_9;
      Generic tmpe_30;
      for (int bb_29 = iset_7.First(tmpe_30); bb_29; bb_29 = iset_7.Next(tmpe_30)) {
        Record elem_8 = tmpe_30;
        {
          succ_9 = true;
          {
            vdm_MOD_nm = elem_8;
            succ_9 = true;
          }
          if (succ_9) {
            bool succ_11;
            Record tmpVal_12(vdm_AS_Name, length_AS_Name);
            {
              Map tmp_m_13;
              tmp_m_13 = vdm_MOD_ren__m;
              tmpVal_12 = (Record) (((Map) tmp_m_13)[vdm_MOD_nm]);
            }
            Sequence vdm_MOD_ren__nm;
            succ_11 = true;
            {
              succ_11 = false;
              if (tmpVal_12.IsRecord()) 
                if (vdm_AS_Name == tmpVal_12.GetTag()) {
                  Sequence e_l_15;
                  for (int i_16 = 1; i_16 <= tmpVal_12.Length(); i_16++) 
                    e_l_15.ImpAppend(tmpVal_12.GetField(i_16));
                  if (succ_11 = 2 == (Int) (e_l_15.Length())) {
                    Generic permI_17;
                    permI_17 = (Generic) (e_l_15.Hd());
                    succ_11 = true;
                    {
                      vdm_MOD_ren__nm = permI_17;
                      succ_11 = true;
                    }
                    permI_17 = (Generic) (e_l_15[2]);
                    if (succ_11) {
                      Generic tmpVal_18;
                      tmpVal_18 = Nil();
                      succ_11 = ((Bool) (permI_17 == tmpVal_18)).GetValue();
                    }
                  }
                }
            }
            if (!succ_11) 
              RunTime("Pattern match did not succeed in value definition");
            {
              Map rhs_19;
              {
                Map seqmap_20;
                seqmap_20 = vdm_MOD_res__m;
                Map modmap_21;
                {
                  Record tmpVar2_24(vdm_AS_Name, length_AS_Name);
                  {
                    tmpVar2_24 = Record(vdm_AS_Name, length_AS_Name);
                    Sequence tmpVar_25;
{ tmpVar_25.ImpConc(vdm_MOD_mod__id).ImpConc(vdm_MOD_ren__nm); }
                    tmpVar2_24.SetField(1, tmpVar_25);
                    tmpVar2_24.SetField(2, Nil());
                  }
                  modmap_21 = Map().Insert(vdm_MOD_nm, tmpVar2_24);
                }
                seqmap_20.ImpOverride(modmap_21);
                rhs_19 = seqmap_20;
              }
              vdm_MOD_res__m = rhs_19;
            }
          }
          else 
            RunTime("Pattern did not match in set for loop");
        }
      }
    }
    {
      Map rexpr_31;
      rexpr_31 = vdm_MOD_res__m;
      return rexpr_31;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: MakeRenamings");
}

Record vdm_MOD_TranslateImplModule(Record var_1_1) {
  Record vdm_MOD_intf(vdm_AS_ImplInterface, length_AS_ImplInterface);
  Record vdm_MOD_mod__id(vdm_AS_Name, length_AS_Name);
  Generic vdm_MOD_useslib;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_ImplModule == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_MOD_mod__id = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_MOD_intf = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_MOD_useslib = permI_5;
            succ_2 = true;
          }
        }
      }
  }
  if (succ_2) {
    Record vdm_MOD_sigmaimo(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
    {
      bool succ_6;
      Record tmpVal_7(vdm_AS_ImplInterface, length_AS_ImplInterface);
      tmpVal_7 = vdm_MOD_intf;
      Record vdm_MOD_exp(vdm_AS_ImplExportSig, length_AS_ImplExportSig);
      Map vdm_MOD_imp;
      succ_6 = true;
      {
        succ_6 = false;
        if (tmpVal_7.IsRecord()) 
          if (vdm_AS_ImplInterface == tmpVal_7.GetTag()) {
            Sequence e_l_8;
            for (int i_9 = 1; i_9 <= tmpVal_7.Length(); i_9++) 
              e_l_8.ImpAppend(tmpVal_7.GetField(i_9));
            if (succ_6 = 2 == (Int) (e_l_8.Length())) {
              Generic permI_10;
              permI_10 = (Generic) (e_l_8.Hd());
              succ_6 = true;
              {
                vdm_MOD_imp = permI_10;
                succ_6 = true;
              }
              permI_10 = (Generic) (e_l_8[2]);
              if (succ_6) {
                vdm_MOD_exp = permI_10;
                succ_6 = true;
              }
            }
          }
      }
      if (!succ_6) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Record rhs_11(vdm_AS_ImplExportSig, length_AS_ImplExportSig);
        rhs_11 = vdm_MOD_exp;
        Record mu_rhs_12(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);        {
          Record tmpRE_13(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
          tmpRE_13 = vdm_MOD_sigmaimo;
          int mu_14;
          mu_14 = pos_GLOBAL_SigmaIMO_exp;
          Record val_15(vdm_AS_ImplExportSig, length_AS_ImplExportSig);
          val_15 = vdm_MOD_exp;
          tmpRE_13.SetField(mu_14, val_15);
          mu_rhs_12 = tmpRE_13;
        }        vdm_MOD_sigmaimo = mu_rhs_12;
        {
          Map rhs_16;
          rhs_16 = Map();
          Record mu_rhs_17(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);          {
            Record tmpRE_18(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
            tmpRE_18 = vdm_MOD_sigmaimo;
            int mu_19;
            mu_19 = pos_GLOBAL_SigmaIMO_imp;
            Map val_20;
            val_20 = Map();
            tmpRE_18.SetField(mu_19, val_20);
            mu_rhs_17 = tmpRE_18;
          }          vdm_MOD_sigmaimo = mu_rhs_17;
        }
        {
          Set rhs_21;
          rhs_21 = vdm_MOD_imp.Dom();
          Record mu_rhs_23(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);          {
            Record tmpRE_24(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
            tmpRE_24 = vdm_MOD_sigmaimo;
            int mu_25;
            mu_25 = pos_GLOBAL_SigmaIMO_modid__s;
            Set val_26;
            val_26 = vdm_MOD_imp.Dom();
            tmpRE_24.SetField(mu_25, val_26);
            mu_rhs_23 = tmpRE_24;
          }          vdm_MOD_sigmaimo = mu_rhs_23;
        }
        {
          Map rhs_28;
          rhs_28 = Map();
          Record mu_rhs_29(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);          {
            Record tmpRE_30(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
            tmpRE_30 = vdm_MOD_sigmaimo;
            int mu_31;
            mu_31 = pos_GLOBAL_SigmaIMO_ren;
            Map val_32;
            val_32 = Map();
            tmpRE_30.SetField(mu_31, val_32);
            mu_rhs_29 = tmpRE_30;
          }          vdm_MOD_sigmaimo = mu_rhs_29;
        }
        {
          Generic rhs_33;
          rhs_33 = vdm_MOD_useslib;
          Record mu_rhs_34(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);          {
            Record tmpRE_35(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
            tmpRE_35 = vdm_MOD_sigmaimo;
            int mu_36;
            mu_36 = pos_GLOBAL_SigmaIMO_useslib;
            Generic val_37;
            val_37 = vdm_MOD_useslib;
            tmpRE_35.SetField(mu_36, val_37);
            mu_rhs_34 = tmpRE_35;
          }          vdm_MOD_sigmaimo = mu_rhs_34;
        }
        {
          Record vdm_MOD_sigmaexp(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
          vdm_MOD_sigmaexp = vdm_MOD_TranslateImplExportSig(vdm_MOD_mod__id, vdm_MOD_exp, vdm_MOD_useslib);
          {
            Map rhs_41;
            {
              Record tmpRec_42(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
              tmpRec_42 = vdm_MOD_sigmaexp;
              if (tmpRec_42.Is(vdm_GLOBAL_SigmaEXP)) 
                rhs_41 = tmpRec_42.GetField(pos_GLOBAL_SigmaEXP_extfns);
              else 
                RunTime("Unknown record field selector");
            }
            Record mu_rhs_43(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);            {
              Record tmpRE_44(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
              tmpRE_44 = vdm_MOD_sigmaimo;
              int mu_45;
              mu_45 = pos_GLOBAL_SigmaIMO_extfns;
              Map val_46;
              {
                Record tmpRec_47(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
                tmpRec_47 = vdm_MOD_sigmaexp;
                if (tmpRec_47.Is(vdm_GLOBAL_SigmaEXP)) 
                  val_46 = tmpRec_47.GetField(pos_GLOBAL_SigmaEXP_extfns);
                else 
                  RunTime("Unknown record field selector");
              }
              tmpRE_44.SetField(mu_45, val_46);
              mu_rhs_43 = tmpRE_44;
            }            vdm_MOD_sigmaimo = mu_rhs_43;
          }
          {
            Map rhs_48;
            {
              Record tmpRec_49(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
              tmpRec_49 = vdm_MOD_sigmaexp;
              if (tmpRec_49.Is(vdm_GLOBAL_SigmaEXP)) 
                rhs_48 = tmpRec_49.GetField(pos_GLOBAL_SigmaEXP_extops);
              else 
                RunTime("Unknown record field selector");
            }
            Record mu_rhs_50(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);            {
              Record tmpRE_51(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
              tmpRE_51 = vdm_MOD_sigmaimo;
              int mu_52;
              mu_52 = pos_GLOBAL_SigmaIMO_extops;
              Map val_53;
              {
                Record tmpRec_54(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
                tmpRec_54 = vdm_MOD_sigmaexp;
                if (tmpRec_54.Is(vdm_GLOBAL_SigmaEXP)) 
                  val_53 = tmpRec_54.GetField(pos_GLOBAL_SigmaEXP_extops);
                else 
                  RunTime("Unknown record field selector");
              }
              tmpRE_51.SetField(mu_52, val_53);
              mu_rhs_50 = tmpRE_51;
            }            vdm_MOD_sigmaimo = mu_rhs_50;
          }
          {
            Generic rhs_55;
            {
              Record tmpRec_56(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
              tmpRec_56 = vdm_MOD_sigmaexp;
              if (tmpRec_56.Is(vdm_GLOBAL_SigmaEXP)) 
                rhs_55 = tmpRec_56.GetField(pos_GLOBAL_SigmaEXP_extv);
              else 
                RunTime("Unknown record field selector");
            }
            Record mu_rhs_57(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);            {
              Record tmpRE_58(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
              tmpRE_58 = vdm_MOD_sigmaimo;
              int mu_59;
              mu_59 = pos_GLOBAL_SigmaIMO_extv;
              Generic val_60;
              {
                Record tmpRec_61(vdm_GLOBAL_SigmaEXP, length_GLOBAL_SigmaEXP);
                tmpRec_61 = vdm_MOD_sigmaexp;
                if (tmpRec_61.Is(vdm_GLOBAL_SigmaEXP)) 
                  val_60 = tmpRec_61.GetField(pos_GLOBAL_SigmaEXP_extv);
                else 
                  RunTime("Unknown record field selector");
              }
              tmpRE_58.SetField(mu_59, val_60);
              mu_rhs_57 = tmpRE_58;
            }            vdm_MOD_sigmaimo = mu_rhs_57;
          }
        }
        {
          Bool rhs_62;
          rhs_62 = (Bool) true;
          Record mu_rhs_63(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);          {
            Record tmpRE_64(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
            tmpRE_64 = vdm_MOD_sigmaimo;
            int mu_65;
            mu_65 = pos_GLOBAL_SigmaIMO_been__inst;
            Bool val_66;
            val_66 = (Bool) true;
            tmpRE_64.SetField(mu_65, val_66);
            mu_rhs_63 = tmpRE_64;
          }          vdm_MOD_sigmaimo = mu_rhs_63;
        }
      }
    }
    {
      Map rhs_67;
      rhs_67 = Map();
      Record mu_rhs_68(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);      {
        Record tmpRE_69(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
        tmpRE_69 = vdm_MOD_sigmaimo;
        int mu_70;
        mu_70 = pos_GLOBAL_SigmaIMO_alias;
        Map val_71;
        val_71 = Map();
        tmpRE_69.SetField(mu_70, val_71);
        mu_rhs_68 = tmpRE_69;
      }      vdm_MOD_sigmaimo = mu_rhs_68;
    }
    {
      Record rexpr_72(vdm_GLOBAL_SigmaIMO, length_GLOBAL_SigmaIMO);
      rexpr_72 = vdm_MOD_sigmaimo;
      return rexpr_72;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: TranslateImplModule");
}

Record vdm_MOD_TranslateModule(Record var_1_1) {
  Generic vdm_MOD_body;
  Record vdm_MOD_intf(vdm_AS_Interface, length_AS_Interface);
  Record vdm_MOD_mod__id(vdm_AS_Name, length_AS_Name);
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_Module == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_MOD_mod__id = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_MOD_intf = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_MOD_body = permI_5;
            succ_2 = true;
          }
        }
      }
  }
  if (succ_2) {
    Record vdm_MOD_sigmamo(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
    {
      bool succ_6;
      Record tmpVal_7(vdm_AS_Interface, length_AS_Interface);
      tmpVal_7 = vdm_MOD_intf;
      Generic vdm_MOD_exp;
      Map vdm_MOD_imp;
      Map vdm_MOD_inst;
      succ_6 = true;
      {
        succ_6 = false;
        if (tmpVal_7.IsRecord()) 
          if (vdm_AS_Interface == tmpVal_7.GetTag()) {
            Sequence e_l_8;
            for (int i_9 = 1; i_9 <= tmpVal_7.Length(); i_9++) 
              e_l_8.ImpAppend(tmpVal_7.GetField(i_9));
            if (succ_6 = 4 == (Int) (e_l_8.Length())) {
              Generic permI_10;
              permI_10 = (Generic) (e_l_8.Hd());
              succ_6 = true;
              succ_6 = true;
              permI_10 = (Generic) (e_l_8[2]);
              if (succ_6) {
                vdm_MOD_imp = permI_10;
                succ_6 = true;
              }
              permI_10 = (Generic) (e_l_8[3]);
              if (succ_6) {
                vdm_MOD_exp = permI_10;
                succ_6 = true;
              }
              permI_10 = (Generic) (e_l_8[4]);
              if (succ_6) {
                vdm_MOD_inst = permI_10;
                succ_6 = true;
              }
            }
          }
      }
      if (!succ_6) 
        RunTime("Pattern match did not succeed in value definition");
      {
        Generic rhs_11;
        rhs_11 = vdm_MOD_exp;
        Record mu_rhs_12(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);        {
          Record tmpRE_13(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
          tmpRE_13 = vdm_MOD_sigmamo;
          int mu_14;
          mu_14 = pos_GLOBAL_SigmaMO_exp;
          Generic val_15;
          val_15 = vdm_MOD_exp;
          tmpRE_13.SetField(mu_14, val_15);
          mu_rhs_12 = tmpRE_13;
        }        vdm_MOD_sigmamo = mu_rhs_12;
        {
          Map rhs_16;
          rhs_16 = Map();
          Record mu_rhs_17(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_18(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_18 = vdm_MOD_sigmamo;
            int mu_19;
            mu_19 = pos_GLOBAL_SigmaMO_imp;
            Map val_20;
            val_20 = Map();
            tmpRE_18.SetField(mu_19, val_20);
            mu_rhs_17 = tmpRE_18;
          }          vdm_MOD_sigmamo = mu_rhs_17;
        }
        {
          Set rhs_21;
          rhs_21 = vdm_MOD_imp.Dom();
          Record mu_rhs_23(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_24(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_24 = vdm_MOD_sigmamo;
            int mu_25;
            mu_25 = pos_GLOBAL_SigmaMO_modid__s;
            Set val_26;
            val_26 = vdm_MOD_imp.Dom();
            tmpRE_24.SetField(mu_25, val_26);
            mu_rhs_23 = tmpRE_24;
          }          vdm_MOD_sigmamo = mu_rhs_23;
        }
        {
          Map rhs_28;
          rhs_28 = vdm_MOD_BuildRenameMap(vdm_MOD_imp);
          Record mu_rhs_30(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_31(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_31 = vdm_MOD_sigmamo;
            int mu_32;
            mu_32 = pos_GLOBAL_SigmaMO_ren;
            Map val_33;
            val_33 = vdm_MOD_BuildRenameMap(vdm_MOD_imp);
            tmpRE_31.SetField(mu_32, val_33);
            mu_rhs_30 = tmpRE_31;
          }          vdm_MOD_sigmamo = mu_rhs_30;
        }
        {
          Map rhs_35;
          rhs_35 = vdm_MOD_inst;
          Record mu_rhs_36(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_37(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_37 = vdm_MOD_sigmamo;
            int mu_38;
            mu_38 = pos_GLOBAL_SigmaMO_inst;
            Map val_39;
            val_39 = vdm_MOD_inst;
            tmpRE_37.SetField(mu_38, val_39);
            mu_rhs_36 = tmpRE_37;
          }          vdm_MOD_sigmamo = mu_rhs_36;
        }
      }
    }
    {
      Bool cond_40;
      cond_40 = (Bool) (!(vdm_MOD_body == Nil()));
      if (cond_40.GetValue()) {
        Record vdm_MOD_sigmadefs(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
        vdm_MOD_sigmadefs = vdm_MOD_TranslateDefinitions(vdm_MOD_mod__id, vdm_MOD_body);
        {
          Map rhs_45;
          {
            Record tmpRec_46(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_46 = vdm_MOD_sigmadefs;
            if (tmpRec_46.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_45 = tmpRec_46.GetField(pos_GLOBAL_SigmaDEFS_explfns);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_47(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_48(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_48 = vdm_MOD_sigmamo;
            int mu_49;
            mu_49 = pos_GLOBAL_SigmaMO_explfns;
            Map val_50;
            {
              Record tmpRec_51(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_51 = vdm_MOD_sigmadefs;
              if (tmpRec_51.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_50 = tmpRec_51.GetField(pos_GLOBAL_SigmaDEFS_explfns);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_48.SetField(mu_49, val_50);
            mu_rhs_47 = tmpRE_48;
          }          vdm_MOD_sigmamo = mu_rhs_47;
        }
        {
          Map rhs_52;
          {
            Record tmpRec_53(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_53 = vdm_MOD_sigmadefs;
            if (tmpRec_53.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_52 = tmpRec_53.GetField(pos_GLOBAL_SigmaDEFS_implfns);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_54(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_55(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_55 = vdm_MOD_sigmamo;
            int mu_56;
            mu_56 = pos_GLOBAL_SigmaMO_implfns;
            Map val_57;
            {
              Record tmpRec_58(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_58 = vdm_MOD_sigmadefs;
              if (tmpRec_58.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_57 = tmpRec_58.GetField(pos_GLOBAL_SigmaDEFS_implfns);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_55.SetField(mu_56, val_57);
            mu_rhs_54 = tmpRE_55;
          }          vdm_MOD_sigmamo = mu_rhs_54;
        }
        {
          Map rhs_59;
          {
            Record tmpRec_60(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_60 = vdm_MOD_sigmadefs;
            if (tmpRec_60.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_59 = tmpRec_60.GetField(pos_GLOBAL_SigmaDEFS_explops);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_61(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_62(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_62 = vdm_MOD_sigmamo;
            int mu_63;
            mu_63 = pos_GLOBAL_SigmaMO_explops;
            Map val_64;
            {
              Record tmpRec_65(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_65 = vdm_MOD_sigmadefs;
              if (tmpRec_65.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_64 = tmpRec_65.GetField(pos_GLOBAL_SigmaDEFS_explops);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_62.SetField(mu_63, val_64);
            mu_rhs_61 = tmpRE_62;
          }          vdm_MOD_sigmamo = mu_rhs_61;
        }
        {
          Map rhs_66;
          {
            Record tmpRec_67(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_67 = vdm_MOD_sigmadefs;
            if (tmpRec_67.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_66 = tmpRec_67.GetField(pos_GLOBAL_SigmaDEFS_implops);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_68(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_69(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_69 = vdm_MOD_sigmamo;
            int mu_70;
            mu_70 = pos_GLOBAL_SigmaMO_implops;
            Map val_71;
            {
              Record tmpRec_72(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_72 = vdm_MOD_sigmadefs;
              if (tmpRec_72.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_71 = tmpRec_72.GetField(pos_GLOBAL_SigmaDEFS_implops);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_69.SetField(mu_70, val_71);
            mu_rhs_68 = tmpRE_69;
          }          vdm_MOD_sigmamo = mu_rhs_68;
        }
        {
          Map rhs_73;
          {
            Record tmpRec_74(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_74 = vdm_MOD_sigmadefs;
            if (tmpRec_74.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_73 = tmpRec_74.GetField(pos_GLOBAL_SigmaDEFS_explpolys);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_75(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_76(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_76 = vdm_MOD_sigmamo;
            int mu_77;
            mu_77 = pos_GLOBAL_SigmaMO_explpolys;
            Map val_78;
            {
              Record tmpRec_79(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_79 = vdm_MOD_sigmadefs;
              if (tmpRec_79.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_78 = tmpRec_79.GetField(pos_GLOBAL_SigmaDEFS_explpolys);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_76.SetField(mu_77, val_78);
            mu_rhs_75 = tmpRE_76;
          }          vdm_MOD_sigmamo = mu_rhs_75;
        }
        {
          Map rhs_80;
          {
            Record tmpRec_81(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_81 = vdm_MOD_sigmadefs;
            if (tmpRec_81.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_80 = tmpRec_81.GetField(pos_GLOBAL_SigmaDEFS_implpolys);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_82(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_83(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_83 = vdm_MOD_sigmamo;
            int mu_84;
            mu_84 = pos_GLOBAL_SigmaMO_implpolys;
            Map val_85;
            {
              Record tmpRec_86(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_86 = vdm_MOD_sigmadefs;
              if (tmpRec_86.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_85 = tmpRec_86.GetField(pos_GLOBAL_SigmaDEFS_implpolys);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_83.SetField(mu_84, val_85);
            mu_rhs_82 = tmpRE_83;
          }          vdm_MOD_sigmamo = mu_rhs_82;
        }
        {
          Map rhs_87;
          {
            Record tmpRec_88(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_88 = vdm_MOD_sigmadefs;
            if (tmpRec_88.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_87 = tmpRec_88.GetField(pos_GLOBAL_SigmaDEFS_tps);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_89(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_90(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_90 = vdm_MOD_sigmamo;
            int mu_91;
            mu_91 = pos_GLOBAL_SigmaMO_tps;
            Map val_92;
            {
              Record tmpRec_93(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_93 = vdm_MOD_sigmadefs;
              if (tmpRec_93.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_92 = tmpRec_93.GetField(pos_GLOBAL_SigmaDEFS_tps);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_90.SetField(mu_91, val_92);
            mu_rhs_89 = tmpRE_90;
          }          vdm_MOD_sigmamo = mu_rhs_89;
        }
        {
          Map rhs_94;
          {
            Record tmpRec_95(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_95 = vdm_MOD_sigmadefs;
            if (tmpRec_95.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_94 = tmpRec_95.GetField(pos_GLOBAL_SigmaDEFS_recsel);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_96(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_97(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_97 = vdm_MOD_sigmamo;
            int mu_98;
            mu_98 = pos_GLOBAL_SigmaMO_recsel;
            Map val_99;
            {
              Record tmpRec_100(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_100 = vdm_MOD_sigmadefs;
              if (tmpRec_100.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_99 = tmpRec_100.GetField(pos_GLOBAL_SigmaDEFS_recsel);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_97.SetField(mu_98, val_99);
            mu_rhs_96 = tmpRE_97;
          }          vdm_MOD_sigmamo = mu_rhs_96;
        }
        {
          Generic rhs_101;
          rhs_101 = Nil();
          Record mu_rhs_102(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_103(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_103 = vdm_MOD_sigmamo;
            int mu_104;
            mu_104 = pos_GLOBAL_SigmaMO_gv;
            Generic val_105;
            val_105 = Nil();
            tmpRE_103.SetField(mu_104, val_105);
            mu_rhs_102 = tmpRE_103;
          }          vdm_MOD_sigmamo = mu_rhs_102;
        }
        {
          Sequence rhs_106;
          {
            Record tmpRec_107(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_107 = vdm_MOD_sigmadefs;
            if (tmpRec_107.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_106 = tmpRec_107.GetField(pos_GLOBAL_SigmaDEFS_gv__init);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_108(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_109(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_109 = vdm_MOD_sigmamo;
            int mu_110;
            mu_110 = pos_GLOBAL_SigmaMO_gv__init;
            Sequence val_111;
            {
              Record tmpRec_112(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_112 = vdm_MOD_sigmadefs;
              if (tmpRec_112.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_111 = tmpRec_112.GetField(pos_GLOBAL_SigmaDEFS_gv__init);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_109.SetField(mu_110, val_111);
            mu_rhs_108 = tmpRE_109;
          }          vdm_MOD_sigmamo = mu_rhs_108;
        }
        {
          Sequence rhs_113;
          rhs_113 = Sequence();
          Record mu_rhs_114(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_115(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_115 = vdm_MOD_sigmamo;
            int mu_116;
            mu_116 = pos_GLOBAL_SigmaMO_gv__inst;
            Sequence val_117;
            val_117 = Sequence();
            tmpRE_115.SetField(mu_116, val_117);
            mu_rhs_114 = tmpRE_115;
          }          vdm_MOD_sigmamo = mu_rhs_114;
        }
        {
          Sequence rhs_118;
          {
            Map tmpVar_119;
            tmpVar_119 = Map();
            rhs_118 = Sequence().ImpAppend(tmpVar_119);
          }
          Record mu_rhs_120(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_121(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_121 = vdm_MOD_sigmamo;
            int mu_122;
            mu_122 = pos_GLOBAL_SigmaMO_gs__l;
            Sequence val_123;
            {
              Map tmpVar_124;
              tmpVar_124 = Map();
              val_123 = Sequence().ImpAppend(tmpVar_124);
            }
            tmpRE_121.SetField(mu_122, val_123);
            mu_rhs_120 = tmpRE_121;
          }          vdm_MOD_sigmamo = mu_rhs_120;
        }
        {
          Generic rhs_125;
          {
            Record tmpRec_126(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_126 = vdm_MOD_sigmadefs;
            if (tmpRec_126.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_125 = tmpRec_126.GetField(pos_GLOBAL_SigmaDEFS_gs__init);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_127(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_128(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_128 = vdm_MOD_sigmamo;
            int mu_129;
            mu_129 = pos_GLOBAL_SigmaMO_gs__init;
            Generic val_130;
            {
              Record tmpRec_131(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_131 = vdm_MOD_sigmadefs;
              if (tmpRec_131.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_130 = tmpRec_131.GetField(pos_GLOBAL_SigmaDEFS_gs__init);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_128.SetField(mu_129, val_130);
            mu_rhs_127 = tmpRE_128;
          }          vdm_MOD_sigmamo = mu_rhs_127;
        }
        {
          Generic rhs_132;
          {
            Record tmpRec_133(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_133 = vdm_MOD_sigmadefs;
            if (tmpRec_133.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_132 = tmpRec_133.GetField(pos_GLOBAL_SigmaDEFS_stp__id);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_134(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_135(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_135 = vdm_MOD_sigmamo;
            int mu_136;
            mu_136 = pos_GLOBAL_SigmaMO_stp__id;
            Generic val_137;
            {
              Record tmpRec_138(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_138 = vdm_MOD_sigmadefs;
              if (tmpRec_138.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_137 = tmpRec_138.GetField(pos_GLOBAL_SigmaDEFS_stp__id);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_135.SetField(mu_136, val_137);
            mu_rhs_134 = tmpRE_135;
          }          vdm_MOD_sigmamo = mu_rhs_134;
        }
        {
          Generic rhs_139;
          {
            Record tmpRec_140(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
            tmpRec_140 = vdm_MOD_sigmadefs;
            if (tmpRec_140.Is(vdm_GLOBAL_SigmaDEFS)) 
              rhs_139 = tmpRec_140.GetField(pos_GLOBAL_SigmaDEFS_stateinv);
            else 
              RunTime("Unknown record field selector");
          }
          Record mu_rhs_141(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_142(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_142 = vdm_MOD_sigmamo;
            int mu_143;
            mu_143 = pos_GLOBAL_SigmaMO_stateinv;
            Generic val_144;
            {
              Record tmpRec_145(vdm_GLOBAL_SigmaDEFS, length_GLOBAL_SigmaDEFS);
              tmpRec_145 = vdm_MOD_sigmadefs;
              if (tmpRec_145.Is(vdm_GLOBAL_SigmaDEFS)) 
                val_144 = tmpRec_145.GetField(pos_GLOBAL_SigmaDEFS_stateinv);
              else 
                RunTime("Unknown record field selector");
            }
            tmpRE_142.SetField(mu_143, val_144);
            mu_rhs_141 = tmpRE_142;
          }          vdm_MOD_sigmamo = mu_rhs_141;
        }
        {
          Bool rhs_146;
          {
            Map var1_147;
            Record tmpRec_149(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRec_149 = vdm_MOD_sigmamo;
            if (tmpRec_149.Is(vdm_GLOBAL_SigmaMO)) 
              var1_147 = tmpRec_149.GetField(pos_GLOBAL_SigmaMO_inst);
            else 
              RunTime("Unknown record field selector");
            Map var2_148;
            var2_148 = Map();
            rhs_146 = (Bool) (var1_147 == var2_148);
          }
          Record mu_rhs_150(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_151(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_151 = vdm_MOD_sigmamo;
            int mu_152;
            mu_152 = pos_GLOBAL_SigmaMO_been__inst;
            Bool val_153;
            {
              Map var1_154;
              Record tmpRec_156(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_156 = vdm_MOD_sigmamo;
              if (tmpRec_156.Is(vdm_GLOBAL_SigmaMO)) 
                var1_154 = tmpRec_156.GetField(pos_GLOBAL_SigmaMO_inst);
              else 
                RunTime("Unknown record field selector");
              Map var2_155;
              var2_155 = Map();
              val_153 = (Bool) (var1_154 == var2_155);
            }
            tmpRE_151.SetField(mu_152, val_153);
            mu_rhs_150 = tmpRE_151;
          }          vdm_MOD_sigmamo = mu_rhs_150;
        }
        {
          Generic rhs_157;
          {
            Generic tmpVar_158;
            {
              Record tmpRec_159(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_159 = vdm_MOD_sigmamo;
              if (tmpRec_159.Is(vdm_GLOBAL_SigmaMO)) 
                tmpVar_158 = tmpRec_159.GetField(pos_GLOBAL_SigmaMO_exp);
              else 
                RunTime("Unknown record field selector");
            }
            Map tmpVar_161;
            {
              Record tmpRec_162(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_162 = vdm_MOD_sigmamo;
              if (tmpRec_162.Is(vdm_GLOBAL_SigmaMO)) 
                tmpVar_161 = tmpRec_162.GetField(pos_GLOBAL_SigmaMO_ren);
              else 
                RunTime("Unknown record field selector");
            }
            rhs_157 = vdm_MOD_BuildExportSig(tmpVar_158, vdm_MOD_sigmadefs, tmpVar_161);
          }
          Record mu_rhs_163(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);          {
            Record tmpRE_164(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRE_164 = vdm_MOD_sigmamo;
            int mu_165;
            mu_165 = pos_GLOBAL_SigmaMO_exp;
            Generic val_166;
            {
              Generic tmpVar_167;
              {
                Record tmpRec_168(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                tmpRec_168 = vdm_MOD_sigmamo;
                if (tmpRec_168.Is(vdm_GLOBAL_SigmaMO)) 
                  tmpVar_167 = tmpRec_168.GetField(pos_GLOBAL_SigmaMO_exp);
                else 
                  RunTime("Unknown record field selector");
              }
              Map tmpVar_170;
              {
                Record tmpRec_171(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                tmpRec_171 = vdm_MOD_sigmamo;
                if (tmpRec_171.Is(vdm_GLOBAL_SigmaMO)) 
                  tmpVar_170 = tmpRec_171.GetField(pos_GLOBAL_SigmaMO_ren);
                else 
                  RunTime("Unknown record field selector");
              }
              val_166 = vdm_MOD_BuildExportSig(tmpVar_167, vdm_MOD_sigmadefs, tmpVar_170);
            }
            tmpRE_164.SetField(mu_165, val_166);
            mu_rhs_163 = tmpRE_164;
          }          vdm_MOD_sigmamo = mu_rhs_163;
        }
      }
    }
    {
      Map rhs_172;
      rhs_172 = Map();
      Record mu_rhs_173(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);      {
        Record tmpRE_174(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
        tmpRE_174 = vdm_MOD_sigmamo;
        int mu_175;
        mu_175 = pos_GLOBAL_SigmaMO_alias;
        Map val_176;
        val_176 = Map();
        tmpRE_174.SetField(mu_175, val_176);
        mu_rhs_173 = tmpRE_174;
      }      vdm_MOD_sigmamo = mu_rhs_173;
    }
    {
      Record rexpr_177(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
      rexpr_177 = vdm_MOD_sigmamo;
      return rexpr_177;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: TranslateModule");
}

Map vdm_MOD_UpdateBasicType(Record vdm_MOD_id, Record vdm_MOD_btp) {
  Map rexpr_4;
  {
    Record tmpVar2_6(vdm_AS_TypeDef, length_AS_TypeDef);
    {
      tmpVar2_6 = Record(vdm_AS_TypeDef, length_AS_TypeDef);
      tmpVar2_6.SetField(1, vdm_MOD_id);
      tmpVar2_6.SetField(2, vdm_MOD_btp);
      tmpVar2_6.SetField(3, Nil());
    }
    rexpr_4 = Map().Insert(vdm_MOD_id, tmpVar2_6);
  }
  return rexpr_4;
}

Record vdm_MOD_UpdateFnAndOps(Record vdm_MOD_inst__nm, Record vdm_MOD_sigmamo) {
  Record vdm_MOD_new__sigmamo(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
  vdm_MOD_new__sigmamo = vdm_MOD_sigmamo;
  {
    Map rhs_4;
    {
      Map res_m_5;
      Record mr_7(vdm_SEM_ExplFN, length_SEM_ExplFN);
      {
        Sequence seq_lv_16;
        bool succ_14;
        Bool tsucc_17;
        tsucc_17 = true;
        {
          Set tmpVar_v_15;
          {
            Map unArg_19;
            Record tmpRec_20(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRec_20 = vdm_MOD_sigmamo;
            if (tmpRec_20.Is(vdm_GLOBAL_SigmaMO)) 
              unArg_19 = tmpRec_20.GetField(pos_GLOBAL_SigmaMO_explfns);
            else 
              RunTime("Unknown record field selector");
            tmpVar_v_15 = unArg_19.Dom();
          }
{ seq_lv_16.ImpAppend(tmpVar_v_15); }
        }
        Set allComb_18 = GenAllComb(seq_lv_16);
        Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
        Generic tmpe_29;
        for (int bb_28 = allComb_18.First(tmpe_29); bb_28; bb_28 = allComb_18.Next(tmpe_29)) {
          Sequence tmp_26 = tmpe_29;
          {
            if (succ_14 = 1 == (Int) (tmp_26.Length())) {
              Record permI_27(vdm_AS_Name, length_AS_Name);
              permI_27 = (Record) (tmp_26.Hd());
              succ_14 = true;
              {
                vdm_MOD_nm = permI_27;
                succ_14 = true;
              }
            }
            if (succ_14) {
              Record tmpRE_8(vdm_SEM_ExplFN, length_SEM_ExplFN);
              {
                Map tmp_m_9;
                {
                  Record tmpRec_11(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRec_11 = vdm_MOD_sigmamo;
                  if (tmpRec_11.Is(vdm_GLOBAL_SigmaMO)) 
                    tmp_m_9 = tmpRec_11.GetField(pos_GLOBAL_SigmaMO_explfns);
                  else 
                    RunTime("Unknown record field selector");
                }
                tmpRE_8 = (Record) (((Map) tmp_m_9)[vdm_MOD_nm]);
              }
              int mu_12;
              mu_12 = pos_SEM_ExplFN_modName;
              Record val_13(vdm_AS_Name, length_AS_Name);
              val_13 = vdm_MOD_inst__nm;
              tmpRE_8.SetField(mu_12, val_13);
              mr_7 = tmpRE_8;
              res_m_5.Insert(vdm_MOD_nm, mr_7);
            }
          }
        }
      }
      rhs_4 = res_m_5;
    }
    Record mu_rhs_30(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);    {
      Record tmpRE_31(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
      tmpRE_31 = vdm_MOD_new__sigmamo;
      int mu_32;
      mu_32 = pos_GLOBAL_SigmaMO_explfns;
      Map val_33;
      {
        Map res_m_34;
        Record mr_36(vdm_SEM_ExplFN, length_SEM_ExplFN);
        {
          Sequence seq_lv_45;
          bool succ_43;
          Bool tsucc_46;
          tsucc_46 = true;
          {
            Set tmpVar_v_44;
            {
              Map unArg_48;
              Record tmpRec_49(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_49 = vdm_MOD_sigmamo;
              if (tmpRec_49.Is(vdm_GLOBAL_SigmaMO)) 
                unArg_48 = tmpRec_49.GetField(pos_GLOBAL_SigmaMO_explfns);
              else 
                RunTime("Unknown record field selector");
              tmpVar_v_44 = unArg_48.Dom();
            }
{ seq_lv_45.ImpAppend(tmpVar_v_44); }
          }
          Set allComb_47 = GenAllComb(seq_lv_45);
          Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
          Generic tmpe_58;
          for (int bb_57 = allComb_47.First(tmpe_58); bb_57; bb_57 = allComb_47.Next(tmpe_58)) {
            Sequence tmp_55 = tmpe_58;
            {
              if (succ_43 = 1 == (Int) (tmp_55.Length())) {
                Record permI_56(vdm_AS_Name, length_AS_Name);
                permI_56 = (Record) (tmp_55.Hd());
                succ_43 = true;
                {
                  vdm_MOD_nm = permI_56;
                  succ_43 = true;
                }
              }
              if (succ_43) {
                Record tmpRE_37(vdm_SEM_ExplFN, length_SEM_ExplFN);
                {
                  Map tmp_m_38;
                  {
                    Record tmpRec_40(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_40 = vdm_MOD_sigmamo;
                    if (tmpRec_40.Is(vdm_GLOBAL_SigmaMO)) 
                      tmp_m_38 = tmpRec_40.GetField(pos_GLOBAL_SigmaMO_explfns);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  tmpRE_37 = (Record) (((Map) tmp_m_38)[vdm_MOD_nm]);
                }
                int mu_41;
                mu_41 = pos_SEM_ExplFN_modName;
                Record val_42(vdm_AS_Name, length_AS_Name);
                val_42 = vdm_MOD_inst__nm;
                tmpRE_37.SetField(mu_41, val_42);
                mr_36 = tmpRE_37;
                res_m_34.Insert(vdm_MOD_nm, mr_36);
              }
            }
          }
        }
        val_33 = res_m_34;
      }
      tmpRE_31.SetField(mu_32, val_33);
      mu_rhs_30 = tmpRE_31;
    }    vdm_MOD_new__sigmamo = mu_rhs_30;
  }
  {
    Map rhs_59;
    {
      Map res_m_60;
      Record mr_62(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
      {
        Sequence seq_lv_71;
        bool succ_69;
        Bool tsucc_72;
        tsucc_72 = true;
        {
          Set tmpVar_v_70;
          {
            Map unArg_74;
            Record tmpRec_75(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRec_75 = vdm_MOD_sigmamo;
            if (tmpRec_75.Is(vdm_GLOBAL_SigmaMO)) 
              unArg_74 = tmpRec_75.GetField(pos_GLOBAL_SigmaMO_explpolys);
            else 
              RunTime("Unknown record field selector");
            tmpVar_v_70 = unArg_74.Dom();
          }
{ seq_lv_71.ImpAppend(tmpVar_v_70); }
        }
        Set allComb_73 = GenAllComb(seq_lv_71);
        Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
        Generic tmpe_84;
        for (int bb_83 = allComb_73.First(tmpe_84); bb_83; bb_83 = allComb_73.Next(tmpe_84)) {
          Sequence tmp_81 = tmpe_84;
          {
            if (succ_69 = 1 == (Int) (tmp_81.Length())) {
              Record permI_82(vdm_AS_Name, length_AS_Name);
              permI_82 = (Record) (tmp_81.Hd());
              succ_69 = true;
              {
                vdm_MOD_nm = permI_82;
                succ_69 = true;
              }
            }
            if (succ_69) {
              Record tmpRE_63(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
              {
                Map tmp_m_64;
                {
                  Record tmpRec_66(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRec_66 = vdm_MOD_sigmamo;
                  if (tmpRec_66.Is(vdm_GLOBAL_SigmaMO)) 
                    tmp_m_64 = tmpRec_66.GetField(pos_GLOBAL_SigmaMO_explpolys);
                  else 
                    RunTime("Unknown record field selector");
                }
                tmpRE_63 = (Record) (((Map) tmp_m_64)[vdm_MOD_nm]);
              }
              int mu_67;
              mu_67 = pos_SEM_ExplPOLY_modName;
              Record val_68(vdm_AS_Name, length_AS_Name);
              val_68 = vdm_MOD_inst__nm;
              tmpRE_63.SetField(mu_67, val_68);
              mr_62 = tmpRE_63;
              res_m_60.Insert(vdm_MOD_nm, mr_62);
            }
          }
        }
      }
      rhs_59 = res_m_60;
    }
    Record mu_rhs_85(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);    {
      Record tmpRE_86(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
      tmpRE_86 = vdm_MOD_new__sigmamo;
      int mu_87;
      mu_87 = pos_GLOBAL_SigmaMO_explpolys;
      Map val_88;
      {
        Map res_m_89;
        Record mr_91(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
        {
          Sequence seq_lv_100;
          bool succ_98;
          Bool tsucc_101;
          tsucc_101 = true;
          {
            Set tmpVar_v_99;
            {
              Map unArg_103;
              Record tmpRec_104(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_104 = vdm_MOD_sigmamo;
              if (tmpRec_104.Is(vdm_GLOBAL_SigmaMO)) 
                unArg_103 = tmpRec_104.GetField(pos_GLOBAL_SigmaMO_explpolys);
              else 
                RunTime("Unknown record field selector");
              tmpVar_v_99 = unArg_103.Dom();
            }
{ seq_lv_100.ImpAppend(tmpVar_v_99); }
          }
          Set allComb_102 = GenAllComb(seq_lv_100);
          Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
          Generic tmpe_113;
          for (int bb_112 = allComb_102.First(tmpe_113); bb_112; bb_112 = allComb_102.Next(tmpe_113)) {
            Sequence tmp_110 = tmpe_113;
            {
              if (succ_98 = 1 == (Int) (tmp_110.Length())) {
                Record permI_111(vdm_AS_Name, length_AS_Name);
                permI_111 = (Record) (tmp_110.Hd());
                succ_98 = true;
                {
                  vdm_MOD_nm = permI_111;
                  succ_98 = true;
                }
              }
              if (succ_98) {
                Record tmpRE_92(vdm_SEM_ExplPOLY, length_SEM_ExplPOLY);
                {
                  Map tmp_m_93;
                  {
                    Record tmpRec_95(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_95 = vdm_MOD_sigmamo;
                    if (tmpRec_95.Is(vdm_GLOBAL_SigmaMO)) 
                      tmp_m_93 = tmpRec_95.GetField(pos_GLOBAL_SigmaMO_explpolys);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  tmpRE_92 = (Record) (((Map) tmp_m_93)[vdm_MOD_nm]);
                }
                int mu_96;
                mu_96 = pos_SEM_ExplPOLY_modName;
                Record val_97(vdm_AS_Name, length_AS_Name);
                val_97 = vdm_MOD_inst__nm;
                tmpRE_92.SetField(mu_96, val_97);
                mr_91 = tmpRE_92;
                res_m_89.Insert(vdm_MOD_nm, mr_91);
              }
            }
          }
        }
        val_88 = res_m_89;
      }
      tmpRE_86.SetField(mu_87, val_88);
      mu_rhs_85 = tmpRE_86;
    }    vdm_MOD_new__sigmamo = mu_rhs_85;
  }
  {
    Map rhs_114;
    {
      Map res_m_115;
      Record mr_117(vdm_SEM_ExplOP, length_SEM_ExplOP);
      {
        Sequence seq_lv_126;
        bool succ_124;
        Bool tsucc_127;
        tsucc_127 = true;
        {
          Set tmpVar_v_125;
          {
            Map unArg_129;
            Record tmpRec_130(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
            tmpRec_130 = vdm_MOD_sigmamo;
            if (tmpRec_130.Is(vdm_GLOBAL_SigmaMO)) 
              unArg_129 = tmpRec_130.GetField(pos_GLOBAL_SigmaMO_explops);
            else 
              RunTime("Unknown record field selector");
            tmpVar_v_125 = unArg_129.Dom();
          }
{ seq_lv_126.ImpAppend(tmpVar_v_125); }
        }
        Set allComb_128 = GenAllComb(seq_lv_126);
        Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
        Generic tmpe_139;
        for (int bb_138 = allComb_128.First(tmpe_139); bb_138; bb_138 = allComb_128.Next(tmpe_139)) {
          Sequence tmp_136 = tmpe_139;
          {
            if (succ_124 = 1 == (Int) (tmp_136.Length())) {
              Record permI_137(vdm_AS_Name, length_AS_Name);
              permI_137 = (Record) (tmp_136.Hd());
              succ_124 = true;
              {
                vdm_MOD_nm = permI_137;
                succ_124 = true;
              }
            }
            if (succ_124) {
              Record tmpRE_118(vdm_SEM_ExplOP, length_SEM_ExplOP);
              {
                Map tmp_m_119;
                {
                  Record tmpRec_121(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                  tmpRec_121 = vdm_MOD_sigmamo;
                  if (tmpRec_121.Is(vdm_GLOBAL_SigmaMO)) 
                    tmp_m_119 = tmpRec_121.GetField(pos_GLOBAL_SigmaMO_explops);
                  else 
                    RunTime("Unknown record field selector");
                }
                tmpRE_118 = (Record) (((Map) tmp_m_119)[vdm_MOD_nm]);
              }
              int mu_122;
              mu_122 = pos_SEM_ExplOP_modName;
              Record val_123(vdm_AS_Name, length_AS_Name);
              val_123 = vdm_MOD_inst__nm;
              tmpRE_118.SetField(mu_122, val_123);
              mr_117 = tmpRE_118;
              res_m_115.Insert(vdm_MOD_nm, mr_117);
            }
          }
        }
      }
      rhs_114 = res_m_115;
    }
    Record mu_rhs_140(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);    {
      Record tmpRE_141(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
      tmpRE_141 = vdm_MOD_new__sigmamo;
      int mu_142;
      mu_142 = pos_GLOBAL_SigmaMO_explops;
      Map val_143;
      {
        Map res_m_144;
        Record mr_146(vdm_SEM_ExplOP, length_SEM_ExplOP);
        {
          Sequence seq_lv_155;
          bool succ_153;
          Bool tsucc_156;
          tsucc_156 = true;
          {
            Set tmpVar_v_154;
            {
              Map unArg_158;
              Record tmpRec_159(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
              tmpRec_159 = vdm_MOD_sigmamo;
              if (tmpRec_159.Is(vdm_GLOBAL_SigmaMO)) 
                unArg_158 = tmpRec_159.GetField(pos_GLOBAL_SigmaMO_explops);
              else 
                RunTime("Unknown record field selector");
              tmpVar_v_154 = unArg_158.Dom();
            }
{ seq_lv_155.ImpAppend(tmpVar_v_154); }
          }
          Set allComb_157 = GenAllComb(seq_lv_155);
          Record vdm_MOD_nm(vdm_AS_Name, length_AS_Name);
          Generic tmpe_168;
          for (int bb_167 = allComb_157.First(tmpe_168); bb_167; bb_167 = allComb_157.Next(tmpe_168)) {
            Sequence tmp_165 = tmpe_168;
            {
              if (succ_153 = 1 == (Int) (tmp_165.Length())) {
                Record permI_166(vdm_AS_Name, length_AS_Name);
                permI_166 = (Record) (tmp_165.Hd());
                succ_153 = true;
                {
                  vdm_MOD_nm = permI_166;
                  succ_153 = true;
                }
              }
              if (succ_153) {
                Record tmpRE_147(vdm_SEM_ExplOP, length_SEM_ExplOP);
                {
                  Map tmp_m_148;
                  {
                    Record tmpRec_150(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
                    tmpRec_150 = vdm_MOD_sigmamo;
                    if (tmpRec_150.Is(vdm_GLOBAL_SigmaMO)) 
                      tmp_m_148 = tmpRec_150.GetField(pos_GLOBAL_SigmaMO_explops);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  tmpRE_147 = (Record) (((Map) tmp_m_148)[vdm_MOD_nm]);
                }
                int mu_151;
                mu_151 = pos_SEM_ExplOP_modName;
                Record val_152(vdm_AS_Name, length_AS_Name);
                val_152 = vdm_MOD_inst__nm;
                tmpRE_147.SetField(mu_151, val_152);
                mr_146 = tmpRE_147;
                res_m_144.Insert(vdm_MOD_nm, mr_146);
              }
            }
          }
        }
        val_143 = res_m_144;
      }
      tmpRE_141.SetField(mu_142, val_143);
      mu_rhs_140 = tmpRE_141;
    }    vdm_MOD_new__sigmamo = mu_rhs_140;
  }
  {
    Record rexpr_169(vdm_GLOBAL_SigmaMO, length_GLOBAL_SigmaMO);
    rexpr_169 = vdm_MOD_new__sigmamo;
    return rexpr_169;
  }
}

Map vdm_MOD_UpdateImport(Map vdm_MOD_imp__m, Record vdm_MOD_mod__name, Set vdm_MOD_inst__s) {
  Bool cond_5;
  {
    Set var2_7;
    var2_7 = Set();
    cond_5 = (Bool) (vdm_MOD_inst__s == var2_7);
  }
  if (cond_5.GetValue()) {
    Map rexpr_52;
    rexpr_52 = vdm_MOD_imp__m;
    return rexpr_52;
  }
  else {
    Set vdm_MOD_name__s;
    Set res_s_10;
    {
      Sequence seq_lv_14;
      bool succ_12;
      Bool tsucc_15;
      tsucc_15 = true;
      {
        Set tmpVar_v_13;
        tmpVar_v_13 = vdm_MOD_inst__s;
{ seq_lv_14.ImpAppend(tmpVar_v_13); }
      }
      Set allComb_16 = GenAllComb(seq_lv_14);
      Bool pred_21;
      Record vdm_MOD_nm;
      Generic tmpe_26;
      for (int bb_25 = allComb_16.First(tmpe_26); bb_25; bb_25 = allComb_16.Next(tmpe_26)) {
        Sequence tmp_22 = tmpe_26;
        {
          if (succ_12 = 1 == (Int) (tmp_22.Length())) {
            Record permI_24;
            permI_24 = (Record) (tmp_22.Hd());
            succ_12 = true;
            {
              vdm_MOD_nm = permI_24;
              succ_12 = true;
            }
          }
          if (succ_12) {
            Record argTmp_23;
            argTmp_23 = vdm_MOD_nm;
            if (argTmp_23.IsRecord()) 
              pred_21 = vdm_AS_Name == argTmp_23.GetTag();
            else 
              pred_21 = false;
            if (pred_21.GetValue()) 
              res_s_10.Insert(vdm_MOD_nm);
          }
        }
      }
    }
    vdm_MOD_name__s = res_s_10;
    Generic vdm_MOD_imp__s;
    Bool cond_28;
{ cond_28 = (Bool) (vdm_MOD_imp__m.Dom().InSet(vdm_MOD_mod__name)); }
    if (cond_28.GetValue()) {
      Map tmp_m_32;
      tmp_m_32 = vdm_MOD_imp__m;
      vdm_MOD_imp__s = (Generic) (((Map) tmp_m_32)[vdm_MOD_mod__name]);
    }
    else { vdm_MOD_imp__s = Set(); }
    {
      Bool cond_34;
      {
        Bool var1_35;
        Set var2_38;
        var2_38 = Set();
        var1_35 = (Bool) (vdm_MOD_name__s == var2_38);
        if (!(cond_34 = var1_35).GetValue()) { cond_34 = (Bool) (vdm_MOD_imp__s == Nil()); }
      }
      if (cond_34.GetValue()) {
        Map rexpr_51;
        rexpr_51 = vdm_MOD_imp__m;
        return rexpr_51;
      }
      else {
        Set vdm_MOD_new__s;
        vdm_MOD_new__s = (Set) vdm_MOD_imp__s;
        vdm_MOD_new__s.ImpUnion(vdm_MOD_name__s);
        {
          Map rexpr_45;
          {
            Map seqmap_46;
            seqmap_46 = vdm_MOD_imp__m;
            Map modmap_47;
            modmap_47 = Map().Insert(vdm_MOD_mod__name, vdm_MOD_new__s);
            seqmap_46.ImpOverride(modmap_47);
            rexpr_45 = seqmap_46;
          }
          return rexpr_45;
        }
      }
    }
  }
}

Map vdm_MOD_UpdateTypeName(Record vdm_MOD_tp__id, Record vdm_MOD_mod__name, Record vdm_MOD_name) {
  bool succ_5;
  Record tmpVal_6(vdm_AS_Name, length_AS_Name);
  {
    bool succ_7;
    Record tmpVal_8(vdm_AS_Name, length_AS_Name);
    tmpVal_8 = vdm_MOD_name;
    Sequence vdm_MOD_id;
    succ_7 = true;
    {
      succ_7 = false;
      if (tmpVal_8.IsRecord()) 
        if (vdm_AS_Name == tmpVal_8.GetTag()) {
          Sequence e_l_9;
          for (int i_10 = 1; i_10 <= tmpVal_8.Length(); i_10++) 
            e_l_9.ImpAppend(tmpVal_8.GetField(i_10));
          if (succ_7 = 2 == (Int) (e_l_9.Length())) {
            Generic permI_11;
            permI_11 = (Generic) (e_l_9.Hd());
            succ_7 = true;
            {
              vdm_MOD_id = permI_11;
              succ_7 = true;
            }
            permI_11 = (Generic) (e_l_9[2]);
            if (succ_7) 
              succ_7 = true;
          }
        }
    }
    if (!succ_7) 
      RunTime("Pattern match did not succeed in value definition");
{ if (((Bool) ((Int) (vdm_MOD_id.Length()) == (Int) 1)).GetValue()) {
   bool succ_16;
   Record tmpVal_17(vdm_AS_Name, length_AS_Name);
   tmpVal_17 = vdm_MOD_mod__name;
   Sequence vdm_MOD_mod__id;
   succ_16 = true;
   {
     succ_16 = false;
     if (tmpVal_17.IsRecord()) 
       if (vdm_AS_Name == tmpVal_17.GetTag()) {
         Sequence e_l_18;
         for (int i_19 = 1; i_19 <= tmpVal_17.Length(); i_19++) 
           e_l_18.ImpAppend(tmpVal_17.GetField(i_19));
         if (succ_16 = 2 == (Int) (e_l_18.Length())) {
           Generic permI_20;
           permI_20 = (Generic) (e_l_18.Hd());
           succ_16 = true;
           {
             vdm_MOD_mod__id = permI_20;
             succ_16 = true;
           }
           permI_20 = (Generic) (e_l_18[2]);
           if (succ_16) 
             succ_16 = true;
         }
       }
   }
   if (!succ_16) 
     RunTime("Pattern match did not succeed in value definition");
   {
     tmpVal_6 = Record(vdm_AS_Name, length_AS_Name);
     Sequence tmpVar_21;
{ tmpVar_21.ImpConc(vdm_MOD_mod__id).ImpConc(vdm_MOD_id); }
     tmpVal_6.SetField(1, tmpVar_21);
     tmpVal_6.SetField(2, Nil());
   }
 }
 else { tmpVal_6 = vdm_MOD_name; } }
  }
  Record vdm_MOD_new__name(vdm_AS_Name, length_AS_Name);
  succ_5 = true;
  {
    vdm_MOD_new__name = tmpVal_6;
    succ_5 = true;
  }
  if (!succ_5) 
    RunTime("Pattern match did not succeed in value definition");
  {
    Map rexpr_25;
    {
      Record tmpVar2_27(vdm_AS_TypeDef, length_AS_TypeDef);
      {
        tmpVar2_27 = Record(vdm_AS_TypeDef, length_AS_TypeDef);
        tmpVar2_27.SetField(1, vdm_MOD_tp__id);
        Record tmpVar_29(vdm_AS_TypeName, length_AS_TypeName);
        {
          tmpVar_29 = Record(vdm_AS_TypeName, length_AS_TypeName);
          tmpVar_29.SetField(1, vdm_MOD_new__name);
        }
        tmpVar2_27.SetField(2, tmpVar_29);
        tmpVar2_27.SetField(3, Nil());
      }
      rexpr_25 = Map().Insert(vdm_MOD_tp__id, tmpVar2_27);
    }
    return rexpr_25;
  }
}

Sequence vdm_MOD_UpdateValues(Record vdm_MOD_val__id, Record vdm_MOD_expr) {
  Sequence rexpr_4;
  {
    Record tmpVar_5(vdm_AS_ValueDef, length_AS_ValueDef);
    tmpVar_5 = Record(vdm_AS_ValueDef, length_AS_ValueDef);
    Record tmpVar_6(vdm_AS_PatternName, length_AS_PatternName);
    {
      tmpVar_6 = Record(vdm_AS_PatternName, length_AS_PatternName);
      tmpVar_6.SetField(1, vdm_MOD_val__id);
      tmpVar_6.SetField(2, Nil());
    }
    tmpVar_5.SetField(1, tmpVar_6);
    tmpVar_5.SetField(2, Nil());
    tmpVar_5.SetField(3, vdm_MOD_expr);
    rexpr_4 = Sequence().ImpAppend(tmpVar_5);
  }
  return rexpr_4;
}
