//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at Fri 10-Jan-97 by the VDM-SLtoC++ Code Generator
// (vdmde - v3.0l - Fri 10-Jan-97)
//
// Supported compiler: g++ version 2.7.2
//



#include "OLD.h"

static Record vdm_OLD_OldNameInAllOrExistsExpr(Record);
static Record vdm_OLD_OldNameInApplyExpr(Record);
static Record vdm_OLD_OldNameInBinaryExpr(Record);
static Record vdm_OLD_OldNameInBind(Record);
static Record vdm_OLD_OldNameInBracketedExpr(Record);
static Record vdm_OLD_OldNameInCasesExpr(Record);
static Record vdm_OLD_OldNameInDefExpr(Record);
static Record vdm_OLD_OldNameInExistsUniqueExpr(Record);
static Record vdm_OLD_OldNameInFctTypeInstExpr(Record);
static Record vdm_OLD_OldNameInFieldSelectExpr(Record);
static Record vdm_OLD_OldNameInIfExpr(Record);
static Record vdm_OLD_OldNameInIotaExpr(Record);
static Record vdm_OLD_OldNameInIsExpr(Record);
static Record vdm_OLD_OldNameInLambdaExpr(Record);
static Record vdm_OLD_OldNameInLetBeSTExpr(Record);
static Record vdm_OLD_OldNameInLetExpr(Record);
static Record vdm_OLD_OldNameInMapComprehensionExpr(Record);
static Record vdm_OLD_OldNameInMapEnumerationExpr(Record);
static Record vdm_OLD_OldNameInMapInverseExpr(Record);
static Sequence vdm_OLD_OldNameInMultBindSeq(Sequence);
static Record vdm_OLD_OldNameInOldName(Record);
static Record vdm_OLD_OldNameInPattern(Record);
static Record vdm_OLD_OldNameInPrefixExpr(Record);
static Record vdm_OLD_OldNameInRecordConstructorExpr(Record);
static Record vdm_OLD_OldNameInRecordModifierExpr(Record);
static Record vdm_OLD_OldNameInSeqComprehensionExpr(Record);
static Record vdm_OLD_OldNameInSeqEnumerationExpr(Record);
static Record vdm_OLD_OldNameInSeqModifyMapOverrideExpr(Record);
static Record vdm_OLD_OldNameInSetComprehensionExpr(Record);
static Record vdm_OLD_OldNameInSetEnumerationExpr(Record);
static Record vdm_OLD_OldNameInSetRangeExpr(Record);
static Record vdm_OLD_OldNameInSubSequenceExpr(Record);
static Record vdm_OLD_OldNameInTokenConstructorExpr(Record);
static Record vdm_OLD_OldNameInTupleConstructorExpr(Record);

void init_OLD() {}

Record vdm_OLD_OldNameInAllOrExistsExpr(Record var_1_1) {
  Sequence vdm_OLD_bind__l;
  Record vdm_OLD_pred__e;
  Generic vdm_OLD_quant;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_AllOrExistsExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 5 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_quant = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_bind__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
          permI_5 = (Generic) (e_l_3[5]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_AllOrExistsExpr, length_AS_AllOrExistsExpr);
    {
      rexpr_6 = Record(vdm_AS_AllOrExistsExpr, length_AS_AllOrExistsExpr);
      rexpr_6.SetField(1, vdm_OLD_quant);
      rexpr_6.SetField(2, vdm_OLD_OldNameInMultBindSeq(vdm_OLD_bind__l));
      rexpr_6.SetField(3, vdm_OLD_OldNameInExpr(vdm_OLD_pred__e));
      rexpr_6.SetField(4, Nil());
      rexpr_6.SetField(5, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInAllOrExistsExpr");
}

Record vdm_OLD_OldNameInApplyExpr(Record var_1_1) {
  Sequence vdm_OLD_arg__le;
  Record vdm_OLD_fct__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_ApplyExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_fct__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_arg__le = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    {
      Sequence res_l_8;
      Record reselem_9;
      Set resBind_s_11;
      {
        Set riseq_16;
        int max_17 = (Int) (vdm_OLD_arg__le.Length());
        for (int i_18 = 1; i_18 <= max_17; i_18++) 
          riseq_16.Insert((Int) i_18);
        resBind_s_11 = riseq_16;
      }
      Sequence bind_l_10;
      if ((Int) (resBind_s_11.Card()) != (Int) 0) 
        bind_l_10 = Sort(resBind_s_11);
      bool succ_12 = true;
      Int vdm_OLD_i;
      Generic tmpe_23;
      for (int i_22 = bind_l_10.First(tmpe_23); i_22; i_22 = bind_l_10.Next(tmpe_23)) {
        Int e_14 = tmpe_23;
        {
          vdm_OLD_i = e_14;
          succ_12 = true;
          if (succ_12) {
            Record tmpVar_19;
            {
              Sequence tmpseq_20;
              tmpseq_20 = vdm_OLD_arg__le;
              tmpVar_19 = (Record) (tmpseq_20[vdm_OLD_i.GetValue()]);
            }
            reselem_9 = vdm_OLD_OldNameInExpr(tmpVar_19);
            res_l_8.ImpAppend(reselem_9);
          }
        }
      }
      vdm_OLD_l = res_l_8;
    }
    {
      Record rexpr_24(vdm_AS_ApplyExpr, length_AS_ApplyExpr);
      {
        rexpr_24 = Record(vdm_AS_ApplyExpr, length_AS_ApplyExpr);
        rexpr_24.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_fct__e));
        rexpr_24.SetField(2, vdm_OLD_l);
        rexpr_24.SetField(3, Nil());
      }
      return rexpr_24;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInApplyExpr");
}

Record vdm_OLD_OldNameInBinaryExpr(Record var_1_1) {
  Record vdm_OLD_left__e;
  Generic vdm_OLD_opr;
  Record vdm_OLD_right__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_BinaryExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 4 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_left__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_opr = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_right__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_BinaryExpr, length_AS_BinaryExpr);
    {
      rexpr_6 = Record(vdm_AS_BinaryExpr, length_AS_BinaryExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_left__e));
      rexpr_6.SetField(2, vdm_OLD_opr);
      rexpr_6.SetField(3, vdm_OLD_OldNameInExpr(vdm_OLD_right__e));
      rexpr_6.SetField(4, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInBinaryExpr");
}

Record vdm_OLD_OldNameInBind(Record vdm_OLD_bind) {
  Record tmpVar_3;
  tmpVar_3 = vdm_OLD_bind;
  return vdm_OLD_OldNameInPattern(tmpVar_3);
}

Record vdm_OLD_OldNameInBracketedExpr(Record var_1_1) {
  Record vdm_OLD_expr;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_BracketedExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_expr = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_BracketedExpr, length_AS_BracketedExpr);
    {
      rexpr_6 = Record(vdm_AS_BracketedExpr, length_AS_BracketedExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_expr));
      rexpr_6.SetField(2, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInBracketedExpr");
}

Record vdm_OLD_OldNameInCasesExpr(Record var_1_1) {
  Sequence vdm_OLD_altns__l;
  Generic vdm_OLD_others__e;
  Record vdm_OLD_sel__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_CasesExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 4 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_sel__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_altns__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_others__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_new__l;
    vdm_OLD_new__l = Sequence();
    Sequence vdm_OLD_pat__lp;
    vdm_OLD_pat__lp = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_altns__l;
      Record vdm_OLD_body;
      Sequence vdm_OLD_match;
      bool succ_8;
      Generic tmpe_31;
      for (int i_30 = sq_6.First(tmpe_31); i_30; i_30 = sq_6.Next(tmpe_31)) {
        Record elem_7 = tmpe_31;
        {
          succ_8 = true;
          {
            succ_8 = false;
            if (elem_7.IsRecord()) 
              if (vdm_AS_CaseAltn == elem_7.GetTag()) {
                Sequence e_l_27;
                for (int i_28 = 1; i_28 <= elem_7.Length(); i_28++) 
                  e_l_27.ImpAppend(elem_7.GetField(i_28));
                if (succ_8 = 2 == (Int) (e_l_27.Length())) {
                  Generic permI_29;
                  permI_29 = (Generic) (e_l_27.Hd());
                  succ_8 = true;
                  {
                    vdm_OLD_match = permI_29;
                    succ_8 = true;
                  }
                  permI_29 = (Generic) (e_l_27[2]);
                  if (succ_8) {
                    vdm_OLD_body = permI_29;
                    succ_8 = true;
                  }
                }
              }
          }
          if (succ_8) {
            Sequence rhs_9;
            rhs_9 = Sequence();
            vdm_OLD_pat__lp = rhs_9;
            {
              Sequence sq_10;
              sq_10 = vdm_OLD_match;
              Record vdm_OLD_pat;
              bool succ_12;
              Generic tmpe_19;
              for (int i_18 = sq_10.First(tmpe_19); i_18; i_18 = sq_10.Next(tmpe_19)) {
                Record elem_11 = tmpe_19;
                {
                  succ_12 = true;
                  {
                    vdm_OLD_pat = elem_11;
                    succ_12 = true;
                  }
                  if (succ_12) {
                    Sequence rhs_13;
                    {
                      Sequence var2_15;
                      var2_15 = Sequence().ImpAppend(vdm_OLD_OldNameInPattern(vdm_OLD_pat));
                      rhs_13.ImpConc(vdm_OLD_pat__lp).ImpConc(var2_15);
                    }
                    vdm_OLD_pat__lp = rhs_13;
                  }
                  else 
                    RunTime("Pattern did not match in sequence for loop");
                }
              }
            }
            {
              Sequence rhs_20;
              {
                Sequence var2_22;
                Record tmpVar_23(vdm_AS_CaseAltn, length_AS_CaseAltn);
                tmpVar_23 = Record(vdm_AS_CaseAltn, length_AS_CaseAltn);
                tmpVar_23.SetField(1, vdm_OLD_pat__lp);
                tmpVar_23.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_body));
                var2_22 = Sequence().ImpAppend(tmpVar_23);
                rhs_20.ImpConc(vdm_OLD_new__l).ImpConc(var2_22);
              }
              vdm_OLD_new__l = rhs_20;
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record rexpr_32(vdm_AS_CasesExpr, length_AS_CasesExpr);
      {
        rexpr_32 = Record(vdm_AS_CasesExpr, length_AS_CasesExpr);
        rexpr_32.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_sel__e));
        rexpr_32.SetField(2, vdm_OLD_new__l);
        Generic tmpVar_36;
{ if (((Bool) (vdm_OLD_others__e == Nil())).GetValue()) 
   tmpVar_36 = Nil();
 else { tmpVar_36 = vdm_OLD_OldNameInExpr(vdm_OLD_others__e); } }
        rexpr_32.SetField(3, tmpVar_36);
        rexpr_32.SetField(4, Nil());
      }
      return rexpr_32;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInCasesExpr");
}

Record vdm_OLD_OldNameInDefExpr(Record var_1_1) {
  Sequence vdm_OLD_def__l;
  Record vdm_OLD_in__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_DefExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_def__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_in__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_new__l;
    vdm_OLD_new__l = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_def__l;
      Record vdm_OLD_pat__p;
      Record vdm_OLD_val__e;
      bool succ_8;
      Generic tmpe_21;
      for (int i_20 = sq_6.First(tmpe_21); i_20; i_20 = sq_6.Next(tmpe_21)) {
        Tuple elem_7 = tmpe_21;
        {
          succ_8 = true;
          {
            succ_8 = false;
            if (elem_7.IsTuple()) {
              Sequence e_l_17;
              for (int i_18 = 1; i_18 <= ((Tuple) elem_7).Length(); i_18++) 
                e_l_17.ImpAppend(((Tuple) elem_7).GetField(i_18));
              if (succ_8 = 2 == (Int) (e_l_17.Length())) {
                Record permI_19;
                permI_19 = (Record) (e_l_17.Hd());
                succ_8 = true;
                {
                  vdm_OLD_pat__p = permI_19;
                  succ_8 = true;
                }
                permI_19 = (Record) (e_l_17[2]);
                if (succ_8) {
                  vdm_OLD_val__e = permI_19;
                  succ_8 = true;
                }
              }
            }
          }
          if (succ_8) {
            Sequence rhs_9;
            {
              Sequence var2_11;
              Tuple tmpVar_12(2);
              tmpVar_12 = Tuple(2);
              tmpVar_12.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_pat__p));
              tmpVar_12.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_val__e));
              var2_11 = Sequence().ImpAppend(tmpVar_12);
              rhs_9.ImpConc(vdm_OLD_new__l).ImpConc(var2_11);
            }
            vdm_OLD_new__l = rhs_9;
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record vdm_OLD_new__in;
      vdm_OLD_new__in = vdm_OLD_OldNameInExpr(vdm_OLD_in__e);
      {
        Record rexpr_25(vdm_AS_DefExpr, length_AS_DefExpr);
        {
          rexpr_25 = Record(vdm_AS_DefExpr, length_AS_DefExpr);
          rexpr_25.SetField(1, vdm_OLD_new__l);
          rexpr_25.SetField(2, vdm_OLD_new__in);
          rexpr_25.SetField(3, Nil());
        }
        return rexpr_25;
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInDefExpr");
}

Record vdm_OLD_OldNameInExistsUniqueExpr(Record var_1_1) {
  Record vdm_OLD_bind;
  Record vdm_OLD_pred__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_ExistsUniqueExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 4 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_bind = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_ExistsUniqueExpr, length_AS_ExistsUniqueExpr);
    {
      rexpr_6 = Record(vdm_AS_ExistsUniqueExpr, length_AS_ExistsUniqueExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInBind(vdm_OLD_bind));
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_pred__e));
      rexpr_6.SetField(3, Nil());
      rexpr_6.SetField(4, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInExistsUniqueExpr");
}

Record vdm_OLD_OldNameInExpr(Record vdm_OLD_expr) {
  Bool selRes_3;
  selRes_3 = (Bool) true;
  bool succ_4 = true;
  {
    Bool tmpVal_5;
    {
      Record argTmp_6;
      argTmp_6 = vdm_OLD_expr;
      if (argTmp_6.IsRecord()) 
        tmpVal_5 = vdm_AS_DefExpr == argTmp_6.GetTag();
      else 
        tmpVal_5 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_5)).GetValue();
    if (succ_4) {
      Record tmpVar_7;
      tmpVar_7 = vdm_OLD_expr;
      return vdm_OLD_OldNameInDefExpr(tmpVar_7);
    }
  }
  if (!succ_4) {
    Bool tmpVal_8;
    {
      Record argTmp_9;
      argTmp_9 = vdm_OLD_expr;
      if (argTmp_9.IsRecord()) 
        tmpVal_8 = vdm_AS_LetExpr == argTmp_9.GetTag();
      else 
        tmpVal_8 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_8)).GetValue();
    if (succ_4) {
      Record tmpVar_10;
      tmpVar_10 = vdm_OLD_expr;
      return vdm_OLD_OldNameInLetExpr(tmpVar_10);
    }
  }
  if (!succ_4) {
    Bool tmpVal_11;
    {
      Record argTmp_12;
      argTmp_12 = vdm_OLD_expr;
      if (argTmp_12.IsRecord()) 
        tmpVal_11 = vdm_AS_LetBeSTExpr == argTmp_12.GetTag();
      else 
        tmpVal_11 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_11)).GetValue();
    if (succ_4) {
      Record tmpVar_13;
      tmpVar_13 = vdm_OLD_expr;
      return vdm_OLD_OldNameInLetBeSTExpr(tmpVar_13);
    }
  }
  if (!succ_4) {
    Bool tmpVal_14;
    {
      Record argTmp_15;
      argTmp_15 = vdm_OLD_expr;
      if (argTmp_15.IsRecord()) 
        tmpVal_14 = vdm_AS_IfExpr == argTmp_15.GetTag();
      else 
        tmpVal_14 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_14)).GetValue();
    if (succ_4) {
      Record tmpVar_16;
      tmpVar_16 = vdm_OLD_expr;
      return vdm_OLD_OldNameInIfExpr(tmpVar_16);
    }
  }
  if (!succ_4) {
    Bool tmpVal_17;
    {
      Record argTmp_18;
      argTmp_18 = vdm_OLD_expr;
      if (argTmp_18.IsRecord()) 
        tmpVal_17 = vdm_AS_CasesExpr == argTmp_18.GetTag();
      else 
        tmpVal_17 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_17)).GetValue();
    if (succ_4) {
      Record tmpVar_19;
      tmpVar_19 = vdm_OLD_expr;
      return vdm_OLD_OldNameInCasesExpr(tmpVar_19);
    }
  }
  if (!succ_4) {
    Bool tmpVal_20;
    {
      Record argTmp_21;
      argTmp_21 = vdm_OLD_expr;
      if (argTmp_21.IsRecord()) 
        tmpVal_20 = vdm_AS_PrefixExpr == argTmp_21.GetTag();
      else 
        tmpVal_20 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_20)).GetValue();
    if (succ_4) {
      Record tmpVar_22;
      tmpVar_22 = vdm_OLD_expr;
      return vdm_OLD_OldNameInPrefixExpr(tmpVar_22);
    }
  }
  if (!succ_4) {
    Bool tmpVal_23;
    {
      Record argTmp_24;
      argTmp_24 = vdm_OLD_expr;
      if (argTmp_24.IsRecord()) 
        tmpVal_23 = vdm_AS_MapInverseExpr == argTmp_24.GetTag();
      else 
        tmpVal_23 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_23)).GetValue();
    if (succ_4) {
      Record tmpVar_25;
      tmpVar_25 = vdm_OLD_expr;
      return vdm_OLD_OldNameInMapInverseExpr(tmpVar_25);
    }
  }
  if (!succ_4) {
    Bool tmpVal_26;
    {
      Record argTmp_27;
      argTmp_27 = vdm_OLD_expr;
      if (argTmp_27.IsRecord()) 
        tmpVal_26 = vdm_AS_BinaryExpr == argTmp_27.GetTag();
      else 
        tmpVal_26 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_26)).GetValue();
    if (succ_4) {
      Record tmpVar_28;
      tmpVar_28 = vdm_OLD_expr;
      return vdm_OLD_OldNameInBinaryExpr(tmpVar_28);
    }
  }
  if (!succ_4) {
    Bool tmpVal_29;
    {
      Record argTmp_30;
      argTmp_30 = vdm_OLD_expr;
      if (argTmp_30.IsRecord()) 
        tmpVal_29 = vdm_AS_AllOrExistsExpr == argTmp_30.GetTag();
      else 
        tmpVal_29 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_29)).GetValue();
    if (succ_4) {
      Record tmpVar_31;
      tmpVar_31 = vdm_OLD_expr;
      return vdm_OLD_OldNameInAllOrExistsExpr(tmpVar_31);
    }
  }
  if (!succ_4) {
    Bool tmpVal_32;
    {
      Record argTmp_33;
      argTmp_33 = vdm_OLD_expr;
      if (argTmp_33.IsRecord()) 
        tmpVal_32 = vdm_AS_ExistsUniqueExpr == argTmp_33.GetTag();
      else 
        tmpVal_32 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_32)).GetValue();
    if (succ_4) {
      Record tmpVar_34;
      tmpVar_34 = vdm_OLD_expr;
      return vdm_OLD_OldNameInExistsUniqueExpr(tmpVar_34);
    }
  }
  if (!succ_4) {
    Bool tmpVal_35;
    {
      Record argTmp_36;
      argTmp_36 = vdm_OLD_expr;
      if (argTmp_36.IsRecord()) 
        tmpVal_35 = vdm_AS_SetEnumerationExpr == argTmp_36.GetTag();
      else 
        tmpVal_35 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_35)).GetValue();
    if (succ_4) {
      Record tmpVar_37;
      tmpVar_37 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSetEnumerationExpr(tmpVar_37);
    }
  }
  if (!succ_4) {
    Bool tmpVal_38;
    {
      Record argTmp_39;
      argTmp_39 = vdm_OLD_expr;
      if (argTmp_39.IsRecord()) 
        tmpVal_38 = vdm_AS_SetComprehensionExpr == argTmp_39.GetTag();
      else 
        tmpVal_38 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_38)).GetValue();
    if (succ_4) {
      Record tmpVar_40;
      tmpVar_40 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSetComprehensionExpr(tmpVar_40);
    }
  }
  if (!succ_4) {
    Bool tmpVal_41;
    {
      Record argTmp_42;
      argTmp_42 = vdm_OLD_expr;
      if (argTmp_42.IsRecord()) 
        tmpVal_41 = vdm_AS_SetRangeExpr == argTmp_42.GetTag();
      else 
        tmpVal_41 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_41)).GetValue();
    if (succ_4) {
      Record tmpVar_43;
      tmpVar_43 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSetRangeExpr(tmpVar_43);
    }
  }
  if (!succ_4) {
    Bool tmpVal_44;
    {
      Record argTmp_45;
      argTmp_45 = vdm_OLD_expr;
      if (argTmp_45.IsRecord()) 
        tmpVal_44 = vdm_AS_SeqEnumerationExpr == argTmp_45.GetTag();
      else 
        tmpVal_44 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_44)).GetValue();
    if (succ_4) {
      Record tmpVar_46;
      tmpVar_46 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSeqEnumerationExpr(tmpVar_46);
    }
  }
  if (!succ_4) {
    Bool tmpVal_47;
    {
      Record argTmp_48;
      argTmp_48 = vdm_OLD_expr;
      if (argTmp_48.IsRecord()) 
        tmpVal_47 = vdm_AS_SeqComprehensionExpr == argTmp_48.GetTag();
      else 
        tmpVal_47 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_47)).GetValue();
    if (succ_4) {
      Record tmpVar_49;
      tmpVar_49 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSeqComprehensionExpr(tmpVar_49);
    }
  }
  if (!succ_4) {
    Bool tmpVal_50;
    {
      Record argTmp_51;
      argTmp_51 = vdm_OLD_expr;
      if (argTmp_51.IsRecord()) 
        tmpVal_50 = vdm_AS_SubSequenceExpr == argTmp_51.GetTag();
      else 
        tmpVal_50 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_50)).GetValue();
    if (succ_4) {
      Record tmpVar_52;
      tmpVar_52 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSubSequenceExpr(tmpVar_52);
    }
  }
  if (!succ_4) {
    Bool tmpVal_53;
    {
      Record argTmp_54;
      argTmp_54 = vdm_OLD_expr;
      if (argTmp_54.IsRecord()) 
        tmpVal_53 = vdm_AS_SeqModifyMapOverrideExpr == argTmp_54.GetTag();
      else 
        tmpVal_53 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_53)).GetValue();
    if (succ_4) {
      Record tmpVar_55;
      tmpVar_55 = vdm_OLD_expr;
      return vdm_OLD_OldNameInSeqModifyMapOverrideExpr(tmpVar_55);
    }
  }
  if (!succ_4) {
    Bool tmpVal_56;
    {
      Record argTmp_57;
      argTmp_57 = vdm_OLD_expr;
      if (argTmp_57.IsRecord()) 
        tmpVal_56 = vdm_AS_MapEnumerationExpr == argTmp_57.GetTag();
      else 
        tmpVal_56 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_56)).GetValue();
    if (succ_4) {
      Record tmpVar_58;
      tmpVar_58 = vdm_OLD_expr;
      return vdm_OLD_OldNameInMapEnumerationExpr(tmpVar_58);
    }
  }
  if (!succ_4) {
    Bool tmpVal_59;
    {
      Record argTmp_60;
      argTmp_60 = vdm_OLD_expr;
      if (argTmp_60.IsRecord()) 
        tmpVal_59 = vdm_AS_MapComprehensionExpr == argTmp_60.GetTag();
      else 
        tmpVal_59 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_59)).GetValue();
    if (succ_4) {
      Record tmpVar_61;
      tmpVar_61 = vdm_OLD_expr;
      return vdm_OLD_OldNameInMapComprehensionExpr(tmpVar_61);
    }
  }
  if (!succ_4) {
    Bool tmpVal_62;
    {
      Record argTmp_63;
      argTmp_63 = vdm_OLD_expr;
      if (argTmp_63.IsRecord()) 
        tmpVal_62 = vdm_AS_TupleConstructorExpr == argTmp_63.GetTag();
      else 
        tmpVal_62 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_62)).GetValue();
    if (succ_4) {
      Record tmpVar_64;
      tmpVar_64 = vdm_OLD_expr;
      return vdm_OLD_OldNameInTupleConstructorExpr(tmpVar_64);
    }
  }
  if (!succ_4) {
    Bool tmpVal_65;
    {
      Record argTmp_66;
      argTmp_66 = vdm_OLD_expr;
      if (argTmp_66.IsRecord()) 
        tmpVal_65 = vdm_AS_RecordConstructorExpr == argTmp_66.GetTag();
      else 
        tmpVal_65 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_65)).GetValue();
    if (succ_4) {
      Record tmpVar_67;
      tmpVar_67 = vdm_OLD_expr;
      return vdm_OLD_OldNameInRecordConstructorExpr(tmpVar_67);
    }
  }
  if (!succ_4) {
    Bool tmpVal_68;
    {
      Record argTmp_69;
      argTmp_69 = vdm_OLD_expr;
      if (argTmp_69.IsRecord()) 
        tmpVal_68 = vdm_AS_RecordModifierExpr == argTmp_69.GetTag();
      else 
        tmpVal_68 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_68)).GetValue();
    if (succ_4) {
      Record tmpVar_70;
      tmpVar_70 = vdm_OLD_expr;
      return vdm_OLD_OldNameInRecordModifierExpr(tmpVar_70);
    }
  }
  if (!succ_4) {
    Bool tmpVal_71;
    {
      Record argTmp_72;
      argTmp_72 = vdm_OLD_expr;
      if (argTmp_72.IsRecord()) 
        tmpVal_71 = vdm_AS_TokenConstructorExpr == argTmp_72.GetTag();
      else 
        tmpVal_71 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_71)).GetValue();
    if (succ_4) {
      Record tmpVar_73;
      tmpVar_73 = vdm_OLD_expr;
      return vdm_OLD_OldNameInTokenConstructorExpr(tmpVar_73);
    }
  }
  if (!succ_4) {
    Bool tmpVal_74;
    {
      Record argTmp_75;
      argTmp_75 = vdm_OLD_expr;
      if (argTmp_75.IsRecord()) 
        tmpVal_74 = vdm_AS_ApplyExpr == argTmp_75.GetTag();
      else 
        tmpVal_74 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_74)).GetValue();
    if (succ_4) {
      Record tmpVar_76;
      tmpVar_76 = vdm_OLD_expr;
      return vdm_OLD_OldNameInApplyExpr(tmpVar_76);
    }
  }
  if (!succ_4) {
    Bool tmpVal_77;
    {
      Record argTmp_78;
      argTmp_78 = vdm_OLD_expr;
      if (argTmp_78.IsRecord()) 
        tmpVal_77 = vdm_AS_LambdaExpr == argTmp_78.GetTag();
      else 
        tmpVal_77 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_77)).GetValue();
    if (succ_4) {
      Record tmpVar_79;
      tmpVar_79 = vdm_OLD_expr;
      return vdm_OLD_OldNameInLambdaExpr(tmpVar_79);
    }
  }
  if (!succ_4) {
    Bool tmpVal_80;
    {
      Record argTmp_81;
      argTmp_81 = vdm_OLD_expr;
      if (argTmp_81.IsRecord()) 
        tmpVal_80 = vdm_AS_FieldSelectExpr == argTmp_81.GetTag();
      else 
        tmpVal_80 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_80)).GetValue();
    if (succ_4) {
      Record tmpVar_82;
      tmpVar_82 = vdm_OLD_expr;
      return vdm_OLD_OldNameInFieldSelectExpr(tmpVar_82);
    }
  }
  if (!succ_4) {
    Bool tmpVal_83;
    {
      Record argTmp_84;
      argTmp_84 = vdm_OLD_expr;
      if (argTmp_84.IsRecord()) 
        tmpVal_83 = vdm_AS_FctTypeInstExpr == argTmp_84.GetTag();
      else 
        tmpVal_83 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_83)).GetValue();
    if (succ_4) {
      Record tmpVar_85;
      tmpVar_85 = vdm_OLD_expr;
      return vdm_OLD_OldNameInFctTypeInstExpr(tmpVar_85);
    }
  }
  if (!succ_4) {
    Bool tmpVal_86;
    {
      Record argTmp_87;
      argTmp_87 = vdm_OLD_expr;
      if (argTmp_87.IsRecord()) 
        tmpVal_86 = vdm_AS_IsExpr == argTmp_87.GetTag();
      else 
        tmpVal_86 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_86)).GetValue();
    if (succ_4) {
      Record tmpVar_88;
      tmpVar_88 = vdm_OLD_expr;
      return vdm_OLD_OldNameInIsExpr(tmpVar_88);
    }
  }
  if (!succ_4) {
    Bool tmpVal_89;
    {
      Record argTmp_90;
      argTmp_90 = vdm_OLD_expr;
      if (argTmp_90.IsRecord()) 
        tmpVal_89 = vdm_AS_IotaExpr == argTmp_90.GetTag();
      else 
        tmpVal_89 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_89)).GetValue();
    if (succ_4) {
      Record tmpVar_91;
      tmpVar_91 = vdm_OLD_expr;
      return vdm_OLD_OldNameInIotaExpr(tmpVar_91);
    }
  }
  if (!succ_4) {
    Bool tmpVal_92;
    {
      Record argTmp_93;
      argTmp_93 = vdm_OLD_expr;
      if (argTmp_93.IsRecord()) 
        tmpVal_92 = vdm_AS_UndefinedExpr == argTmp_93.GetTag();
      else 
        tmpVal_92 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_92)).GetValue();
    if (!succ_4) {
      Bool tmpVal_94;
      {
        Record argTmp_95;
        argTmp_95 = vdm_OLD_expr;
        if (argTmp_95.IsRecord()) 
          tmpVal_94 = vdm_AS_Name == argTmp_95.GetTag();
        else 
          tmpVal_94 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_94)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_96;
      {
        Record argTmp_97;
        argTmp_97 = vdm_OLD_expr;
        if (argTmp_97.IsRecord()) 
          tmpVal_96 = vdm_AS_BoolLit == argTmp_97.GetTag();
        else 
          tmpVal_96 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_96)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_98;
      {
        Record argTmp_99;
        argTmp_99 = vdm_OLD_expr;
        if (argTmp_99.IsRecord()) 
          tmpVal_98 = vdm_AS_CharLit == argTmp_99.GetTag();
        else 
          tmpVal_98 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_98)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_100;
      {
        Record argTmp_101;
        argTmp_101 = vdm_OLD_expr;
        if (argTmp_101.IsRecord()) 
          tmpVal_100 = vdm_AS_TextLit == argTmp_101.GetTag();
        else 
          tmpVal_100 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_100)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_102;
      {
        Record argTmp_103;
        argTmp_103 = vdm_OLD_expr;
        if (argTmp_103.IsRecord()) 
          tmpVal_102 = vdm_AS_QuoteLit == argTmp_103.GetTag();
        else 
          tmpVal_102 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_102)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_104;
      {
        Record argTmp_105;
        argTmp_105 = vdm_OLD_expr;
        if (argTmp_105.IsRecord()) 
          tmpVal_104 = vdm_AS_RealLit == argTmp_105.GetTag();
        else 
          tmpVal_104 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_104)).GetValue();
    }
    if (!succ_4) {
      Bool tmpVal_106;
      {
        Record argTmp_107;
        argTmp_107 = vdm_OLD_expr;
        if (argTmp_107.IsRecord()) 
          tmpVal_106 = vdm_AS_NilLit == argTmp_107.GetTag();
        else 
          tmpVal_106 = false;
      }
      succ_4 = ((Bool) (selRes_3 == tmpVal_106)).GetValue();
    }
    if (succ_4) {
      Record rexpr_108;
      rexpr_108 = vdm_OLD_expr;
      return rexpr_108;
    }
  }
  if (!succ_4) {
    Bool tmpVal_109;
    {
      Record argTmp_110;
      argTmp_110 = vdm_OLD_expr;
      if (argTmp_110.IsRecord()) 
        tmpVal_109 = vdm_AS_OldName == argTmp_110.GetTag();
      else 
        tmpVal_109 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_109)).GetValue();
    if (succ_4) {
      Record tmpVar_111;
      tmpVar_111 = vdm_OLD_expr;
      return vdm_OLD_OldNameInOldName(tmpVar_111);
    }
  }
  if (!succ_4) {
    Bool tmpVal_112;
    {
      Record argTmp_113;
      argTmp_113 = vdm_OLD_expr;
      if (argTmp_113.IsRecord()) 
        tmpVal_112 = vdm_AS_BracketedExpr == argTmp_113.GetTag();
      else 
        tmpVal_112 = false;
    }
    succ_4 = ((Bool) (selRes_3 == tmpVal_112)).GetValue();
    if (succ_4) {
      Record tmpVar_114;
      tmpVar_114 = vdm_OLD_expr;
      return vdm_OLD_OldNameInBracketedExpr(tmpVar_114);
    }
  }
  if (!succ_4) 
    RunTime("Can not evaluate an error statement");
}

Record vdm_OLD_OldNameInFctTypeInstExpr(Record var_1_1) {
  Sequence vdm_OLD_inst;
  Record vdm_OLD_polyfct(vdm_AS_Name, length_AS_Name);
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_FctTypeInstExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_polyfct = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_inst = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_FctTypeInstExpr, length_AS_FctTypeInstExpr);
    {
      rexpr_6 = Record(vdm_AS_FctTypeInstExpr, length_AS_FctTypeInstExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_polyfct));
      rexpr_6.SetField(2, vdm_OLD_inst);
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInFctTypeInstExpr");
}

Record vdm_OLD_OldNameInFieldSelectExpr(Record var_1_1) {
  Record vdm_OLD_field(vdm_AS_Name, length_AS_Name);
  Record vdm_OLD_record__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_FieldSelectExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_record__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_field = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_FieldSelectExpr, length_AS_FieldSelectExpr);
    {
      rexpr_6 = Record(vdm_AS_FieldSelectExpr, length_AS_FieldSelectExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_record__e));
      rexpr_6.SetField(2, vdm_OLD_field);
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInFieldSelectExpr");
}

Record vdm_OLD_OldNameInIfExpr(Record var_1_1) {
  Record vdm_OLD_altn__e;
  Record vdm_OLD_cons__e;
  Sequence vdm_OLD_elif;
  Record vdm_OLD_test__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IfExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 5 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_test__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_cons__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_elif = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) {
            vdm_OLD_altn__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[5]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_new__l;
    vdm_OLD_new__l = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_elif;
      Record vdm_OLD_cns;
      Record vdm_OLD_tst;
      bool succ_8;
      Generic tmpe_21;
      for (int i_20 = sq_6.First(tmpe_21); i_20; i_20 = sq_6.Next(tmpe_21)) {
        Record elem_7 = tmpe_21;
        {
          succ_8 = true;
          {
            succ_8 = false;
            if (elem_7.IsRecord()) 
              if (vdm_AS_ElseifExpr == elem_7.GetTag()) {
                Sequence e_l_17;
                for (int i_18 = 1; i_18 <= elem_7.Length(); i_18++) 
                  e_l_17.ImpAppend(elem_7.GetField(i_18));
                if (succ_8 = 2 == (Int) (e_l_17.Length())) {
                  Record permI_19;
                  permI_19 = (Record) (e_l_17.Hd());
                  succ_8 = true;
                  {
                    vdm_OLD_tst = permI_19;
                    succ_8 = true;
                  }
                  permI_19 = (Record) (e_l_17[2]);
                  if (succ_8) {
                    vdm_OLD_cns = permI_19;
                    succ_8 = true;
                  }
                }
              }
          }
          if (succ_8) {
            Sequence rhs_9;
            {
              Sequence var2_11;
              Record tmpVar_12(vdm_AS_ElseifExpr, length_AS_ElseifExpr);
              tmpVar_12 = Record(vdm_AS_ElseifExpr, length_AS_ElseifExpr);
              tmpVar_12.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_tst));
              tmpVar_12.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_cns));
              var2_11 = Sequence().ImpAppend(tmpVar_12);
              rhs_9.ImpConc(vdm_OLD_new__l).ImpConc(var2_11);
            }
            vdm_OLD_new__l = rhs_9;
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record rexpr_22(vdm_AS_IfExpr, length_AS_IfExpr);
      {
        rexpr_22 = Record(vdm_AS_IfExpr, length_AS_IfExpr);
        rexpr_22.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_test__e));
        rexpr_22.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_cons__e));
        rexpr_22.SetField(3, vdm_OLD_new__l);
        rexpr_22.SetField(4, vdm_OLD_OldNameInExpr(vdm_OLD_altn__e));
        rexpr_22.SetField(5, Nil());
      }
      return rexpr_22;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInIfExpr");
}

Record vdm_OLD_OldNameInIotaExpr(Record var_1_1) {
  Record vdm_OLD_bind;
  Record vdm_OLD_pred__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IotaExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_bind = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_IotaExpr, length_AS_IotaExpr);
    {
      rexpr_6 = Record(vdm_AS_IotaExpr, length_AS_IotaExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInBind(vdm_OLD_bind));
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_pred__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInIotaExpr");
}

Record vdm_OLD_OldNameInIsExpr(Record var_1_1) {
  Record vdm_OLD_arg__e;
  Record vdm_OLD_type;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_IsExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_type = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_arg__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_IsExpr, length_AS_IsExpr);
    {
      rexpr_6 = Record(vdm_AS_IsExpr, length_AS_IsExpr);
      rexpr_6.SetField(1, vdm_OLD_type);
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_arg__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInIsExpr");
}

Record vdm_OLD_OldNameInLambdaExpr(Record var_1_1) {
  Record vdm_OLD_body__e;
  Sequence vdm_OLD_tb__l;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LambdaExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_tb__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_body__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_LambdaExpr, length_AS_LambdaExpr);
    {
      rexpr_6 = Record(vdm_AS_LambdaExpr, length_AS_LambdaExpr);
      rexpr_6.SetField(1, vdm_OLD_tb__l);
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_body__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInLambdaExpr");
}

Record vdm_OLD_OldNameInLetBeSTExpr(Record var_1_1) {
  Record vdm_OLD_in__e;
  Record vdm_OLD_lhs;
  Generic vdm_OLD_st__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LetBeSTExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 4 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_lhs = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_st__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_in__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_LetBeSTExpr, length_AS_LetBeSTExpr);
    {
      rexpr_6 = Record(vdm_AS_LetBeSTExpr, length_AS_LetBeSTExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInBind(vdm_OLD_lhs));
      Generic tmpVar_9;
{ if (((Bool) (vdm_OLD_st__e == Nil())).GetValue()) 
   tmpVar_9 = Nil();
 else { tmpVar_9 = vdm_OLD_OldNameInExpr(vdm_OLD_st__e); } }
      rexpr_6.SetField(2, tmpVar_9);
      rexpr_6.SetField(3, vdm_OLD_OldNameInExpr(vdm_OLD_in__e));
      rexpr_6.SetField(4, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInLetBeSTExpr");
}

Record vdm_OLD_OldNameInLetExpr(Record var_1_1) {
  Record vdm_OLD_in__e;
  Sequence vdm_OLD_localdef;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_LetExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_localdef = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_in__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_new__l;
    vdm_OLD_new__l = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_localdef;
      Record vdm_OLD_ldef;
      bool succ_8;
      Generic tmpe_30;
      for (int i_29 = sq_6.First(tmpe_30); i_29; i_29 = sq_6.Next(tmpe_30)) {
        Record elem_7 = tmpe_30;
        {
          succ_8 = true;
          {
            vdm_OLD_ldef = elem_7;
            succ_8 = true;
          }
          if (succ_8) {
            Bool cond_9;
            {
              Record argTmp_10;
              argTmp_10 = vdm_OLD_ldef;
              if (argTmp_10.IsRecord()) 
                cond_9 = vdm_AS_ValueDef == argTmp_10.GetTag();
              else 
                cond_9 = false;
            }
            if (cond_9.GetValue()) {
              bool succ_15;
              Record tmpVal_16;
              tmpVal_16 = vdm_OLD_ldef;
              Record vdm_OLD_pat;
              Generic vdm_OLD_tp;
              Record vdm_OLD_val;
              succ_15 = true;
              {
                succ_15 = false;
                if (tmpVal_16.IsRecord()) 
                  if (vdm_AS_ValueDef == ((Record) tmpVal_16).GetTag()) {
                    Sequence e_l_17;
                    for (int i_18 = 1; i_18 <= ((Record) tmpVal_16).Length(); i_18++) 
                      e_l_17.ImpAppend(((Record) tmpVal_16).GetField(i_18));
                    if (succ_15 = 3 == (Int) (e_l_17.Length())) {
                      Generic permI_19;
                      permI_19 = (Generic) (e_l_17.Hd());
                      succ_15 = true;
                      {
                        vdm_OLD_pat = permI_19;
                        succ_15 = true;
                      }
                      permI_19 = (Generic) (e_l_17[2]);
                      if (succ_15) {
                        vdm_OLD_tp = permI_19;
                        succ_15 = true;
                      }
                      permI_19 = (Generic) (e_l_17[3]);
                      if (succ_15) {
                        vdm_OLD_val = permI_19;
                        succ_15 = true;
                      }
                    }
                  }
              }
              if (!succ_15) 
                RunTime("Pattern match did not succeed in value definition");
              {
                Sequence rhs_20;
                {
                  Sequence var2_22;
                  Record tmpVar_23(vdm_AS_ValueDef, length_AS_ValueDef);
                  tmpVar_23 = Record(vdm_AS_ValueDef, length_AS_ValueDef);
                  tmpVar_23.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_pat));
                  tmpVar_23.SetField(2, vdm_OLD_tp);
                  tmpVar_23.SetField(3, vdm_OLD_OldNameInExpr(vdm_OLD_val));
                  var2_22 = Sequence().ImpAppend(tmpVar_23);
                  rhs_20.ImpConc(vdm_OLD_new__l).ImpConc(var2_22);
                }
                vdm_OLD_new__l = rhs_20;
              }
            }
            else {
              Sequence rhs_11;
              {
                Sequence var2_13;
                var2_13 = Sequence().ImpAppend(vdm_OLD_ldef);
                rhs_11.ImpConc(vdm_OLD_new__l).ImpConc(var2_13);
              }
              vdm_OLD_new__l = rhs_11;
            }
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record rexpr_31(vdm_AS_LetExpr, length_AS_LetExpr);
      {
        rexpr_31 = Record(vdm_AS_LetExpr, length_AS_LetExpr);
        rexpr_31.SetField(1, vdm_OLD_new__l);
        rexpr_31.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_in__e));
        rexpr_31.SetField(3, Nil());
      }
      return rexpr_31;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInLetExpr");
}

Record vdm_OLD_OldNameInMapComprehensionExpr(Record var_1_1) {
  Sequence vdm_OLD_bind__l;
  Record vdm_OLD_elem(vdm_AS_Maplet, length_AS_Maplet);
  Record vdm_OLD_pred__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 5 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_elem = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_bind__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
          permI_5 = (Generic) (e_l_3[5]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    bool succ_6;
    Record tmpVal_7(vdm_AS_Maplet, length_AS_Maplet);
    tmpVal_7 = vdm_OLD_elem;
    Record vdm_OLD_md;
    Record vdm_OLD_mr;
    succ_6 = true;
    {
      succ_6 = false;
      if (tmpVal_7.IsRecord()) 
        if (vdm_AS_Maplet == tmpVal_7.GetTag()) {
          Sequence e_l_8;
          for (int i_9 = 1; i_9 <= tmpVal_7.Length(); i_9++) 
            e_l_8.ImpAppend(tmpVal_7.GetField(i_9));
          if (succ_6 = 2 == (Int) (e_l_8.Length())) {
            Record permI_10;
            permI_10 = (Record) (e_l_8.Hd());
            succ_6 = true;
            {
              vdm_OLD_md = permI_10;
              succ_6 = true;
            }
            permI_10 = (Record) (e_l_8[2]);
            if (succ_6) {
              vdm_OLD_mr = permI_10;
              succ_6 = true;
            }
          }
        }
    }
    if (!succ_6) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Record rexpr_11(vdm_AS_MapComprehensionExpr, length_AS_MapComprehensionExpr);
      {
        rexpr_11 = Record(vdm_AS_MapComprehensionExpr, length_AS_MapComprehensionExpr);
        Record tmpVar_12(vdm_AS_Maplet, length_AS_Maplet);
        {
          tmpVar_12 = Record(vdm_AS_Maplet, length_AS_Maplet);
          tmpVar_12.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_md));
          tmpVar_12.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_mr));
        }
        rexpr_11.SetField(1, tmpVar_12);
        rexpr_11.SetField(2, vdm_OLD_OldNameInMultBindSeq(vdm_OLD_bind__l));
        Record tmpVar_19;
        {
          Bool cond_20;
          {
            Record argTmp_21;
            argTmp_21 = vdm_OLD_pred__e;
            if (argTmp_21.IsRecord()) 
              cond_20 = vdm_AS_UndefinedExpr == argTmp_21.GetTag();
            else 
              cond_20 = false;
          }
          if (cond_20.GetValue()) 
            tmpVar_19 = vdm_OLD_pred__e;
          else { tmpVar_19 = vdm_OLD_OldNameInExpr(vdm_OLD_pred__e); }
        }
        rexpr_11.SetField(3, tmpVar_19);
        rexpr_11.SetField(4, Nil());
        rexpr_11.SetField(5, Nil());
      }
      return rexpr_11;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInMapComprehensionExpr");
}

Record vdm_OLD_OldNameInMapEnumerationExpr(Record var_1_1) {
  Sequence vdm_OLD_els__l;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_els__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    vdm_OLD_l = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_els__l;
      Record vdm_OLD_md;
      Record vdm_OLD_mr;
      bool succ_8;
      Generic tmpe_21;
      for (int i_20 = sq_6.First(tmpe_21); i_20; i_20 = sq_6.Next(tmpe_21)) {
        Record elem_7 = tmpe_21;
        {
          succ_8 = true;
          {
            succ_8 = false;
            if (elem_7.IsRecord()) 
              if (vdm_AS_Maplet == elem_7.GetTag()) {
                Sequence e_l_17;
                for (int i_18 = 1; i_18 <= elem_7.Length(); i_18++) 
                  e_l_17.ImpAppend(elem_7.GetField(i_18));
                if (succ_8 = 2 == (Int) (e_l_17.Length())) {
                  Record permI_19;
                  permI_19 = (Record) (e_l_17.Hd());
                  succ_8 = true;
                  {
                    vdm_OLD_md = permI_19;
                    succ_8 = true;
                  }
                  permI_19 = (Record) (e_l_17[2]);
                  if (succ_8) {
                    vdm_OLD_mr = permI_19;
                    succ_8 = true;
                  }
                }
              }
          }
          if (succ_8) {
            Sequence rhs_9;
            {
              Sequence var2_11;
              Record tmpVar_12(vdm_AS_Maplet, length_AS_Maplet);
              tmpVar_12 = Record(vdm_AS_Maplet, length_AS_Maplet);
              tmpVar_12.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_md));
              tmpVar_12.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_mr));
              var2_11 = Sequence().ImpAppend(tmpVar_12);
              rhs_9.ImpConc(vdm_OLD_l).ImpConc(var2_11);
            }
            vdm_OLD_l = rhs_9;
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record rexpr_22(vdm_AS_MapEnumerationExpr, length_AS_MapEnumerationExpr);
      {
        rexpr_22 = Record(vdm_AS_MapEnumerationExpr, length_AS_MapEnumerationExpr);
        rexpr_22.SetField(1, vdm_OLD_l);
        rexpr_22.SetField(2, Nil());
      }
      return rexpr_22;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInMapEnumerationExpr");
}

Record vdm_OLD_OldNameInMapInverseExpr(Record var_1_1) {
  Record vdm_OLD_op;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_MapInverseExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_op = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_MapInverseExpr, length_AS_MapInverseExpr);
    {
      rexpr_6 = Record(vdm_AS_MapInverseExpr, length_AS_MapInverseExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_op));
      rexpr_6.SetField(2, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInMapInverseExpr");
}

Sequence vdm_OLD_OldNameInMultBindSeq(Sequence vdm_OLD_bind__l) {
  Sequence vdm_OLD_new__l;
  vdm_OLD_new__l = Sequence();
  Sequence vdm_OLD_tmp__l;
  vdm_OLD_tmp__l = Sequence();
  {
    Sequence sq_3;
    sq_3 = vdm_OLD_bind__l;
    Record vdm_OLD_bind;
    bool succ_5;
    Generic tmpe_36;
    for (int i_35 = sq_3.First(tmpe_36); i_35; i_35 = sq_3.Next(tmpe_36)) {
      Record elem_4 = tmpe_36;
      {
        succ_5 = true;
        {
          vdm_OLD_bind = elem_4;
          succ_5 = true;
        }
        if (succ_5) {
          Sequence rhs_6;
          rhs_6 = Sequence();
          vdm_OLD_tmp__l = rhs_6;
          {
            Sequence sq_7;
            {
              Record tmpRec_10;
              tmpRec_10 = vdm_OLD_bind;
              if (((Record) tmpRec_10).Is(vdm_AS_MultTypeBind)) 
                sq_7 = ((Record) tmpRec_10).GetField(pos_AS_MultTypeBind_pat);
              else 
                if (((Record) tmpRec_10).Is(vdm_AS_MultSetBind)) 
                  sq_7 = ((Record) tmpRec_10).GetField(pos_AS_MultSetBind_pat);
                else 
                  RunTime("Unknown record field selector");
            }
            Record vdm_OLD_pat__p;
            bool succ_9;
            Generic tmpe_17;
            for (int i_16 = sq_7.First(tmpe_17); i_16; i_16 = sq_7.Next(tmpe_17)) {
              Record elem_8 = tmpe_17;
              {
                succ_9 = true;
                {
                  vdm_OLD_pat__p = elem_8;
                  succ_9 = true;
                }
                if (succ_9) {
                  Sequence rhs_11;
                  {
                    Sequence var2_13;
                    var2_13 = Sequence().ImpAppend(vdm_OLD_OldNameInPattern(vdm_OLD_pat__p));
                    rhs_11.ImpConc(vdm_OLD_tmp__l).ImpConc(var2_13);
                  }
                  vdm_OLD_tmp__l = rhs_11;
                }
                else 
                  RunTime("Pattern did not match in sequence for loop");
              }
            }
          }
          {
            Bool cond_18;
            {
              Record argTmp_19;
              argTmp_19 = vdm_OLD_bind;
              if (argTmp_19.IsRecord()) 
                cond_18 = vdm_AS_MultSetBind == argTmp_19.GetTag();
              else 
                cond_18 = false;
            }
            if (cond_18.GetValue()) {
              Sequence rhs_27;
              {
                Sequence var2_29;
                Record tmpVar_30(vdm_AS_MultSetBind, length_AS_MultSetBind);
                tmpVar_30 = Record(vdm_AS_MultSetBind, length_AS_MultSetBind);
                tmpVar_30.SetField(1, vdm_OLD_tmp__l);
                Record tmpVar_32;
                {
                  Record tmpVar_33;
                  {
                    Record tmpRec_34;
                    tmpRec_34 = vdm_OLD_bind;
                    if (((Record) tmpRec_34).Is(vdm_AS_MultSetBind)) 
                      tmpVar_33 = ((Record) tmpRec_34).GetField(pos_AS_MultSetBind_Set);
                    else 
                      RunTime("Unknown record field selector");
                  }
                  tmpVar_32 = vdm_OLD_OldNameInExpr(tmpVar_33);
                }
                tmpVar_30.SetField(2, tmpVar_32);
                var2_29 = Sequence().ImpAppend(tmpVar_30);
                rhs_27.ImpConc(vdm_OLD_new__l).ImpConc(var2_29);
              }
              vdm_OLD_new__l = rhs_27;
            }
            else {
              Sequence rhs_20;
              {
                Sequence var2_22;
                Record tmpVar_23(vdm_AS_MultTypeBind, length_AS_MultTypeBind);
                tmpVar_23 = Record(vdm_AS_MultTypeBind, length_AS_MultTypeBind);
                tmpVar_23.SetField(1, vdm_OLD_tmp__l);
                Record tmpVar_25;
                {
                  Record tmpRec_26;
                  tmpRec_26 = vdm_OLD_bind;
                  if (((Record) tmpRec_26).Is(vdm_AS_MultTypeBind)) 
                    tmpVar_25 = ((Record) tmpRec_26).GetField(pos_AS_MultTypeBind_tp);
                  else 
                    RunTime("Unknown record field selector");
                }
                tmpVar_23.SetField(2, tmpVar_25);
                var2_22 = Sequence().ImpAppend(tmpVar_23);
                rhs_20.ImpConc(vdm_OLD_new__l).ImpConc(var2_22);
              }
              vdm_OLD_new__l = rhs_20;
            }
          }
        }
        else 
          RunTime("Pattern did not match in sequence for loop");
      }
    }
  }
  {
    Sequence rexpr_37;
    rexpr_37 = vdm_OLD_new__l;
    return rexpr_37;
  }
}

Record vdm_OLD_OldNameInOldName(Record var_1_1) {
  Sequence vdm_OLD_id__l;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_OldName == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_id__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    bool succ_6;
    Sequence tmpVal_7;
    {
      Sequence tmpseq_8;
      tmpseq_8 = vdm_OLD_id__l;
      tmpVal_7 = (Sequence) (tmpseq_8[((Int) (vdm_OLD_id__l.Length())).GetValue()]);
    }
    Sequence vdm_OLD_id;
    succ_6 = true;
    {
      vdm_OLD_id = tmpVal_7;
      succ_6 = true;
    }
    if (!succ_6) 
      RunTime("Pattern match did not succeed in value definition");
    {
      Sequence vdm_OLD_id_q;
      vdm_OLD_id_q.ImpConc(vdm_OLD_id).ImpConc(Sequence("~"));
      {
        Record rexpr_15(vdm_AS_Name, length_AS_Name);
        {
          rexpr_15 = Record(vdm_AS_Name, length_AS_Name);
          Sequence tmpVar_16;
          tmpVar_16 = Sequence().ImpAppend(vdm_OLD_id_q);
          rexpr_15.SetField(1, tmpVar_16);
          rexpr_15.SetField(2, Nil());
        }
        return rexpr_15;
      }
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInOldName");
}

Record vdm_OLD_OldNameInPattern(Record vdm_OLD_pat) {
  Record selRes_3;
  selRes_3 = vdm_OLD_pat;
  bool succ_4 = true;
  {
    Generic vdm_OLD_id;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_PatternName == ((Record) selRes_3).GetTag()) {
          Sequence e_l_5;
          for (int i_6 = 1; i_6 <= ((Record) selRes_3).Length(); i_6++) 
            e_l_5.ImpAppend(((Record) selRes_3).GetField(i_6));
          if (succ_4 = 2 == (Int) (e_l_5.Length())) {
            Generic permI_7;
            permI_7 = (Generic) (e_l_5.Hd());
            succ_4 = true;
            {
              vdm_OLD_id = permI_7;
              succ_4 = true;
            }
            permI_7 = (Generic) (e_l_5[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Record rexpr_8;
      rexpr_8 = vdm_OLD_pat;
      return rexpr_8;
    }
  }
  if (!succ_4) {
    Record vdm_OLD_val;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_MatchVal == ((Record) selRes_3).GetTag()) {
          Sequence e_l_9;
          for (int i_10 = 1; i_10 <= ((Record) selRes_3).Length(); i_10++) 
            e_l_9.ImpAppend(((Record) selRes_3).GetField(i_10));
          if (succ_4 = 1 == (Int) (e_l_9.Length())) {
            Record permI_11;
            permI_11 = (Record) (e_l_9.Hd());
            succ_4 = true;
            {
              vdm_OLD_val = permI_11;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Record rexpr_12(vdm_AS_MatchVal, length_AS_MatchVal);
      {
        rexpr_12 = Record(vdm_AS_MatchVal, length_AS_MatchVal);
        rexpr_12.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_val));
      }
      return rexpr_12;
    }
  }
  if (!succ_4) {
    Sequence vdm_OLD_els__l;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_15;
          for (int i_16 = 1; i_16 <= ((Record) selRes_3).Length(); i_16++) 
            e_l_15.ImpAppend(((Record) selRes_3).GetField(i_16));
          if (succ_4 = 2 == (Int) (e_l_15.Length())) {
            Generic permI_17;
            permI_17 = (Generic) (e_l_15.Hd());
            succ_4 = true;
            {
              vdm_OLD_els__l = permI_17;
              succ_4 = true;
            }
            permI_17 = (Generic) (e_l_15[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Sequence vdm_OLD_l;
      {
        Sequence res_l_20;
        Record reselem_21;
        Set resBind_s_23;
        {
          Set riseq_28;
          int max_29 = (Int) (vdm_OLD_els__l.Length());
          for (int i_30 = 1; i_30 <= max_29; i_30++) 
            riseq_28.Insert((Int) i_30);
          resBind_s_23 = riseq_28;
        }
        Sequence bind_l_22;
        if ((Int) (resBind_s_23.Card()) != (Int) 0) 
          bind_l_22 = Sort(resBind_s_23);
        bool succ_24 = true;
        Int vdm_OLD_i;
        Generic tmpe_35;
        for (int i_34 = bind_l_22.First(tmpe_35); i_34; i_34 = bind_l_22.Next(tmpe_35)) {
          Int e_26 = tmpe_35;
          {
            vdm_OLD_i = e_26;
            succ_24 = true;
            if (succ_24) {
              Record tmpVar_31;
              {
                Sequence tmpseq_32;
                tmpseq_32 = vdm_OLD_els__l;
                tmpVar_31 = (Record) (tmpseq_32[vdm_OLD_i.GetValue()]);
              }
              reselem_21 = vdm_OLD_OldNameInPattern(tmpVar_31);
              res_l_20.ImpAppend(reselem_21);
            }
          }
        }
        vdm_OLD_l = res_l_20;
      }
      {
        Record rexpr_36(vdm_AS_SetEnumPattern, length_AS_SetEnumPattern);
        {
          rexpr_36 = Record(vdm_AS_SetEnumPattern, length_AS_SetEnumPattern);
          rexpr_36.SetField(1, vdm_OLD_l);
          rexpr_36.SetField(2, Nil());
        }
        return rexpr_36;
      }
    }
  }
  if (!succ_4) {
    Record vdm_OLD_lp;
    Record vdm_OLD_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetUnionPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_39;
          for (int i_40 = 1; i_40 <= ((Record) selRes_3).Length(); i_40++) 
            e_l_39.ImpAppend(((Record) selRes_3).GetField(i_40));
          if (succ_4 = 2 == (Int) (e_l_39.Length())) {
            Record permI_41;
            permI_41 = (Record) (e_l_39.Hd());
            succ_4 = true;
            {
              vdm_OLD_lp = permI_41;
              succ_4 = true;
            }
            permI_41 = (Record) (e_l_39[2]);
            if (succ_4) {
              vdm_OLD_rp = permI_41;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Record rexpr_42(vdm_AS_SetUnionPattern, length_AS_SetUnionPattern);
      {
        rexpr_42 = Record(vdm_AS_SetUnionPattern, length_AS_SetUnionPattern);
        rexpr_42.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_lp));
        rexpr_42.SetField(2, vdm_OLD_OldNameInPattern(vdm_OLD_rp));
      }
      return rexpr_42;
    }
  }
  if (!succ_4) {
    Sequence vdm_OLD_els__l;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqEnumPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_47;
          for (int i_48 = 1; i_48 <= ((Record) selRes_3).Length(); i_48++) 
            e_l_47.ImpAppend(((Record) selRes_3).GetField(i_48));
          if (succ_4 = 2 == (Int) (e_l_47.Length())) {
            Generic permI_49;
            permI_49 = (Generic) (e_l_47.Hd());
            succ_4 = true;
            {
              vdm_OLD_els__l = permI_49;
              succ_4 = true;
            }
            permI_49 = (Generic) (e_l_47[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Sequence vdm_OLD_l;
      {
        Sequence res_l_52;
        Record reselem_53;
        Set resBind_s_55;
        {
          Set riseq_60;
          int max_61 = (Int) (vdm_OLD_els__l.Length());
          for (int i_62 = 1; i_62 <= max_61; i_62++) 
            riseq_60.Insert((Int) i_62);
          resBind_s_55 = riseq_60;
        }
        Sequence bind_l_54;
        if ((Int) (resBind_s_55.Card()) != (Int) 0) 
          bind_l_54 = Sort(resBind_s_55);
        bool succ_56 = true;
        Int vdm_OLD_i;
        Generic tmpe_67;
        for (int i_66 = bind_l_54.First(tmpe_67); i_66; i_66 = bind_l_54.Next(tmpe_67)) {
          Int e_58 = tmpe_67;
          {
            vdm_OLD_i = e_58;
            succ_56 = true;
            if (succ_56) {
              Record tmpVar_63;
              {
                Sequence tmpseq_64;
                tmpseq_64 = vdm_OLD_els__l;
                tmpVar_63 = (Record) (tmpseq_64[vdm_OLD_i.GetValue()]);
              }
              reselem_53 = vdm_OLD_OldNameInPattern(tmpVar_63);
              res_l_52.ImpAppend(reselem_53);
            }
          }
        }
        vdm_OLD_l = res_l_52;
      }
      {
        Record rexpr_68(vdm_AS_SeqEnumPattern, length_AS_SeqEnumPattern);
        {
          rexpr_68 = Record(vdm_AS_SeqEnumPattern, length_AS_SeqEnumPattern);
          rexpr_68.SetField(1, vdm_OLD_l);
          rexpr_68.SetField(2, Nil());
        }
        return rexpr_68;
      }
    }
  }
  if (!succ_4) {
    Record vdm_OLD_lp;
    Record vdm_OLD_rp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SeqConcPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_71;
          for (int i_72 = 1; i_72 <= ((Record) selRes_3).Length(); i_72++) 
            e_l_71.ImpAppend(((Record) selRes_3).GetField(i_72));
          if (succ_4 = 2 == (Int) (e_l_71.Length())) {
            Record permI_73;
            permI_73 = (Record) (e_l_71.Hd());
            succ_4 = true;
            {
              vdm_OLD_lp = permI_73;
              succ_4 = true;
            }
            permI_73 = (Record) (e_l_71[2]);
            if (succ_4) {
              vdm_OLD_rp = permI_73;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Record rexpr_74(vdm_AS_SeqConcPattern, length_AS_SeqConcPattern);
      {
        rexpr_74 = Record(vdm_AS_SeqConcPattern, length_AS_SeqConcPattern);
        rexpr_74.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_lp));
        rexpr_74.SetField(2, vdm_OLD_OldNameInPattern(vdm_OLD_rp));
      }
      return rexpr_74;
    }
  }
  if (!succ_4) {
    Sequence vdm_OLD_fields;
    Record vdm_OLD_tag(vdm_AS_Name, length_AS_Name);
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_RecordPattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_79;
          for (int i_80 = 1; i_80 <= ((Record) selRes_3).Length(); i_80++) 
            e_l_79.ImpAppend(((Record) selRes_3).GetField(i_80));
          if (succ_4 = 3 == (Int) (e_l_79.Length())) {
            Generic permI_81;
            permI_81 = (Generic) (e_l_79.Hd());
            succ_4 = true;
            {
              vdm_OLD_tag = permI_81;
              succ_4 = true;
            }
            permI_81 = (Generic) (e_l_79[2]);
            if (succ_4) {
              vdm_OLD_fields = permI_81;
              succ_4 = true;
            }
            permI_81 = (Generic) (e_l_79[3]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Sequence vdm_OLD_l;
      {
        Sequence res_l_84;
        Record reselem_85;
        Set resBind_s_87;
        {
          Set riseq_92;
          int max_93 = (Int) (vdm_OLD_fields.Length());
          for (int i_94 = 1; i_94 <= max_93; i_94++) 
            riseq_92.Insert((Int) i_94);
          resBind_s_87 = riseq_92;
        }
        Sequence bind_l_86;
        if ((Int) (resBind_s_87.Card()) != (Int) 0) 
          bind_l_86 = Sort(resBind_s_87);
        bool succ_88 = true;
        Int vdm_OLD_i;
        Generic tmpe_99;
        for (int i_98 = bind_l_86.First(tmpe_99); i_98; i_98 = bind_l_86.Next(tmpe_99)) {
          Int e_90 = tmpe_99;
          {
            vdm_OLD_i = e_90;
            succ_88 = true;
            if (succ_88) {
              Record tmpVar_95;
              {
                Sequence tmpseq_96;
                tmpseq_96 = vdm_OLD_fields;
                tmpVar_95 = (Record) (tmpseq_96[vdm_OLD_i.GetValue()]);
              }
              reselem_85 = vdm_OLD_OldNameInPattern(tmpVar_95);
              res_l_84.ImpAppend(reselem_85);
            }
          }
        }
        vdm_OLD_l = res_l_84;
      }
      {
        Record rexpr_100(vdm_AS_RecordPattern, length_AS_RecordPattern);
        {
          rexpr_100 = Record(vdm_AS_RecordPattern, length_AS_RecordPattern);
          rexpr_100.SetField(1, vdm_OLD_tag);
          rexpr_100.SetField(2, vdm_OLD_l);
          rexpr_100.SetField(3, Nil());
        }
        return rexpr_100;
      }
    }
  }
  if (!succ_4) {
    Sequence vdm_OLD_fields;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_TuplePattern == ((Record) selRes_3).GetTag()) {
          Sequence e_l_104;
          for (int i_105 = 1; i_105 <= ((Record) selRes_3).Length(); i_105++) 
            e_l_104.ImpAppend(((Record) selRes_3).GetField(i_105));
          if (succ_4 = 2 == (Int) (e_l_104.Length())) {
            Generic permI_106;
            permI_106 = (Generic) (e_l_104.Hd());
            succ_4 = true;
            {
              vdm_OLD_fields = permI_106;
              succ_4 = true;
            }
            permI_106 = (Generic) (e_l_104[2]);
            if (succ_4) 
              succ_4 = true;
          }
        }
    }
    if (succ_4) {
      Sequence vdm_OLD_l;
      {
        Sequence res_l_109;
        Record reselem_110;
        Set resBind_s_112;
        {
          Set riseq_117;
          int max_118 = (Int) (vdm_OLD_fields.Length());
          for (int i_119 = 1; i_119 <= max_118; i_119++) 
            riseq_117.Insert((Int) i_119);
          resBind_s_112 = riseq_117;
        }
        Sequence bind_l_111;
        if ((Int) (resBind_s_112.Card()) != (Int) 0) 
          bind_l_111 = Sort(resBind_s_112);
        bool succ_113 = true;
        Int vdm_OLD_i;
        Generic tmpe_124;
        for (int i_123 = bind_l_111.First(tmpe_124); i_123; i_123 = bind_l_111.Next(tmpe_124)) {
          Int e_115 = tmpe_124;
          {
            vdm_OLD_i = e_115;
            succ_113 = true;
            if (succ_113) {
              Record tmpVar_120;
              {
                Sequence tmpseq_121;
                tmpseq_121 = vdm_OLD_fields;
                tmpVar_120 = (Record) (tmpseq_121[vdm_OLD_i.GetValue()]);
              }
              reselem_110 = vdm_OLD_OldNameInPattern(tmpVar_120);
              res_l_109.ImpAppend(reselem_110);
            }
          }
        }
        vdm_OLD_l = res_l_109;
      }
      {
        Record rexpr_125(vdm_AS_TuplePattern, length_AS_TuplePattern);
        {
          rexpr_125 = Record(vdm_AS_TuplePattern, length_AS_TuplePattern);
          rexpr_125.SetField(1, vdm_OLD_l);
          rexpr_125.SetField(2, Nil());
        }
        return rexpr_125;
      }
    }
  }
  if (!succ_4) {
    Record vdm_OLD_pat;
    Record vdm_OLD_set__e;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_SetBind == ((Record) selRes_3).GetTag()) {
          Sequence e_l_128;
          for (int i_129 = 1; i_129 <= ((Record) selRes_3).Length(); i_129++) 
            e_l_128.ImpAppend(((Record) selRes_3).GetField(i_129));
          if (succ_4 = 2 == (Int) (e_l_128.Length())) {
            Record permI_130;
            permI_130 = (Record) (e_l_128.Hd());
            succ_4 = true;
            {
              vdm_OLD_pat = permI_130;
              succ_4 = true;
            }
            permI_130 = (Record) (e_l_128[2]);
            if (succ_4) {
              vdm_OLD_set__e = permI_130;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Record rexpr_131(vdm_AS_SetBind, length_AS_SetBind);
      {
        rexpr_131 = Record(vdm_AS_SetBind, length_AS_SetBind);
        rexpr_131.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_pat));
        rexpr_131.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_set__e));
      }
      return rexpr_131;
    }
  }
  if (!succ_4) {
    Record vdm_OLD_pat;
    Record vdm_OLD_tp;
    {
      succ_4 = false;
      if (selRes_3.IsRecord()) 
        if (vdm_AS_TypeBind == ((Record) selRes_3).GetTag()) {
          Sequence e_l_136;
          for (int i_137 = 1; i_137 <= ((Record) selRes_3).Length(); i_137++) 
            e_l_136.ImpAppend(((Record) selRes_3).GetField(i_137));
          if (succ_4 = 2 == (Int) (e_l_136.Length())) {
            Record permI_138;
            permI_138 = (Record) (e_l_136.Hd());
            succ_4 = true;
            {
              vdm_OLD_pat = permI_138;
              succ_4 = true;
            }
            permI_138 = (Record) (e_l_136[2]);
            if (succ_4) {
              vdm_OLD_tp = permI_138;
              succ_4 = true;
            }
          }
        }
    }
    if (succ_4) {
      Record rexpr_139(vdm_AS_TypeBind, length_AS_TypeBind);
      {
        rexpr_139 = Record(vdm_AS_TypeBind, length_AS_TypeBind);
        rexpr_139.SetField(1, vdm_OLD_OldNameInPattern(vdm_OLD_pat));
        rexpr_139.SetField(2, vdm_OLD_tp);
      }
      return rexpr_139;
    }
  }
  if (!succ_4) 
    RunTime("Can not evaluate an error statement");
}

Record vdm_OLD_OldNameInPrefixExpr(Record var_1_1) {
  Record vdm_OLD_arg__e;
  Generic vdm_OLD_opr;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_PrefixExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_opr = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_arg__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_PrefixExpr, length_AS_PrefixExpr);
    {
      rexpr_6 = Record(vdm_AS_PrefixExpr, length_AS_PrefixExpr);
      rexpr_6.SetField(1, vdm_OLD_opr);
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_arg__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInPrefixExpr");
}

Record vdm_OLD_OldNameInRecordConstructorExpr(Record var_1_1) {
  Sequence vdm_OLD_fields__le;
  Record vdm_OLD_tag(vdm_AS_Name, length_AS_Name);
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_RecordConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_tag = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_fields__le = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    {
      Sequence res_l_8;
      Record reselem_9;
      Set resBind_s_11;
      {
        Set riseq_16;
        int max_17 = (Int) (vdm_OLD_fields__le.Length());
        for (int i_18 = 1; i_18 <= max_17; i_18++) 
          riseq_16.Insert((Int) i_18);
        resBind_s_11 = riseq_16;
      }
      Sequence bind_l_10;
      if ((Int) (resBind_s_11.Card()) != (Int) 0) 
        bind_l_10 = Sort(resBind_s_11);
      bool succ_12 = true;
      Int vdm_OLD_i;
      Generic tmpe_23;
      for (int i_22 = bind_l_10.First(tmpe_23); i_22; i_22 = bind_l_10.Next(tmpe_23)) {
        Int e_14 = tmpe_23;
        {
          vdm_OLD_i = e_14;
          succ_12 = true;
          if (succ_12) {
            Record tmpVar_19;
            {
              Sequence tmpseq_20;
              tmpseq_20 = vdm_OLD_fields__le;
              tmpVar_19 = (Record) (tmpseq_20[vdm_OLD_i.GetValue()]);
            }
            reselem_9 = vdm_OLD_OldNameInExpr(tmpVar_19);
            res_l_8.ImpAppend(reselem_9);
          }
        }
      }
      vdm_OLD_l = res_l_8;
    }
    {
      Record rexpr_24(vdm_AS_RecordConstructorExpr, length_AS_RecordConstructorExpr);
      {
        rexpr_24 = Record(vdm_AS_RecordConstructorExpr, length_AS_RecordConstructorExpr);
        rexpr_24.SetField(1, vdm_OLD_tag);
        rexpr_24.SetField(2, vdm_OLD_l);
        rexpr_24.SetField(3, Nil());
      }
      return rexpr_24;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInRecordConstructorExpr");
}

Record vdm_OLD_OldNameInRecordModifierExpr(Record var_1_1) {
  Sequence vdm_OLD_modifiers;
  Record vdm_OLD_rec__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_RecordModifierExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_rec__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_modifiers = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    vdm_OLD_l = Sequence();
    {
      Sequence sq_6;
      sq_6 = vdm_OLD_modifiers;
      Record vdm_OLD_field(vdm_AS_Name, length_AS_Name);
      Record vdm_OLD_new;
      bool succ_8;
      Generic tmpe_20;
      for (int i_19 = sq_6.First(tmpe_20); i_19; i_19 = sq_6.Next(tmpe_20)) {
        Record elem_7 = tmpe_20;
        {
          succ_8 = true;
          {
            succ_8 = false;
            if (elem_7.IsRecord()) 
              if (vdm_AS_RecordModification == elem_7.GetTag()) {
                Sequence e_l_16;
                for (int i_17 = 1; i_17 <= elem_7.Length(); i_17++) 
                  e_l_16.ImpAppend(elem_7.GetField(i_17));
                if (succ_8 = 2 == (Int) (e_l_16.Length())) {
                  Record permI_18;
                  permI_18 = (Record) (e_l_16.Hd());
                  succ_8 = true;
                  {
                    vdm_OLD_field = permI_18;
                    succ_8 = true;
                  }
                  permI_18 = (Record) (e_l_16[2]);
                  if (succ_8) {
                    vdm_OLD_new = permI_18;
                    succ_8 = true;
                  }
                }
              }
          }
          if (succ_8) {
            Sequence rhs_9;
            {
              Sequence var2_11;
              Record tmpVar_12(vdm_AS_RecordModification, length_AS_RecordModification);
              tmpVar_12 = Record(vdm_AS_RecordModification, length_AS_RecordModification);
              tmpVar_12.SetField(1, vdm_OLD_field);
              tmpVar_12.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_new));
              var2_11 = Sequence().ImpAppend(tmpVar_12);
              rhs_9.ImpConc(vdm_OLD_l).ImpConc(var2_11);
            }
            vdm_OLD_l = rhs_9;
          }
          else 
            RunTime("Pattern did not match in sequence for loop");
        }
      }
    }
    {
      Record rexpr_21(vdm_AS_RecordModifierExpr, length_AS_RecordModifierExpr);
      {
        rexpr_21 = Record(vdm_AS_RecordModifierExpr, length_AS_RecordModifierExpr);
        rexpr_21.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_rec__e));
        rexpr_21.SetField(2, vdm_OLD_l);
        rexpr_21.SetField(3, Nil());
      }
      return rexpr_21;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInRecordModifierExpr");
}

Record vdm_OLD_OldNameInSeqComprehensionExpr(Record var_1_1) {
  Record vdm_OLD_bind(vdm_AS_SetBind, length_AS_SetBind);
  Record vdm_OLD_elem__e;
  Record vdm_OLD_pred__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 5 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_elem__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_bind = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
          permI_5 = (Generic) (e_l_3[5]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_SeqComprehensionExpr, length_AS_SeqComprehensionExpr);
    {
      rexpr_6 = Record(vdm_AS_SeqComprehensionExpr, length_AS_SeqComprehensionExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_elem__e));
      rexpr_6.SetField(2, vdm_OLD_OldNameInBind(vdm_OLD_bind));
      Record tmpVar_11;
      {
        Bool cond_12;
        {
          Record argTmp_13;
          argTmp_13 = vdm_OLD_pred__e;
          if (argTmp_13.IsRecord()) 
            cond_12 = vdm_AS_UndefinedExpr == argTmp_13.GetTag();
          else 
            cond_12 = false;
        }
        if (cond_12.GetValue()) 
          tmpVar_11 = vdm_OLD_pred__e;
        else { tmpVar_11 = vdm_OLD_OldNameInExpr(vdm_OLD_pred__e); }
      }
      rexpr_6.SetField(3, tmpVar_11);
      rexpr_6.SetField(4, Nil());
      rexpr_6.SetField(5, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSeqComprehensionExpr");
}

Record vdm_OLD_OldNameInSeqEnumerationExpr(Record var_1_1) {
  Sequence vdm_OLD_els__l;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_els__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    {
      Sequence res_l_8;
      Record reselem_9;
      Set resBind_s_11;
      {
        Set riseq_16;
        int max_17 = (Int) (vdm_OLD_els__l.Length());
        for (int i_18 = 1; i_18 <= max_17; i_18++) 
          riseq_16.Insert((Int) i_18);
        resBind_s_11 = riseq_16;
      }
      Sequence bind_l_10;
      if ((Int) (resBind_s_11.Card()) != (Int) 0) 
        bind_l_10 = Sort(resBind_s_11);
      bool succ_12 = true;
      Int vdm_OLD_i;
      Generic tmpe_23;
      for (int i_22 = bind_l_10.First(tmpe_23); i_22; i_22 = bind_l_10.Next(tmpe_23)) {
        Int e_14 = tmpe_23;
        {
          vdm_OLD_i = e_14;
          succ_12 = true;
          if (succ_12) {
            Record tmpVar_19;
            {
              Sequence tmpseq_20;
              tmpseq_20 = vdm_OLD_els__l;
              tmpVar_19 = (Record) (tmpseq_20[vdm_OLD_i.GetValue()]);
            }
            reselem_9 = vdm_OLD_OldNameInExpr(tmpVar_19);
            res_l_8.ImpAppend(reselem_9);
          }
        }
      }
      vdm_OLD_l = res_l_8;
    }
    {
      Record rexpr_24(vdm_AS_SeqEnumerationExpr, length_AS_SeqEnumerationExpr);
      {
        rexpr_24 = Record(vdm_AS_SeqEnumerationExpr, length_AS_SeqEnumerationExpr);
        rexpr_24.SetField(1, vdm_OLD_l);
        rexpr_24.SetField(2, Nil());
      }
      return rexpr_24;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSeqEnumerationExpr");
}

Record vdm_OLD_OldNameInSeqModifyMapOverrideExpr(Record var_1_1) {
  Record vdm_OLD_map__e;
  Record vdm_OLD_seqmap__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SeqModifyMapOverrideExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_seqmap__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_map__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_SeqModifyMapOverrideExpr, length_AS_SeqModifyMapOverrideExpr);
    {
      rexpr_6 = Record(vdm_AS_SeqModifyMapOverrideExpr, length_AS_SeqModifyMapOverrideExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_seqmap__e));
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_map__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSeqModifyMapOverrideExpr");
}

Record vdm_OLD_OldNameInSetComprehensionExpr(Record var_1_1) {
  Sequence vdm_OLD_bind__l;
  Record vdm_OLD_elem__e;
  Record vdm_OLD_pred__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetComprehensionExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 5 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_elem__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_bind__l = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_pred__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
          permI_5 = (Generic) (e_l_3[5]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_SetComprehensionExpr, length_AS_SetComprehensionExpr);
    {
      rexpr_6 = Record(vdm_AS_SetComprehensionExpr, length_AS_SetComprehensionExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_elem__e));
      rexpr_6.SetField(2, vdm_OLD_OldNameInMultBindSeq(vdm_OLD_bind__l));
      Record tmpVar_11;
      {
        Bool cond_12;
        {
          Record argTmp_13;
          argTmp_13 = vdm_OLD_pred__e;
          if (argTmp_13.IsRecord()) 
            cond_12 = vdm_AS_UndefinedExpr == argTmp_13.GetTag();
          else 
            cond_12 = false;
        }
        if (cond_12.GetValue()) 
          tmpVar_11 = vdm_OLD_pred__e;
        else { tmpVar_11 = vdm_OLD_OldNameInExpr(vdm_OLD_pred__e); }
      }
      rexpr_6.SetField(3, tmpVar_11);
      rexpr_6.SetField(4, Nil());
      rexpr_6.SetField(5, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSetComprehensionExpr");
}

Record vdm_OLD_OldNameInSetEnumerationExpr(Record var_1_1) {
  Sequence vdm_OLD_elm__le;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetEnumerationExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_elm__le = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_new__l;
    {
      Sequence res_l_8;
      Record reselem_9;
      Set resBind_s_11;
      {
        Set riseq_16;
        int max_17 = (Int) (vdm_OLD_elm__le.Length());
        for (int i_18 = 1; i_18 <= max_17; i_18++) 
          riseq_16.Insert((Int) i_18);
        resBind_s_11 = riseq_16;
      }
      Sequence bind_l_10;
      if ((Int) (resBind_s_11.Card()) != (Int) 0) 
        bind_l_10 = Sort(resBind_s_11);
      bool succ_12 = true;
      Int vdm_OLD_i;
      Generic tmpe_23;
      for (int i_22 = bind_l_10.First(tmpe_23); i_22; i_22 = bind_l_10.Next(tmpe_23)) {
        Int e_14 = tmpe_23;
        {
          vdm_OLD_i = e_14;
          succ_12 = true;
          if (succ_12) {
            Record tmpVar_19;
            {
              Sequence tmpseq_20;
              tmpseq_20 = vdm_OLD_elm__le;
              tmpVar_19 = (Record) (tmpseq_20[vdm_OLD_i.GetValue()]);
            }
            reselem_9 = vdm_OLD_OldNameInExpr(tmpVar_19);
            res_l_8.ImpAppend(reselem_9);
          }
        }
      }
      vdm_OLD_new__l = res_l_8;
    }
    {
      Record rexpr_24(vdm_AS_SetEnumerationExpr, length_AS_SetEnumerationExpr);
      {
        rexpr_24 = Record(vdm_AS_SetEnumerationExpr, length_AS_SetEnumerationExpr);
        rexpr_24.SetField(1, vdm_OLD_new__l);
        rexpr_24.SetField(2, Nil());
      }
      return rexpr_24;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSetEnumerationExpr");
}

Record vdm_OLD_OldNameInSetRangeExpr(Record var_1_1) {
  Record vdm_OLD_lb__e;
  Record vdm_OLD_ub__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SetRangeExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 3 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_lb__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_ub__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_SetRangeExpr, length_AS_SetRangeExpr);
    {
      rexpr_6 = Record(vdm_AS_SetRangeExpr, length_AS_SetRangeExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_lb__e));
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_ub__e));
      rexpr_6.SetField(3, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSetRangeExpr");
}

Record vdm_OLD_OldNameInSubSequenceExpr(Record var_1_1) {
  Record vdm_OLD_from__e;
  Record vdm_OLD_seq__e;
  Record vdm_OLD_to__e;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_SubSequenceExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 4 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_seq__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) {
            vdm_OLD_from__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[3]);
          if (succ_2) {
            vdm_OLD_to__e = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[4]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_SubSequenceExpr, length_AS_SubSequenceExpr);
    {
      rexpr_6 = Record(vdm_AS_SubSequenceExpr, length_AS_SubSequenceExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_seq__e));
      rexpr_6.SetField(2, vdm_OLD_OldNameInExpr(vdm_OLD_from__e));
      rexpr_6.SetField(3, vdm_OLD_OldNameInExpr(vdm_OLD_to__e));
      rexpr_6.SetField(4, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInSubSequenceExpr");
}

Record vdm_OLD_OldNameInTokenConstructorExpr(Record var_1_1) {
  Record vdm_OLD_expr;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_TokenConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_expr = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Record rexpr_6(vdm_AS_TokenConstructorExpr, length_AS_TokenConstructorExpr);
    {
      rexpr_6 = Record(vdm_AS_TokenConstructorExpr, length_AS_TokenConstructorExpr);
      rexpr_6.SetField(1, vdm_OLD_OldNameInExpr(vdm_OLD_expr));
      rexpr_6.SetField(2, Nil());
    }
    return rexpr_6;
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInTokenConstructorExpr");
}

Record vdm_OLD_OldNameInTupleConstructorExpr(Record var_1_1) {
  Sequence vdm_OLD_fields__le;
  bool succ_2 = true;
  {
    succ_2 = false;
    if (var_1_1.IsRecord()) 
      if (vdm_AS_TupleConstructorExpr == var_1_1.GetTag()) {
        Sequence e_l_3;
        for (int i_4 = 1; i_4 <= var_1_1.Length(); i_4++) 
          e_l_3.ImpAppend(var_1_1.GetField(i_4));
        if (succ_2 = 2 == (Int) (e_l_3.Length())) {
          Generic permI_5;
          permI_5 = (Generic) (e_l_3.Hd());
          succ_2 = true;
          {
            vdm_OLD_fields__le = permI_5;
            succ_2 = true;
          }
          permI_5 = (Generic) (e_l_3[2]);
          if (succ_2) 
            succ_2 = true;
        }
      }
  }
  if (succ_2) {
    Sequence vdm_OLD_l;
    {
      Sequence res_l_8;
      Record reselem_9;
      Set resBind_s_11;
      {
        Set riseq_16;
        int max_17 = (Int) (vdm_OLD_fields__le.Length());
        for (int i_18 = 1; i_18 <= max_17; i_18++) 
          riseq_16.Insert((Int) i_18);
        resBind_s_11 = riseq_16;
      }
      Sequence bind_l_10;
      if ((Int) (resBind_s_11.Card()) != (Int) 0) 
        bind_l_10 = Sort(resBind_s_11);
      bool succ_12 = true;
      Int vdm_OLD_i;
      Generic tmpe_23;
      for (int i_22 = bind_l_10.First(tmpe_23); i_22; i_22 = bind_l_10.Next(tmpe_23)) {
        Int e_14 = tmpe_23;
        {
          vdm_OLD_i = e_14;
          succ_12 = true;
          if (succ_12) {
            Record tmpVar_19;
            {
              Sequence tmpseq_20;
              tmpseq_20 = vdm_OLD_fields__le;
              tmpVar_19 = (Record) (tmpseq_20[vdm_OLD_i.GetValue()]);
            }
            reselem_9 = vdm_OLD_OldNameInExpr(tmpVar_19);
            res_l_8.ImpAppend(reselem_9);
          }
        }
      }
      vdm_OLD_l = res_l_8;
    }
    {
      Record rexpr_24(vdm_AS_TupleConstructorExpr, length_AS_TupleConstructorExpr);
      {
        rexpr_24 = Record(vdm_AS_TupleConstructorExpr, length_AS_TupleConstructorExpr);
        rexpr_24.SetField(1, vdm_OLD_l);
        rexpr_24.SetField(2, Nil());
      }
      return rexpr_24;
    }
  }
  else 
    RunTime("Pattern match failed in function apply in operation: OldNameInTupleConstructorExpr");
}
