//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at Thu 25-Mar-99 by the VDM-SLtoC++ Code Generator
// (v3.3 - Mon 22-Mar-99)
//
// Supported compilers:
// 	egcs version 1.1 on SunOS4, SunOS5, Linux, HP-UX10
// 	VC++ version 6.0 on Windows95, Windows NT
//



#include "CON_uENV.h"
static Generic vdm_CON_uENV_FindFuncInContext(const TYPE_AS_Name &, const TYPE_POGTP_Context &);
static Generic vdm_CON_uENV_FindFuncInValues(const TYPE_AS_Name &, const type_11AS_ValueDefCL &);

void init_CON_uENV_VDMLib() {
  VDMGetDefaultRecInfoMap().NewTag(TOKEN, 1);
  VDMGetDefaultRecInfoMap().SetSymTag(TOKEN, "token");
}
#ifdef DEF_CON_uENV_USERIMPL

#include "CON_uENV_userimpl.cc"

#endif


void init_CON_uENV() { init_CON_uENV_VDMLib(); }
#ifndef DEF_CON_uENV_FindFuncInContext

Generic vdm_CON_uENV_FindFuncInContext(const TYPE_AS_Name &vdm_CON_uENV_name, const TYPE_POGTP_Context &vdm_CON_uENV_contxt) {
  Generic varRes_4;
  {
    Sequence vdm_CON_uENV_env;
    if (vdm_CON_uENV_contxt.Is(vdm_POGTP_Context)) 
      vdm_CON_uENV_env = vdm_CON_uENV_contxt.GetField(pos_POGTP_Context_expr);
    else 
      RunTime("Unknown record field selector");
    if (((Bool) (vdm_CON_uENV_env == Sequence())).GetValue()) 
      varRes_4 = (Quote) "NOT_FOUND";
    else {
      Generic vdm_CON_uENV_head = (Generic) vdm_CON_uENV_env.Hd();
      Record vdm_CON_uENV_tail_ucontxt(vdm_POGTP_Context, length_POGTP_Context);
      Record tmpRE_17 = vdm_CON_uENV_contxt;
      int mu_18;
      mu_18 = pos_POGTP_Context_expr;
      tmpRE_17.SetField(mu_18, vdm_CON_uENV_env.Tl());
      vdm_CON_uENV_tail_ucontxt = tmpRE_17;
      Generic vdm_CON_uENV_search_uhead;
      bool succ_22 = true;
      {
        succ_22 = true;
        if (vdm_CON_uENV_head.IsRecord() && vdm_AS_TypeBind == ((Record) vdm_CON_uENV_head).GetTag()) {
          Sequence e_l_25;
          for (int i_26 = 1; i_26 <= ((Record) vdm_CON_uENV_head).Length(); i_26++) 
            e_l_25.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_26));
          if (succ_22 = 3 == (Int) e_l_25.Length()) {}
        }
        else 
          succ_22 = false;
        if (!succ_22) {
          succ_22 = true;
          if (vdm_CON_uENV_head.IsRecord() && vdm_AS_SetBind == ((Record) vdm_CON_uENV_head).GetTag()) {
            Sequence e_l_27;
            for (int i_28 = 1; i_28 <= ((Record) vdm_CON_uENV_head).Length(); i_28++) 
              e_l_27.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_28));
            if (succ_22 = 3 == (Int) e_l_27.Length()) {}
          }
          else 
            succ_22 = false;
        }
        if (succ_22) 
          if (vdm_PID_NameInBind((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_head).GetValue()) 
            vdm_CON_uENV_search_uhead = (Quote) "MAYBE";
          else 
            vdm_CON_uENV_search_uhead = (Quote) "NOT_FOUND";
      }
      if (!succ_22) {
        succ_22 = true;
        if (!vdm_CON_uENV_head.IsSequence()) 
          succ_22 = false;
        if (succ_22) 
          if (vdm_PID_NameInBindList((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_head).GetValue()) 
            vdm_CON_uENV_search_uhead = (Quote) "MAYBE";
          else 
            vdm_CON_uENV_search_uhead = (Quote) "NOT_FOUND";
      }
      if (!succ_22) {
        Record vdm_CON_uENV_expr;
        Record vdm_CON_uENV_pat;
        succ_22 = true;
        if (vdm_CON_uENV_head.IsRecord() && vdm_AS_ValueDef == ((Record) vdm_CON_uENV_head).GetTag()) {
          Sequence e_l_37;
          for (int i_38 = 1; i_38 <= ((Record) vdm_CON_uENV_head).Length(); i_38++) 
            e_l_37.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_38));
          if (succ_22 = 4 == (Int) e_l_37.Length()) {
            vdm_CON_uENV_pat = (Generic) e_l_37.Hd();
            vdm_CON_uENV_expr = (Generic) e_l_37[3];
          }
        }
        else 
          succ_22 = false;
        if (succ_22) 
          if (vdm_PID_NameInPattern((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_pat).GetValue()) {
            Bool cond_44;
            if (vdm_CON_uENV_pat.IsRecord()) 
              cond_44 = vdm_AS_PatternName == vdm_CON_uENV_pat.GetTag();
            else 
              cond_44 = false;
            if (cond_44.GetValue()) {
              bool succ_46 = true;
              {
                succ_46 = true;
                if (vdm_CON_uENV_expr.IsRecord() && vdm_AS_Name == ((Record) vdm_CON_uENV_expr).GetTag()) {
                  Sequence e_l_49;
                  for (int i_50 = 1; i_50 <= ((Record) vdm_CON_uENV_expr).Length(); i_50++) 
                    e_l_49.ImpAppend(((Record) vdm_CON_uENV_expr).GetField(i_50));
                  if (succ_46 = 2 == (Int) e_l_49.Length()) {}
                }
                else 
                  succ_46 = false;
                if (succ_46) 
                  vdm_CON_uENV_search_uhead = vdm_CON_uENV_HasPreCondition((Generic) vdm_CON_uENV_expr, (Generic) vdm_CON_uENV_tail_ucontxt);
              }
              if (!succ_46) {
                succ_46 = true;
                if (vdm_CON_uENV_expr.IsRecord() && vdm_AS_LambdaExpr == ((Record) vdm_CON_uENV_expr).GetTag()) {
                  Sequence e_l_53;
                  for (int i_54 = 1; i_54 <= ((Record) vdm_CON_uENV_expr).Length(); i_54++) 
                    e_l_53.ImpAppend(((Record) vdm_CON_uENV_expr).GetField(i_54));
                  if (succ_46 = 3 == (Int) e_l_53.Length()) {}
                }
                else 
                  succ_46 = false;
                if (succ_46) 
                  vdm_CON_uENV_search_uhead = (Quote) "NO";
              }
              if (!succ_46) 
                vdm_CON_uENV_search_uhead = (Quote) "MAYBE";
            }
            else 
              vdm_CON_uENV_search_uhead = (Quote) "MAYBE";
          }
          else 
            vdm_CON_uENV_search_uhead = (Quote) "NOT_FOUND";
      }
      if (!succ_22) {
        Generic vdm_CON_uENV_fnpre;
        succ_22 = true;
        if (vdm_CON_uENV_head.IsRecord() && vdm_AS_ImplFnDef == ((Record) vdm_CON_uENV_head).GetTag()) {
          Sequence e_l_55;
          for (int i_56 = 1; i_56 <= ((Record) vdm_CON_uENV_head).Length(); i_56++) 
            e_l_55.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_56));
          if (succ_22 = 7 == (Int) e_l_55.Length()) {
            succ_22 = true;
            if ((Generic) e_l_55.Hd() != vdm_CON_uENV_name) 
              succ_22 = false;
            if (succ_22) {}
            vdm_CON_uENV_fnpre = (Generic) e_l_55[5];
          }
        }
        else 
          succ_22 = false;
        if (!succ_22) {
          succ_22 = true;
          if (vdm_CON_uENV_head.IsRecord() && vdm_AS_ExplFnDef == ((Record) vdm_CON_uENV_head).GetTag()) {
            Sequence e_l_58;
            for (int i_59 = 1; i_59 <= ((Record) vdm_CON_uENV_head).Length(); i_59++) 
              e_l_58.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_59));
            if (succ_22 = 8 == (Int) e_l_58.Length()) {
              succ_22 = true;
              if ((Generic) e_l_58.Hd() != vdm_CON_uENV_name) 
                succ_22 = false;
              if (succ_22) {}
              vdm_CON_uENV_fnpre = (Generic) e_l_58[6];
            }
          }
          else 
            succ_22 = false;
        }
        if (!succ_22) {
          succ_22 = true;
          if (vdm_CON_uENV_head.IsRecord() && vdm_AS_ExtExplFnDef == ((Record) vdm_CON_uENV_head).GetTag()) {
            Sequence e_l_61;
            for (int i_62 = 1; i_62 <= ((Record) vdm_CON_uENV_head).Length(); i_62++) 
              e_l_61.ImpAppend(((Record) vdm_CON_uENV_head).GetField(i_62));
            if (succ_22 = 8 == (Int) e_l_61.Length()) {
              succ_22 = true;
              if ((Generic) e_l_61.Hd() != vdm_CON_uENV_name) 
                succ_22 = false;
              if (succ_22) {}
              vdm_CON_uENV_fnpre = (Generic) e_l_61[6];
            }
          }
          else 
            succ_22 = false;
        }
        if (succ_22) 
          if (((Bool) (vdm_CON_uENV_fnpre == Nil())).GetValue()) 
            vdm_CON_uENV_search_uhead = (Quote) "NO";
          else 
            vdm_CON_uENV_search_uhead = vdm_CON_uENV_head;
      }
      if (!succ_22) {
        succ_22 = true;
        if (vdm_CON_uENV_head.IsTuple()) {
          Sequence e_l_68;
          for (int i_69 = 1; i_69 <= ((Tuple) vdm_CON_uENV_head).Length(); i_69++) 
            e_l_68.ImpAppend(((Tuple) vdm_CON_uENV_head).GetField(i_69));
          if (succ_22 = 2 == (Int) e_l_68.Length()) {}
        }
        else 
          succ_22 = false;
        if (succ_22) 
          RunTime("Can not evaluate an undefined expression");
      }
      if (!succ_22) 
        vdm_CON_uENV_search_uhead = (Quote) "NOT_FOUND";
      if (((Bool) (vdm_CON_uENV_search_uhead == (Quote) "NOT_FOUND")).GetValue()) 
        varRes_4 = vdm_CON_uENV_FindFuncInContext((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_tail_ucontxt);
      else 
        varRes_4 = vdm_CON_uENV_search_uhead;
    }
  }
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_CON_uENV_FindFuncInValues

Generic vdm_CON_uENV_FindFuncInValues(const TYPE_AS_Name &vdm_CON_uENV_name, const type_11AS_ValueDefCL &vdm_CON_uENV_vals) {
  Generic varRes_4;
  {
    Record vdm_CON_uENV_empty_ucontxt = vdm_POGTP_InitialContext();
    if (((Bool) (vdm_CON_uENV_vals == Sequence())).GetValue()) 
      varRes_4 = (Quote) "NOT_FOUND";
    else {
      Record vdm_CON_uENV_head = (Record) vdm_CON_uENV_vals.Hd();
      Sequence vdm_CON_uENV_tail = vdm_CON_uENV_vals.Tl();
      Generic vdm_CON_uENV_check_uhead;
      {
        Record vdm_CON_uENV_pat;
        if (vdm_CON_uENV_head.Is(vdm_AS_ValueDef)) 
          vdm_CON_uENV_pat = vdm_CON_uENV_head.GetField(pos_AS_ValueDef_pat);
        else 
          RunTime("Unknown record field selector");
        Record vdm_CON_uENV_expr;
        if (vdm_CON_uENV_head.Is(vdm_AS_ValueDef)) 
          vdm_CON_uENV_expr = vdm_CON_uENV_head.GetField(pos_AS_ValueDef_val);
        else 
          RunTime("Unknown record field selector");
        if (vdm_PID_NameInPattern((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_pat).GetValue()) {
          Bool cond_27;
          if (vdm_CON_uENV_pat.IsRecord()) 
            cond_27 = vdm_AS_PatternName == vdm_CON_uENV_pat.GetTag();
          else 
            cond_27 = false;
          if (cond_27.GetValue()) {
            bool succ_29 = true;
            {
              succ_29 = true;
              if (vdm_CON_uENV_expr.IsRecord() && vdm_AS_Name == ((Record) vdm_CON_uENV_expr).GetTag()) {
                Sequence e_l_32;
                for (int i_33 = 1; i_33 <= ((Record) vdm_CON_uENV_expr).Length(); i_33++) 
                  e_l_32.ImpAppend(((Record) vdm_CON_uENV_expr).GetField(i_33));
                if (succ_29 = 2 == (Int) e_l_32.Length()) {}
              }
              else 
                succ_29 = false;
              if (succ_29) 
                vdm_CON_uENV_check_uhead = vdm_CON_uENV_HasPreCondition((Generic) vdm_CON_uENV_expr, (Generic) vdm_CON_uENV_empty_ucontxt);
            }
            if (!succ_29) {
              succ_29 = true;
              if (vdm_CON_uENV_expr.IsRecord() && vdm_AS_LambdaExpr == ((Record) vdm_CON_uENV_expr).GetTag()) {
                Sequence e_l_36;
                for (int i_37 = 1; i_37 <= ((Record) vdm_CON_uENV_expr).Length(); i_37++) 
                  e_l_36.ImpAppend(((Record) vdm_CON_uENV_expr).GetField(i_37));
                if (succ_29 = 3 == (Int) e_l_36.Length()) {}
              }
              else 
                succ_29 = false;
              if (succ_29) 
                vdm_CON_uENV_check_uhead = (Quote) "NO";
            }
            if (!succ_29) 
              vdm_CON_uENV_check_uhead = (Quote) "MAYBE";
          }
          else 
            vdm_CON_uENV_check_uhead = (Quote) "MAYBE";
        }
        else 
          vdm_CON_uENV_check_uhead = (Quote) "NOT_FOUND";
      }
      if (((Bool) (vdm_CON_uENV_check_uhead == (Quote) "NOT_FOUND")).GetValue()) 
        varRes_4 = vdm_CON_uENV_FindFuncInValues((Generic) vdm_CON_uENV_name, (Generic) vdm_CON_uENV_tail);
      else 
        varRes_4 = vdm_CON_uENV_check_uhead;
    }
  }
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_CON_uENV_HasPreCondition

Generic vdm_CON_uENV_HasPreCondition(const TYPE_AS_Name &vdm_CON_uENV_name, const TYPE_POGTP_Context &vdm_CON_uENV_contxt) {
  Generic varRes_4;
  {
    Sequence vdm_CON_uENV_match;
    Sequence unArg_7;
    if (vdm_CON_uENV_name.Is(vdm_AS_Name)) 
      unArg_7 = vdm_CON_uENV_name.GetField(pos_AS_Name_ids);
    else 
      RunTime("Unknown record field selector");
    vdm_CON_uENV_match = (Sequence) unArg_7.Hd();
    Bool cond_10;
    Sequence var1_11;
    Sequence resSeq_12;
    double from_15 = ((Int) 1).GetValue();
    double to_16 = ((Int) 4).GetValue();
    int max_17 = (Int) vdm_CON_uENV_match.Length();
    for (int i_18 = 1; i_18 <= max_17; i_18++) 
      if (from_15 <= i_18 && i_18 <= to_16) 
        resSeq_12.ImpAppend(vdm_CON_uENV_match[i_18]);
    var1_11 = resSeq_12;
    cond_10 = (Bool) (var1_11 == Sequence("pre_"));
    if (cond_10.GetValue()) 
      varRes_4 = (Quote) "NO";
    else {
      Bool cond_78;
      Sequence var1_79;
      Sequence resSeq_80;
      double from_83 = ((Int) 1).GetValue();
      double to_84 = ((Int) 4).GetValue();
      int max_85 = (Int) vdm_CON_uENV_match.Length();
      for (int i_86 = 1; i_86 <= max_85; i_86++) 
        if (from_83 <= i_86 && i_86 <= to_84) 
          resSeq_80.ImpAppend(vdm_CON_uENV_match[i_86]);
      var1_79 = resSeq_80;
      cond_78 = (Bool) (var1_79 == Sequence("inv_"));
      if (cond_78.GetValue()) 
        varRes_4 = (Quote) "NO";
      else {
        Map vdm_CON_uENV_fnm = vdm_SPEC_uAST_GetFnDefMap();
        Sequence vdm_CON_uENV_vals = vdm_SPEC_uAST_GetValueDefSeq();
        Record vdm_CON_uENV_nm(vdm_AS_Name, length_AS_Name);
        Bool cond_28;
        Sequence var1_29;
        Sequence resSeq_30;
        double from_33 = ((Int) 1).GetValue();
        double to_34 = ((Int) 5).GetValue();
        int max_35 = (Int) vdm_CON_uENV_match.Length();
        for (int i_36 = 1; i_36 <= max_35; i_36++) 
          if (from_33 <= i_36 && i_36 <= to_34) 
            resSeq_30.ImpAppend(vdm_CON_uENV_match[i_36]);
        var1_29 = resSeq_30;
        cond_28 = (Bool) (var1_29 == Sequence("post_"));
        if (cond_28.GetValue()) {
          vdm_CON_uENV_nm = Record(vdm_AS_Name, length_AS_Name);
          Sequence tmpVar_41;
          Sequence e_seq_42;
          Sequence resSeq_43;
          double from_46 = ((Int) 6).GetValue();
          double to_47 = ((Int) vdm_CON_uENV_match.Length()).GetValue();
          int max_48 = (Int) vdm_CON_uENV_match.Length();
          for (int i_49 = 1; i_49 <= max_48; i_49++) 
            if (from_46 <= i_49 && i_49 <= to_47) 
              resSeq_43.ImpAppend(vdm_CON_uENV_match[i_49]);
          e_seq_42 = resSeq_43;
          tmpVar_41 = Sequence().ImpAppend(e_seq_42);
          vdm_CON_uENV_nm.SetField(1, tmpVar_41);
          vdm_CON_uENV_nm.SetField(2, vdm_CI_NilContextId);
        }
        else 
          vdm_CON_uENV_nm = vdm_CON_uENV_name;
        Generic vdm_CON_uENV_local = vdm_CON_uENV_FindFuncInContext((Generic) vdm_CON_uENV_nm, (Generic) vdm_CON_uENV_contxt);
        if (((Bool) (vdm_CON_uENV_local == (Quote) "NOT_FOUND")).GetValue()) {
          Bool cond_63;
          cond_63 = (Bool) vdm_CON_uENV_fnm.Dom().InSet((Generic) vdm_CON_uENV_nm);
          if (cond_63.GetValue()) {
            Bool cond_70;
            Generic var1_71;
            if (((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).Is(vdm_AS_ImplFnDef)) 
              var1_71 = ((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).GetField(pos_AS_ImplFnDef_fnpre);
            else 
              if (((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).Is(vdm_AS_ExtExplFnDef)) 
                var1_71 = ((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).GetField(pos_AS_ExtExplFnDef_fnpre);
              else 
                if (((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).Is(vdm_AS_ExplFnDef)) 
                  var1_71 = ((Record) (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm]).GetField(pos_AS_ExplFnDef_fnpre);
                else 
                  RunTime("Unknown record field selector");
            cond_70 = (Bool) (var1_71 == Nil());
            if (cond_70.GetValue()) 
              varRes_4 = (Quote) "NO";
            else 
              varRes_4 = (Record) vdm_CON_uENV_fnm[(Generic) vdm_CON_uENV_nm];
          }
          else 
            varRes_4 = vdm_CON_uENV_FindFuncInValues((Generic) vdm_CON_uENV_nm, (Generic) vdm_CON_uENV_vals);
        }
        else 
          varRes_4 = vdm_CON_uENV_local;
      }
    }
  }
  return (Generic) varRes_4;
}
#endif

