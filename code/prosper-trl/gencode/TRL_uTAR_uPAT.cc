//
// THIS FILE IS AUTOMATICALLY GENERATED!!
//
// Generated at Thu 25-Nov-99 by the VDM-SLtoC++ Code Generator
// (v3.3 - Mon 22-Mar-99)
//
// Supported compilers:
// 	egcs version 1.1 on SunOS4, SunOS5, Linux, HP-UX10
// 	VC++ version 6.0 on Windows95, Windows NT
//



#include "TRL_uTAR_uPAT.h"

void TYPE_TRL_uTAR_uPAT_BIND::Init(TYPE_TRL_uTAR_uEXPR_Expr p1, type_19TRL_uTAR_uEXPR_EXPRCL p2) {
  SetField(1, p1);
  SetField(2, p2);
}

TYPE_TRL_uTAR_uEXPR_Expr TYPE_TRL_uTAR_uPAT_BIND::get_var() const { return (TYPE_TRL_uTAR_uEXPR_Expr) GetField(1); }

void TYPE_TRL_uTAR_uPAT_BIND::set_var(const TYPE_TRL_uTAR_uEXPR_Expr &p) { SetField(1, p); }

type_19TRL_uTAR_uEXPR_EXPRCL TYPE_TRL_uTAR_uPAT_BIND::get_preds() const { return (type_19TRL_uTAR_uEXPR_EXPRCL) GetField(2); }

void TYPE_TRL_uTAR_uPAT_BIND::set_preds(const type_19TRL_uTAR_uEXPR_EXPRCL &p) { SetField(2, p); }

void init_TRL_uTAR_uPAT_VDMLib() {
  VDMGetDefaultRecInfoMap().NewTag(TAG_TYPE_TRL_uTAR_uPAT_BIND, 2);
  VDMGetDefaultRecInfoMap().SetSymTag(TAG_TYPE_TRL_uTAR_uPAT_BIND, "TRL_uTAR_uPAT`BIND");
  VDMGetDefaultRecInfoMap().NewTag(TOKEN, 1);
  VDMGetDefaultRecInfoMap().SetSymTag(TOKEN, "token");
}
#ifdef DEF_TRL_uTAR_uPAT_USERIMPL

#include "TRL_uTAR_uPAT_userimpl.cc"

#endif


void init_TRL_uTAR_uPAT() { init_TRL_uTAR_uPAT_VDMLib(); }
#ifndef DEF_TRL_uTAR_uPAT_tar_uBindList

TYPE_TRL_uTAR_uPAT_BindList vdm_TRL_uTAR_uPAT_tar_uBindList(const type_18TRL_uTAR_uPAT_BINDCLL &vdm_TRL_uTAR_uPAT_binds) { return (Generic) vdm_TRL_uTAR_uPAT_binds; }
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uMatchVal

TYPE_TRL_uTAR_uPAT_MatchVal vdm_TRL_uTAR_uPAT_tar_uMatchVal(const TYPE_TRL_uTAR_uEXPR_Expr &var_1_1, const TYPE_CI_ContextId &var_2_2) {
  Record vdm_TRL_uTAR_uPAT_val(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  bool succ_3 = true;
  vdm_TRL_uTAR_uPAT_val = var_1_1;
  if (succ_3) {}
  if (!succ_3) 
    RunTime("Pattern Match in Function Apply in function : tar_uMatchVal failed");
  Generic varRes_4;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uMultSetBind

TYPE_TRL_uTAR_uPAT_MultSetBind vdm_TRL_uTAR_uPAT_tar_uMultSetBind(const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_pats, const TYPE_TRL_uTAR_uEXPR_Expr &vdm_TRL_uTAR_uPAT_expr, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Sequence varRes_5;
  {
    Sequence res_l_6;
    Set resBind_s_8;
    Set riseq_12;
    int max_13 = (Int) vdm_TRL_uTAR_uPAT_pats.Length();
    for (int i_14 = 1; i_14 <= max_13; i_14++) 
      riseq_12.Insert((Int) i_14);
    resBind_s_8 = riseq_12;
    Sequence bind_l_7;
    if ((Int) resBind_s_8.Card() != (Int) 0) 
      bind_l_7 = Sort(resBind_s_8);
    bool succ_9 = true;
    Int vdm_TRL_uTAR_uPAT_i;
    Generic tmpe_22;
    for (int i_21 = bind_l_7.First(tmpe_22); i_21; i_21 = bind_l_7.Next(tmpe_22)) {
      Int e_10 = tmpe_22;
      vdm_TRL_uTAR_uPAT_i = e_10;
      if (succ_9) 
        res_l_6.ImpAppend(vdm_TRL_uTAR_uPAT_tar_uSetBind((Generic) (Record) vdm_TRL_uTAR_uPAT_pats[vdm_TRL_uTAR_uPAT_i.GetValue()], (Generic) vdm_TRL_uTAR_uPAT_expr, (Generic) vdm_TRL_uTAR_uPAT_cid));
    }
    varRes_5 = res_l_6;
  }
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uMultTypeBind

TYPE_TRL_uTAR_uPAT_MultTypeBind vdm_TRL_uTAR_uPAT_tar_uMultTypeBind(const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_pats, const TYPE_AS_Type &vdm_TRL_uTAR_uPAT_as_utp, const TYPE_TRL_uTAR_uTYPE_Type &vdm_TRL_uTAR_uPAT_tp, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Sequence varRes_6;
  {
    Sequence res_l_7;
    Set resBind_s_9;
    Set riseq_13;
    int max_14 = (Int) vdm_TRL_uTAR_uPAT_pats.Length();
    for (int i_15 = 1; i_15 <= max_14; i_15++) 
      riseq_13.Insert((Int) i_15);
    resBind_s_9 = riseq_13;
    Sequence bind_l_8;
    if ((Int) resBind_s_9.Card() != (Int) 0) 
      bind_l_8 = Sort(resBind_s_9);
    bool succ_10 = true;
    Int vdm_TRL_uTAR_uPAT_i;
    Generic tmpe_24;
    for (int i_23 = bind_l_8.First(tmpe_24); i_23; i_23 = bind_l_8.Next(tmpe_24)) {
      Int e_11 = tmpe_24;
      vdm_TRL_uTAR_uPAT_i = e_11;
      if (succ_10) 
        res_l_7.ImpAppend(vdm_TRL_uTAR_uPAT_tar_uTypeBind((Generic) (Record) vdm_TRL_uTAR_uPAT_pats[vdm_TRL_uTAR_uPAT_i.GetValue()], (Generic) vdm_TRL_uTAR_uPAT_as_utp, (Generic) vdm_TRL_uTAR_uPAT_tp, (Generic) vdm_TRL_uTAR_uPAT_cid));
    }
    varRes_6 = res_l_7;
  }
  return (Generic) varRes_6;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uPatternName

TYPE_TRL_uTAR_uPAT_PatternName vdm_TRL_uTAR_uPAT_tar_uPatternName(const Generic &vdm_TRL_uTAR_uPAT_nm, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Record varRes_4(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  {
    Record vdm_TRL_uTAR_uPAT_tp;
    Bool cond_8;
{ if ((cond_8 = vdm_CI_IsAValidContextId((Generic) vdm_TRL_uTAR_uPAT_cid)).GetValue()) 
   cond_8 = vdm_CI_HasTypeInfo((Generic) vdm_TRL_uTAR_uPAT_cid); }
    if (cond_8.GetValue()) {
      Record vdm_TRL_uTAR_uPAT_tp_urep = vdm_CI_GetTypeInfo((Generic) vdm_TRL_uTAR_uPAT_cid);
      Record vdm_TRL_uTAR_uPAT_tp_uvdm = vdm_REP2TYPE_TypeRepToType((Generic) vdm_TRL_uTAR_uPAT_tp_urep, (Generic) vdm_TRL_uTAR_uPAT_cid);
      if (vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_tp_uvdm).Is(vdm_TRL_uTAR_uTYPE_TYPE)) 
        vdm_TRL_uTAR_uPAT_tp = vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_tp_uvdm).GetField(pos_TRL_uTAR_uTYPE_TYPE_tp);
      else 
        RunTime("Unknown record field selector");
    }
    else {
      vdm_TRL_uTAR_uPAT_tp = Record(vdm_HOL_vartype, length_HOL_vartype);
      vdm_TRL_uTAR_uPAT_tp.SetField(1, Sequence("`a"));
    }
    Record vdm_TRL_uTAR_uPAT_tm(vdm_HOL_Var, length_HOL_Var);
    vdm_TRL_uTAR_uPAT_tm = Record(vdm_HOL_Var, length_HOL_Var);
    Sequence tmpVar_23;
    Record tmpRec_24;
    if (vdm_TRL_uTAR_uPAT_nm.IsRecord()) 
      if (((Record) vdm_TRL_uTAR_uPAT_nm).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        tmpRec_24 = ((Record) vdm_TRL_uTAR_uPAT_nm).GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
      else 
        RunTime("Unknown record field selector");
    else 
      RunTime("A record was expected");
    if (((Record) tmpRec_24).Is(vdm_HOL_Var)) 
      tmpVar_23 = ((Record) tmpRec_24).GetField(pos_HOL_Var_Name);
    else 
      if (((Record) tmpRec_24).Is(vdm_HOL_Const)) 
        tmpVar_23 = ((Record) tmpRec_24).GetField(pos_HOL_Const_Name);
      else 
        RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_tm.SetField(1, tmpVar_23);
    vdm_TRL_uTAR_uPAT_tm.SetField(2, vdm_TRL_uTAR_uPAT_tp);
    Set vdm_TRL_uTAR_uPAT_fv;
    if (vdm_TRL_uTAR_uPAT_nm.IsRecord()) 
      if (((Record) vdm_TRL_uTAR_uPAT_nm).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        vdm_TRL_uTAR_uPAT_fv = ((Record) vdm_TRL_uTAR_uPAT_nm).GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
      else 
        RunTime("Unknown record field selector");
    else 
      RunTime("A record was expected");
    varRes_4 = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    varRes_4.SetField(1, vdm_TRL_uTAR_uPAT_tm);
    varRes_4.SetField(2, vdm_TRL_uTAR_uPAT_tp);
    varRes_4.SetField(3, vdm_TRL_uTAR_uPAT_fv);
  }
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_pre_tar_uPatternName

Bool vdm_TRL_uTAR_uPAT_pre_tar_uPatternName(const Generic &vdm_TRL_uTAR_uPAT_nm, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) { return (Generic) (Bool) !(vdm_TRL_uTAR_uPAT_nm == Nil()); }
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uRecordPattern

TYPE_TRL_uTAR_uPAT_RecordPattern vdm_TRL_uTAR_uPAT_tar_uRecordPattern(const TYPE_TRL_uTAR_uEXPR_NameName &vdm_TRL_uTAR_uPAT_nm, const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_flds, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Generic varRes_5;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uSeqConcPattern

TYPE_TRL_uTAR_uPAT_SeqConcPattern vdm_TRL_uTAR_uPAT_tar_uSeqConcPattern(const TYPE_TRL_uTAR_uPAT_Pattern &var_1_1, const TYPE_TRL_uTAR_uPAT_Pattern &var_2_2, const TYPE_CI_ContextId &var_3_3) {
  Record vdm_TRL_uTAR_uPAT_lp(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  Record vdm_TRL_uTAR_uPAT_rp(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  bool succ_4 = true;
  vdm_TRL_uTAR_uPAT_lp = var_1_1;
  vdm_TRL_uTAR_uPAT_rp = var_2_2;
  if (succ_4) {}
  if (!succ_4) 
    RunTime("Pattern Match in Function Apply in function : tar_uSeqConcPattern failed");
  Generic varRes_5;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uSeqEnumPattern

TYPE_TRL_uTAR_uPAT_SeqEnumPattern vdm_TRL_uTAR_uPAT_tar_uSeqEnumPattern(const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_els, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Generic varRes_4;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uSetBind

TYPE_TRL_uTAR_uPAT_SetBind vdm_TRL_uTAR_uPAT_tar_uSetBind(const TYPE_TRL_uTAR_uPAT_Pattern &vdm_TRL_uTAR_uPAT_pat, const TYPE_TRL_uTAR_uEXPR_Expr &vdm_TRL_uTAR_uPAT_expr, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Record varRes_5(vdm_TRL_uTAR_uPAT_BIND, length_TRL_uTAR_uPAT_BIND);
  {
    Record vdm_TRL_uTAR_uPAT_grd_utp;
    Bool cond_9;
    Record argTmp_10;
    if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      argTmp_10 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
    else 
      RunTime("Unknown record field selector");
    if (argTmp_10.IsRecord()) 
      cond_9 = vdm_HOL_type == argTmp_10.GetTag();
    else 
      cond_9 = false;
    if (cond_9.GetValue()) {
      Record vdm_TRL_uTAR_uPAT_as_utp;
      Record par_15(vdm_AS_Name, length_AS_Name);
      par_15 = Record(vdm_AS_Name, length_AS_Name);
      Sequence tmpVar_16;
      Sequence e_seq_17;
      Record tmpRec_18;
      if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        tmpRec_18 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
      else 
        RunTime("Unknown record field selector");
      if (((Record) tmpRec_18).Is(vdm_HOL_vartype)) 
        e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_vartype_name);
      else 
        if (((Record) tmpRec_18).Is(vdm_HOL_type)) 
          e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_type_name);
        else 
          if (((Record) tmpRec_18).Is(vdm_HOL_quote_utype)) 
            e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_quote_utype_name);
          else 
            RunTime("Unknown record field selector");
      tmpVar_16 = Sequence().ImpAppend(e_seq_17);
      par_15.SetField(1, tmpVar_16);
      par_15.SetField(2, vdm_CI_NilContextId);
      vdm_TRL_uTAR_uPAT_as_utp = vdm_CI_uAUX_LookUpGroundType((Generic) par_15);
      if (vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_as_utp).Is(vdm_TRL_uTAR_uTYPE_TYPE)) 
        vdm_TRL_uTAR_uPAT_grd_utp = vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_as_utp).GetField(pos_TRL_uTAR_uTYPE_TYPE_tp);
      else 
        RunTime("Unknown record field selector");
    }
    else 
      if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        vdm_TRL_uTAR_uPAT_grd_utp = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
      else 
        RunTime("Unknown record field selector");
    Record vdm_TRL_uTAR_uPAT_elmtp;
    if (((Record) vdm_TRL_uTAR_uPAT_grd_utp).Is(vdm_HOL_Set_utype)) 
      vdm_TRL_uTAR_uPAT_elmtp = ((Record) vdm_TRL_uTAR_uPAT_grd_utp).GetField(pos_HOL_Set_utype_elmtp);
    else 
      if (((Record) vdm_TRL_uTAR_uPAT_grd_utp).Is(vdm_HOL_Option_utype)) 
        vdm_TRL_uTAR_uPAT_elmtp = ((Record) vdm_TRL_uTAR_uPAT_grd_utp).GetField(pos_HOL_Option_utype_elmtp);
      else 
        if (((Record) vdm_TRL_uTAR_uPAT_grd_utp).Is(vdm_HOL_List_utype)) 
          vdm_TRL_uTAR_uPAT_elmtp = ((Record) vdm_TRL_uTAR_uPAT_grd_utp).GetField(pos_HOL_List_utype_elmtp);
        else 
          RunTime("Unknown record field selector");
    Record vdm_TRL_uTAR_uPAT_in_uset_ucons;
    Record par_28;
    if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      par_28 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_in_uset_ucons = vdm_TRANS_BinaryRelTable((Generic) (Quote) "INSET", (Generic) vdm_TRL_uTAR_uPAT_elmtp, (Generic) par_28);
    Record vdm_TRL_uTAR_uPAT_in_uset_utm(vdm_HOL_Comb, length_HOL_Comb);
    vdm_TRL_uTAR_uPAT_in_uset_utm = Record(vdm_HOL_Comb, length_HOL_Comb);
    vdm_TRL_uTAR_uPAT_in_uset_utm.SetField(1, vdm_TRL_uTAR_uPAT_in_uset_ucons);
    Sequence tmpVar_32;
    Record e_seq_33;
    if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      e_seq_33 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
    else 
      RunTime("Unknown record field selector");
    tmpVar_32 = Sequence().ImpAppend(e_seq_33);
    Record e_seq_35;
    if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      e_seq_35 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
    else 
      RunTime("Unknown record field selector");
    tmpVar_32.ImpAppend(e_seq_35);
    vdm_TRL_uTAR_uPAT_in_uset_utm.SetField(2, tmpVar_32);
    Record vdm_TRL_uTAR_uPAT_var(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    vdm_TRL_uTAR_uPAT_var = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    Record tmpVar_38;
    if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      tmpVar_38 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(1, tmpVar_38);
    Record tmpVar_40;
    if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      tmpVar_40 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(2, tmpVar_40);
    Set tmpVar_42;
    if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      tmpVar_42 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(3, tmpVar_42);
    Sequence vdm_TRL_uTAR_uPAT_preds;
    {
      Record vdm_TRL_uTAR_uPAT_tp = Record(vdm_HOL_Bool_utype, length_HOL_Bool_utype);
      Record vdm_TRL_uTAR_uPAT_tm = vdm_TRL_uTAR_uPAT_in_uset_utm;
      Set vdm_TRL_uTAR_uPAT_fv;
      Set var1_49;
      if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        var1_49 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
      else 
        RunTime("Unknown record field selector");
      Set var2_51;
      if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        var2_51 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
      else 
        RunTime("Unknown record field selector");
      vdm_TRL_uTAR_uPAT_fv = var1_49;
      vdm_TRL_uTAR_uPAT_fv.ImpUnion(var2_51);
      Record e_seq_53(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
      e_seq_53 = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
      e_seq_53.SetField(1, vdm_TRL_uTAR_uPAT_tm);
      e_seq_53.SetField(2, vdm_TRL_uTAR_uPAT_tp);
      e_seq_53.SetField(3, vdm_TRL_uTAR_uPAT_fv);
      vdm_TRL_uTAR_uPAT_preds = Sequence().ImpAppend(e_seq_53);
    }
    varRes_5 = Record(vdm_TRL_uTAR_uPAT_BIND, length_TRL_uTAR_uPAT_BIND);
    varRes_5.SetField(1, vdm_TRL_uTAR_uPAT_var);
    varRes_5.SetField(2, vdm_TRL_uTAR_uPAT_preds);
  }
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_pre_tar_uSetBind

Bool vdm_TRL_uTAR_uPAT_pre_tar_uSetBind(const TYPE_TRL_uTAR_uPAT_Pattern &vdm_TRL_uTAR_uPAT_pat, const TYPE_TRL_uTAR_uEXPR_Expr &vdm_TRL_uTAR_uPAT_expr, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Bool varRes_5;
  {
    Record vdm_TRL_uTAR_uPAT_grd_utp;
    Bool cond_9;
    Record argTmp_10;
    if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      argTmp_10 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
    else 
      RunTime("Unknown record field selector");
    if (argTmp_10.IsRecord()) 
      cond_9 = vdm_HOL_type == argTmp_10.GetTag();
    else 
      cond_9 = false;
    if (cond_9.GetValue()) {
      Record vdm_TRL_uTAR_uPAT_as_utp;
      Record par_15(vdm_AS_Name, length_AS_Name);
      par_15 = Record(vdm_AS_Name, length_AS_Name);
      Sequence tmpVar_16;
      Sequence e_seq_17;
      Record tmpRec_18;
      if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        tmpRec_18 = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
      else 
        RunTime("Unknown record field selector");
      if (((Record) tmpRec_18).Is(vdm_HOL_vartype)) 
        e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_vartype_name);
      else 
        if (((Record) tmpRec_18).Is(vdm_HOL_type)) 
          e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_type_name);
        else 
          if (((Record) tmpRec_18).Is(vdm_HOL_quote_utype)) 
            e_seq_17 = ((Record) tmpRec_18).GetField(pos_HOL_quote_utype_name);
          else 
            RunTime("Unknown record field selector");
      tmpVar_16 = Sequence().ImpAppend(e_seq_17);
      par_15.SetField(1, tmpVar_16);
      par_15.SetField(2, vdm_CI_NilContextId);
      vdm_TRL_uTAR_uPAT_as_utp = vdm_CI_uAUX_LookUpGroundType((Generic) par_15);
      if (vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_as_utp).Is(vdm_TRL_uTAR_uTYPE_TYPE)) 
        vdm_TRL_uTAR_uPAT_grd_utp = vdm_TRL_uTRA_uTYPE_trv_uType((Generic) vdm_TRL_uTAR_uPAT_as_utp).GetField(pos_TRL_uTAR_uTYPE_TYPE_tp);
      else 
        RunTime("Unknown record field selector");
    }
    else 
      if (vdm_TRL_uTAR_uPAT_expr.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        vdm_TRL_uTAR_uPAT_grd_utp = vdm_TRL_uTAR_uPAT_expr.GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
      else 
        RunTime("Unknown record field selector");
    if (vdm_TRL_uTAR_uPAT_grd_utp.IsRecord()) 
      varRes_5 = vdm_HOL_Set_utype == vdm_TRL_uTAR_uPAT_grd_utp.GetTag();
    else 
      varRes_5 = false;
  }
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uSetEnumPattern

TYPE_TRL_uTAR_uPAT_SetEnumPattern vdm_TRL_uTAR_uPAT_tar_uSetEnumPattern(const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_els, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Generic varRes_4;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uSetUnionPattern

TYPE_TRL_uTAR_uPAT_SetUnionPattern vdm_TRL_uTAR_uPAT_tar_uSetUnionPattern(const TYPE_TRL_uTAR_uPAT_PATTERN &var_1_1, const TYPE_TRL_uTAR_uPAT_Pattern &var_2_2, const TYPE_CI_ContextId &var_3_3) {
  Record vdm_TRL_uTAR_uPAT_lp(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  Record vdm_TRL_uTAR_uPAT_rp(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  bool succ_4 = true;
  vdm_TRL_uTAR_uPAT_lp = var_1_1;
  vdm_TRL_uTAR_uPAT_rp = var_2_2;
  if (succ_4) {}
  if (!succ_4) 
    RunTime("Pattern Match in Function Apply in function : tar_uSetUnionPattern failed");
  Generic varRes_5;
  RunTime("Can not evaluate an undefined expression");
  return (Generic) varRes_5;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uTuplePattern

TYPE_TRL_uTAR_uPAT_TuplePattern vdm_TRL_uTAR_uPAT_tar_uTuplePattern(const type_19TRL_uTAR_uEXPR_EXPRCL &vdm_TRL_uTAR_uPAT_els, const TYPE_CI_ContextId &vdm_TRL_uTAR_uPAT_cid) {
  Record varRes_4(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  {
    Record vdm_TRL_uTAR_uPAT_tp(vdm_HOL_Prod_utype, length_HOL_Prod_utype);
    vdm_TRL_uTAR_uPAT_tp = Record(vdm_HOL_Prod_utype, length_HOL_Prod_utype);
    Sequence tmpVar_7;
    {
      Sequence res_l_8;
      Set resBind_s_10;
      Set riseq_14;
      int max_15 = (Int) vdm_TRL_uTAR_uPAT_els.Length();
      for (int i_16 = 1; i_16 <= max_15; i_16++) 
        riseq_14.Insert((Int) i_16);
      resBind_s_10 = riseq_14;
      Sequence bind_l_9;
      if ((Int) resBind_s_10.Card() != (Int) 0) 
        bind_l_9 = Sort(resBind_s_10);
      bool succ_11 = true;
      Int vdm_TRL_uTAR_uPAT_i;
      Generic tmpe_22;
      for (int i_21 = bind_l_9.First(tmpe_22); i_21; i_21 = bind_l_9.Next(tmpe_22)) {
        Int e_12 = tmpe_22;
        vdm_TRL_uTAR_uPAT_i = e_12;
        if (succ_11) {
          Record reselem_17;
          if (((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
            reselem_17 = ((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).GetField(pos_TRL_uTAR_uEXPR_EXPR_tp);
          else 
            RunTime("Unknown record field selector");
          res_l_8.ImpAppend(reselem_17);
        }
      }
      tmpVar_7 = res_l_8;
    }
    vdm_TRL_uTAR_uPAT_tp.SetField(1, tmpVar_7);
    Sequence vdm_TRL_uTAR_uPAT_args;
    {
      Sequence res_l_24;
      Set resBind_s_26;
      Set riseq_30;
      int max_31 = (Int) vdm_TRL_uTAR_uPAT_els.Length();
      for (int i_32 = 1; i_32 <= max_31; i_32++) 
        riseq_30.Insert((Int) i_32);
      resBind_s_26 = riseq_30;
      Sequence bind_l_25;
      if ((Int) resBind_s_26.Card() != (Int) 0) 
        bind_l_25 = Sort(resBind_s_26);
      bool succ_27 = true;
      Int vdm_TRL_uTAR_uPAT_i;
      Generic tmpe_38;
      for (int i_37 = bind_l_25.First(tmpe_38); i_37; i_37 = bind_l_25.Next(tmpe_38)) {
        Int e_28 = tmpe_38;
        vdm_TRL_uTAR_uPAT_i = e_28;
        if (succ_27) {
          Record reselem_33;
          if (((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
            reselem_33 = ((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
          else 
            RunTime("Unknown record field selector");
          res_l_24.ImpAppend(reselem_33);
        }
      }
      vdm_TRL_uTAR_uPAT_args = res_l_24;
    }
    Record vdm_TRL_uTAR_uPAT_tm(vdm_HOL_Pair, length_HOL_Pair);
    vdm_TRL_uTAR_uPAT_tm = Record(vdm_HOL_Pair, length_HOL_Pair);
    vdm_TRL_uTAR_uPAT_tm.SetField(1, vdm_TRL_uTAR_uPAT_args);
    Set vdm_TRL_uTAR_uPAT_fv;
    Set unArg_42;
    Set res_s_43;
    {
      bool succ_48 = true;
      Set e_set_49;      Set riseq_51;      int max_52 = (Int) vdm_TRL_uTAR_uPAT_els.Length();      for (int i_53 = 1; i_53 <= max_52; i_53++) 
        riseq_51.Insert((Int) i_53);      e_set_49 = riseq_51;
      Int vdm_TRL_uTAR_uPAT_i;
      {
        Generic tmpe_56;
        for (int bb_55 = e_set_49.First(tmpe_56); bb_55; bb_55 = e_set_49.Next(tmpe_56)) {
          Int elem_54 = tmpe_56;
          succ_48 = true;          vdm_TRL_uTAR_uPAT_i = elem_54;          if (succ_48) {
            Set res_s_44;
            if (((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
              res_s_44 = ((Record) vdm_TRL_uTAR_uPAT_els[vdm_TRL_uTAR_uPAT_i.GetValue()]).GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
            else 
              RunTime("Unknown record field selector");
            res_s_43.Insert(res_s_44);
          }
        }
      }
    }
    unArg_42 = res_s_43;
    Set rduset_57;    Generic tmpe_60;    for (int bb_59 = unArg_42.First(tmpe_60); bb_59; bb_59 = unArg_42.Next(tmpe_60)) {
      Set e_58 = tmpe_60;
      rduset_57.ImpUnion(e_58);
    }    vdm_TRL_uTAR_uPAT_fv = rduset_57;
    varRes_4 = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    varRes_4.SetField(1, vdm_TRL_uTAR_uPAT_tm);
    varRes_4.SetField(2, vdm_TRL_uTAR_uPAT_tp);
    varRes_4.SetField(3, vdm_TRL_uTAR_uPAT_fv);
  }
  return (Generic) varRes_4;
}
#endif

#ifndef DEF_TRL_uTAR_uPAT_tar_uTypeBind

TYPE_TRL_uTAR_uPAT_TypeBind vdm_TRL_uTAR_uPAT_tar_uTypeBind(const TYPE_TRL_uTAR_uPAT_Pattern &var_1_1, const TYPE_AS_Type &var_2_2, const TYPE_TRL_uTAR_uTYPE_Type &var_3_3, const TYPE_CI_ContextId &var_4_4) {
  Record vdm_TRL_uTAR_uPAT_as_utp;
  Record vdm_TRL_uTAR_uPAT_pat(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
  Record vdm_TRL_uTAR_uPAT_type(vdm_TRL_uTAR_uTYPE_TYPE, length_TRL_uTAR_uTYPE_TYPE);
  bool succ_5 = true;
  vdm_TRL_uTAR_uPAT_pat = var_1_1;
  vdm_TRL_uTAR_uPAT_as_utp = var_2_2;
  vdm_TRL_uTAR_uPAT_type = var_3_3;
  if (succ_5) {}
  if (!succ_5) 
    RunTime("Pattern Match in Function Apply in function : tar_uTypeBind failed");
  Record varRes_6(vdm_TRL_uTAR_uPAT_BIND, length_TRL_uTAR_uPAT_BIND);
  {
    Generic vdm_TRL_uTAR_uPAT_der_uinv;
    Record par_10;
    if (vdm_TRL_uTAR_uPAT_type.Is(vdm_TRL_uTAR_uTYPE_TYPE)) 
      par_10 = vdm_TRL_uTAR_uPAT_type.GetField(pos_TRL_uTAR_uTYPE_TYPE_tp);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_der_uinv = vdm_DER_uINV_derive_uInv((Generic) vdm_TRL_uTAR_uPAT_as_utp, (Generic) par_10);
    Record vdm_TRL_uTAR_uPAT_var(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    vdm_TRL_uTAR_uPAT_var = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
    Record tmpVar_13;
    if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      tmpVar_13 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(1, tmpVar_13);
    Record tmpVar_15;
    if (vdm_TRL_uTAR_uPAT_type.Is(vdm_TRL_uTAR_uTYPE_TYPE)) 
      tmpVar_15 = vdm_TRL_uTAR_uPAT_type.GetField(pos_TRL_uTAR_uTYPE_TYPE_tp);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(2, tmpVar_15);
    Set tmpVar_17;
    if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
      tmpVar_17 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
    else 
      RunTime("Unknown record field selector");
    vdm_TRL_uTAR_uPAT_var.SetField(3, tmpVar_17);
    Sequence vdm_TRL_uTAR_uPAT_preds;
    if (((Bool) (vdm_TRL_uTAR_uPAT_der_uinv == Nil())).GetValue()) 
      vdm_TRL_uTAR_uPAT_preds = Sequence();
    else {
      Record vdm_TRL_uTAR_uPAT_tp = Record(vdm_HOL_Bool_utype, length_HOL_Bool_utype);
      Record vdm_TRL_uTAR_uPAT_tm(vdm_HOL_Comb, length_HOL_Comb);
      vdm_TRL_uTAR_uPAT_tm = Record(vdm_HOL_Comb, length_HOL_Comb);
      Record tmpVar_27;
      if (vdm_TRL_uTAR_uPAT_der_uinv.IsRecord()) 
        if (((Record) vdm_TRL_uTAR_uPAT_der_uinv).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
          tmpVar_27 = ((Record) vdm_TRL_uTAR_uPAT_der_uinv).GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
        else 
          RunTime("Unknown record field selector");
      else 
        RunTime("A record was expected");
      vdm_TRL_uTAR_uPAT_tm.SetField(1, tmpVar_27);
      Sequence tmpVar_29;
      Record e_seq_30;
      if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        e_seq_30 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_tm);
      else 
        RunTime("Unknown record field selector");
      tmpVar_29 = Sequence().ImpAppend(e_seq_30);
      vdm_TRL_uTAR_uPAT_tm.SetField(2, tmpVar_29);
      Set vdm_TRL_uTAR_uPAT_fv;
      Set var1_33;
      if (vdm_TRL_uTAR_uPAT_pat.Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
        var1_33 = vdm_TRL_uTAR_uPAT_pat.GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
      else 
        RunTime("Unknown record field selector");
      Set var2_35;
      if (vdm_TRL_uTAR_uPAT_der_uinv.IsRecord()) 
        if (((Record) vdm_TRL_uTAR_uPAT_der_uinv).Is(vdm_TRL_uTAR_uEXPR_EXPR)) 
          var2_35 = ((Record) vdm_TRL_uTAR_uPAT_der_uinv).GetField(pos_TRL_uTAR_uEXPR_EXPR_fv);
        else 
          RunTime("Unknown record field selector");
      else 
        RunTime("A record was expected");
      vdm_TRL_uTAR_uPAT_fv = var1_33;
      vdm_TRL_uTAR_uPAT_fv.ImpUnion(var2_35);
      Record e_seq_37(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
      e_seq_37 = Record(vdm_TRL_uTAR_uEXPR_EXPR, length_TRL_uTAR_uEXPR_EXPR);
      e_seq_37.SetField(1, vdm_TRL_uTAR_uPAT_tm);
      e_seq_37.SetField(2, vdm_TRL_uTAR_uPAT_tp);
      e_seq_37.SetField(3, vdm_TRL_uTAR_uPAT_fv);
      vdm_TRL_uTAR_uPAT_preds = Sequence().ImpAppend(e_seq_37);
    }
    varRes_6 = Record(vdm_TRL_uTAR_uPAT_BIND, length_TRL_uTAR_uPAT_BIND);
    varRes_6.SetField(1, vdm_TRL_uTAR_uPAT_var);
    varRes_6.SetField(2, vdm_TRL_uTAR_uPAT_preds);
  }
  return (Generic) varRes_6;
}
#endif

