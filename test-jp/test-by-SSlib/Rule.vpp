--$Header: /home/vdmtools/cvsroot/toolbox/test-jp/test-by-SSlib/Rule.vpp,v 1.1 2005/11/25 07:05:38 vdmtools Exp $
/*
各業務シナリオ遂行時に守られなければならないルール。
最終的には業務シナリオ、業務オブジェクトの中に定義されるものも多いが、
ここではそうした場所からはみ出すもの、まだ位置付けがはっきりしないものを置くために使われる
*/
class 『業務ルール』 is subclass of 『共通定義』

--手数料ルール
values
static public 手数料割引対象月平均残高 = 3000000;
static public  通常振込手数料率= 0.01;

functions
static public 振込手数料 : 
	『顧客帳簿』 * 『普通預金口座帳簿』 * 『定期預金帳簿』 * 『入出金記録帳簿』 * 「識別子」 * int * int * 「金額非負」
	-> 「金額非負」
振込手数料(ある顧客, ある普通預金口座帳簿, ある定期預金帳簿, ある入出金記録帳簿,  ある顧客ID, 年, 月, 振込額) == 
	(
	if ある顧客.月平均残高(ある普通預金口座帳簿, ある定期預金帳簿, ある入出金記録帳簿,  ある顧客ID, 年, 月) 
	   >= 手数料割引対象月平均残高 then
		 0
	else
		通常振込手数料(振込額)
	);

static public 通常振込手数料 : 「金額正」 -> 「金額正」
通常振込手数料(振込額) ==  振込額 * 通常振込手数料率;

--定期預金のルール
static public 定期預金が変更可能である : Time * Time * 「日付」 -> bool
定期預金が変更可能である(申込時刻, 変更時刻, 設定日) == 
	申込時刻.≦(変更時刻) and 変更時刻.日付を得る().＜(設定日) ;
	
--最低設定額ルール
values
static public 最低設定金額 = 1000000;

functions
static public 最低設定額 : () -> 「金額正」
最低設定額() == 最低設定金額;

--振込可能ルール
static public 振込可能 :  「文字列」 * 「文字列」 * 「金額」 * 「金額正」 -> bool
振込可能(登録パスワード, 入力パスワード, 残高, 振込額) == 
	登録パスワード = 入力パスワード and
	残高 >= 振込額 and 
	振込額  > 0;

end 『業務ルール』